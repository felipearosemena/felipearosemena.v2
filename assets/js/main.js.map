{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","app.js","../../../node_modules/isarray/index.js","../../../node_modules/page/index.js","../../../node_modules/path-to-regexp/index.js","polyfills.js","utils.js","video.js","contact.js","header.js","nav.js","pageSections.js","node_modules/browserify/node_modules/process/browser.js","node_modules/pubsub-js/src/pubsub.js","node_modules/viewport-units-buggyfill/viewport-units-buggyfill.js"],"names":[],"mappings":"AAAA;;;;;ICAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAaZ;AACA;AACA;;AAEA,IAAM,WAAW,SAAS,gBAAT,CAA0B,uBAA1B,CAAX;AACN,IAAM,eAAe,4BAAa,QAAb,CAAf;;AAEN,gBAAI,QAAJ,EAAc,UAAC,OAAD,EAAa;;AAEzB,MAAM,SAAS,4BAAgB,QAAQ,aAAR,CAAsB,qBAAtB,CAAhB,CAAT,CAFmB;AAGzB,MAAM,SAAS,QAAQ,gBAAR,CAAyB,KAAzB,CAAT,CAHmB;;AAKzB,MAAG,MAAH,EAAW;AACT,YAAQ,MAAR,GAAiB,MAAjB,CADS;GAAX;CALY,CAAd;;AAWA,SAAS,aAAT,CAAuB,SAAvB,EAAkC,WAAlC,EAA+C;MAEvC,WAAgB,YAAhB,SAFuC;MAE7B,KAAM,YAAN,GAF6B;MAGvC,SAAmB,GAAnB,OAHuC;MAG/B,SAAW,GAAX,OAH+B;;AAK7C,MAAG,MAAH,EAAW;AACT,QAAG,QAAH,EAAa;AACX,UAAG,CAAC,OAAO,QAAP,EAAiB;AACnB,eAAO,IAAP,GADmB;OAArB;;AAIA,aAAO,IAAP,GALW;KAAb,MAOO;AACL,aAAO,KAAP,GADK;KAPP;GADF;CALF;;AAoBA,IAAM,SAAS,sBAAW,SAAS,cAAT,CAAwB,aAAxB,CAAX,CAAT;AACN,IAAM,MAAM,mBAAQ,SAAS,cAAT,CAAwB,YAAxB,CAAR,CAAN;;AAEN,OAAO,SAAP,CAAkB,oBAAlB,EAAyC,aAAzC;AACA,OAAO,SAAP,CAAkB,oBAAlB,EAAyC,aAAzC;AACA,OAAO,SAAP,CAAkB,kBAAlB,EAAuC,YAAK;AAC1C,MAAI,IAAJ,GAD0C;CAAL,CAAvC;;AAIA,oBAAK,UAAL,EAAiB,YAAM;AACrB,MAAM,aAAa,KAAK,UAAL,CAAgB,MAAhB,GAAyB,KAAK,UAAL,GAAkB,CAAC,CAAD,CAA3C,CADE;AAErB,MAAM,cAAc,uBAAgB,SAAS,cAAT,CAAwB,cAAxB,CAAhB,EAAyD;AAC3E,YAAQ,UAAR;GADkB,CAAd,CAFe;;AAMrB,cAAY,MAAZ,GANqB;CAAN,CAAjB;;AASA,oBAAK;AACH,SAAO,KAAP;AACA,YAAU,KAAV;CAFF;;;;;ACrEA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import * as PubSub from 'pubsub-js'\nimport page from 'page'\n\nimport { map, reduce } from './modules/utils'\nimport { classList, dataset, vu } from './modules/polyfills'\n\nimport { videoController } from './modules/video'\nimport pageSections from './views/pageSections'\nimport headerView from './views/header'\nimport navView from './views/nav'\nimport contactFormView from './views/contact'\n\n// Polyfills\nclassList()\ndataset()\nvu()\n\nconst sections = document.querySelectorAll('[data-scroll-section]')\nconst sectionViews = pageSections(sections);\n\nmap(sections, (section) => {\n\n  const player = videoController(section.querySelector('[data-video-player]'))\n  const images = section.querySelectorAll('img')\n\n  if(player) {\n    section.player = player\n  }\n\n})\n\nfunction handleSection(eventName, sectionView) {\n\n  let { isInView, el} = sectionView\n  let { images, player } = el\n\n  if(player) {\n    if(isInView) {\n      if(!player.isLoaded) {\n        player.load()\n      }\n\n      player.play()\n\n    } else {\n      player.pause()\n    }\n  }\n\n}\n\nconst header = headerView(document.getElementById('site-header'))\nconst nav = navView(document.getElementById('navigation'))\n\nPubSub.subscribe(('section-view:enter'), handleSection)\nPubSub.subscribe(('section-view:leave'), handleSection)\nPubSub.subscribe(('header-view:open'), ()=> {\n  nav.init()\n})\n\npage('/contact', () => {\n  const formFields = data.formFields.length ? data.formFields : [0]\n  const contactForm = contactFormView(document.getElementById('contact-form'), {\n    fields: formFields\n  })\n\n  contactForm.render()\n})\n\npage({\n  click: false,\n  popstate: false\n})\n\n// page.show(location.pathname)\n\n","module.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n","(function (process){\n  /* globals require, module */\n\n  'use strict';\n\n  /**\n   * Module dependencies.\n   */\n\n  var pathtoRegexp = require('path-to-regexp');\n\n  /**\n   * Module exports.\n   */\n\n  module.exports = page;\n\n  /**\n   * Detect click event\n   */\n  var clickEvent = ('undefined' !== typeof document) && document.ontouchstart ? 'touchstart' : 'click';\n\n  /**\n   * To work properly with the URL\n   * history.location generated polyfill in https://github.com/devote/HTML5-History-API\n   */\n\n  var location = ('undefined' !== typeof window) && (window.history.location || window.location);\n\n  /**\n   * Perform initial dispatch.\n   */\n\n  var dispatch = true;\n\n\n  /**\n   * Decode URL components (query string, pathname, hash).\n   * Accommodates both regular percent encoding and x-www-form-urlencoded format.\n   */\n  var decodeURLComponents = true;\n\n  /**\n   * Base path.\n   */\n\n  var base = '';\n\n  /**\n   * Running flag.\n   */\n\n  var running;\n\n  /**\n   * HashBang option\n   */\n\n  var hashbang = false;\n\n  /**\n   * Previous context, for capturing\n   * page exit events.\n   */\n\n  var prevContext;\n\n  /**\n   * Register `path` with callback `fn()`,\n   * or route `path`, or redirection,\n   * or `page.start()`.\n   *\n   *   page(fn);\n   *   page('*', fn);\n   *   page('/user/:id', load, user);\n   *   page('/user/' + user.id, { some: 'thing' });\n   *   page('/user/' + user.id);\n   *   page('/from', '/to')\n   *   page();\n   *\n   * @param {string|!Function|!Object} path\n   * @param {Function=} fn\n   * @api public\n   */\n\n  function page(path, fn) {\n    // <callback>\n    if ('function' === typeof path) {\n      return page('*', path);\n    }\n\n    // route <path> to <callback ...>\n    if ('function' === typeof fn) {\n      var route = new Route(/** @type {string} */ (path));\n      for (var i = 1; i < arguments.length; ++i) {\n        page.callbacks.push(route.middleware(arguments[i]));\n      }\n      // show <path> with [state]\n    } else if ('string' === typeof path) {\n      page['string' === typeof fn ? 'redirect' : 'show'](path, fn);\n      // start [options]\n    } else {\n      page.start(path);\n    }\n  }\n\n  /**\n   * Callback functions.\n   */\n\n  page.callbacks = [];\n  page.exits = [];\n\n  /**\n   * Current path being processed\n   * @type {string}\n   */\n  page.current = '';\n\n  /**\n   * Number of pages navigated to.\n   * @type {number}\n   *\n   *     page.len == 0;\n   *     page('/login');\n   *     page.len == 1;\n   */\n\n  page.len = 0;\n\n  /**\n   * Get or set basepath to `path`.\n   *\n   * @param {string} path\n   * @api public\n   */\n\n  page.base = function(path) {\n    if (0 === arguments.length) return base;\n    base = path;\n  };\n\n  /**\n   * Bind with the given `options`.\n   *\n   * Options:\n   *\n   *    - `click` bind to click events [true]\n   *    - `popstate` bind to popstate [true]\n   *    - `dispatch` perform initial dispatch [true]\n   *\n   * @param {Object} options\n   * @api public\n   */\n\n  page.start = function(options) {\n    options = options || {};\n    if (running) return;\n    running = true;\n    if (false === options.dispatch) dispatch = false;\n    if (false === options.decodeURLComponents) decodeURLComponents = false;\n    if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);\n    if (false !== options.click) {\n      document.addEventListener(clickEvent, onclick, false);\n    }\n    if (true === options.hashbang) hashbang = true;\n    if (!dispatch) return;\n    var url = (hashbang && ~location.hash.indexOf('#!')) ? location.hash.substr(2) + location.search : location.pathname + location.search + location.hash;\n    page.replace(url, null, true, dispatch);\n  };\n\n  /**\n   * Unbind click and popstate event handlers.\n   *\n   * @api public\n   */\n\n  page.stop = function() {\n    if (!running) return;\n    page.current = '';\n    page.len = 0;\n    running = false;\n    document.removeEventListener(clickEvent, onclick, false);\n    window.removeEventListener('popstate', onpopstate, false);\n  };\n\n  /**\n   * Show `path` with optional `state` object.\n   *\n   * @param {string} path\n   * @param {Object=} state\n   * @param {boolean=} dispatch\n   * @param {boolean=} push\n   * @return {!Context}\n   * @api public\n   */\n\n  page.show = function(path, state, dispatch, push) {\n    var ctx = new Context(path, state);\n    page.current = ctx.path;\n    if (false !== dispatch) page.dispatch(ctx);\n    if (false !== ctx.handled && false !== push) ctx.pushState();\n    return ctx;\n  };\n\n  /**\n   * Goes back in the history\n   * Back should always let the current route push state and then go back.\n   *\n   * @param {string} path - fallback path to go back if no more history exists, if undefined defaults to page.base\n   * @param {Object=} state\n   * @api public\n   */\n\n  page.back = function(path, state) {\n    if (page.len > 0) {\n      // this may need more testing to see if all browsers\n      // wait for the next tick to go back in history\n      history.back();\n      page.len--;\n    } else if (path) {\n      setTimeout(function() {\n        page.show(path, state);\n      });\n    }else{\n      setTimeout(function() {\n        page.show(base, state);\n      });\n    }\n  };\n\n\n  /**\n   * Register route to redirect from one path to other\n   * or just redirect to another route\n   *\n   * @param {string} from - if param 'to' is undefined redirects to 'from'\n   * @param {string=} to\n   * @api public\n   */\n  page.redirect = function(from, to) {\n    // Define route from a path to another\n    if ('string' === typeof from && 'string' === typeof to) {\n      page(from, function(e) {\n        setTimeout(function() {\n          page.replace(/** @type {!string} */ (to));\n        }, 0);\n      });\n    }\n\n    // Wait for the push state and replace it with another\n    if ('string' === typeof from && 'undefined' === typeof to) {\n      setTimeout(function() {\n        page.replace(from);\n      }, 0);\n    }\n  };\n\n  /**\n   * Replace `path` with optional `state` object.\n   *\n   * @param {string} path\n   * @param {Object=} state\n   * @param {boolean=} init\n   * @param {boolean=} dispatch\n   * @return {!Context}\n   * @api public\n   */\n\n\n  page.replace = function(path, state, init, dispatch) {\n    var ctx = new Context(path, state);\n    page.current = ctx.path;\n    ctx.init = init;\n    ctx.save(); // save before dispatching, which may redirect\n    if (false !== dispatch) page.dispatch(ctx);\n    return ctx;\n  };\n\n  /**\n   * Dispatch the given `ctx`.\n   *\n   * @param {Context} ctx\n   * @api private\n   */\n  page.dispatch = function(ctx) {\n    var prev = prevContext,\n      i = 0,\n      j = 0;\n\n    prevContext = ctx;\n\n    function nextExit() {\n      var fn = page.exits[j++];\n      if (!fn) return nextEnter();\n      fn(prev, nextExit);\n    }\n\n    function nextEnter() {\n      var fn = page.callbacks[i++];\n\n      if (ctx.path !== page.current) {\n        ctx.handled = false;\n        return;\n      }\n      if (!fn) return unhandled(ctx);\n      fn(ctx, nextEnter);\n    }\n\n    if (prev) {\n      nextExit();\n    } else {\n      nextEnter();\n    }\n  };\n\n  /**\n   * Unhandled `ctx`. When it's not the initial\n   * popstate then redirect. If you wish to handle\n   * 404s on your own use `page('*', callback)`.\n   *\n   * @param {Context} ctx\n   * @api private\n   */\n  function unhandled(ctx) {\n    if (ctx.handled) return;\n    var current;\n\n    if (hashbang) {\n      current = base + location.hash.replace('#!', '');\n    } else {\n      current = location.pathname + location.search;\n    }\n\n    if (current === ctx.canonicalPath) return;\n    page.stop();\n    ctx.handled = false;\n    location.href = ctx.canonicalPath;\n  }\n\n  /**\n   * Register an exit route on `path` with\n   * callback `fn()`, which will be called\n   * on the previous context when a new\n   * page is visited.\n   */\n  page.exit = function(path, fn) {\n    if (typeof path === 'function') {\n      return page.exit('*', path);\n    }\n\n    var route = new Route(path);\n    for (var i = 1; i < arguments.length; ++i) {\n      page.exits.push(route.middleware(arguments[i]));\n    }\n  };\n\n  /**\n   * Remove URL encoding from the given `str`.\n   * Accommodates whitespace in both x-www-form-urlencoded\n   * and regular percent-encoded form.\n   *\n   * @param {string} val - URL component to decode\n   */\n  function decodeURLEncodedURIComponent(val) {\n    if (typeof val !== 'string') { return val; }\n    return decodeURLComponents ? decodeURIComponent(val.replace(/\\+/g, ' ')) : val;\n  }\n\n  /**\n   * Initialize a new \"request\" `Context`\n   * with the given `path` and optional initial `state`.\n   *\n   * @constructor\n   * @param {string} path\n   * @param {Object=} state\n   * @api public\n   */\n\n  function Context(path, state) {\n    if ('/' === path[0] && 0 !== path.indexOf(base)) path = base + (hashbang ? '#!' : '') + path;\n    var i = path.indexOf('?');\n\n    this.canonicalPath = path;\n    this.path = path.replace(base, '') || '/';\n    if (hashbang) this.path = this.path.replace('#!', '') || '/';\n\n    this.title = document.title;\n    this.state = state || {};\n    this.state.path = path;\n    this.querystring = ~i ? decodeURLEncodedURIComponent(path.slice(i + 1)) : '';\n    this.pathname = decodeURLEncodedURIComponent(~i ? path.slice(0, i) : path);\n    this.params = {};\n\n    // fragment\n    this.hash = '';\n    if (!hashbang) {\n      if (!~this.path.indexOf('#')) return;\n      var parts = this.path.split('#');\n      this.path = parts[0];\n      this.hash = decodeURLEncodedURIComponent(parts[1]) || '';\n      this.querystring = this.querystring.split('#')[0];\n    }\n  }\n\n  /**\n   * Expose `Context`.\n   */\n\n  page.Context = Context;\n\n  /**\n   * Push state.\n   *\n   * @api private\n   */\n\n  Context.prototype.pushState = function() {\n    page.len++;\n    history.pushState(this.state, this.title, hashbang && this.path !== '/' ? '#!' + this.path : this.canonicalPath);\n  };\n\n  /**\n   * Save the context state.\n   *\n   * @api public\n   */\n\n  Context.prototype.save = function() {\n    history.replaceState(this.state, this.title, hashbang && this.path !== '/' ? '#!' + this.path : this.canonicalPath);\n  };\n\n  /**\n   * Initialize `Route` with the given HTTP `path`,\n   * and an array of `callbacks` and `options`.\n   *\n   * Options:\n   *\n   *   - `sensitive`    enable case-sensitive routes\n   *   - `strict`       enable strict matching for trailing slashes\n   *\n   * @constructor\n   * @param {string} path\n   * @param {Object=} options\n   * @api private\n   */\n\n  function Route(path, options) {\n    options = options || {};\n    this.path = (path === '*') ? '(.*)' : path;\n    this.method = 'GET';\n    this.regexp = pathtoRegexp(this.path,\n      this.keys = [],\n      options);\n  }\n\n  /**\n   * Expose `Route`.\n   */\n\n  page.Route = Route;\n\n  /**\n   * Return route middleware with\n   * the given callback `fn()`.\n   *\n   * @param {Function} fn\n   * @return {Function}\n   * @api public\n   */\n\n  Route.prototype.middleware = function(fn) {\n    var self = this;\n    return function(ctx, next) {\n      if (self.match(ctx.path, ctx.params)) return fn(ctx, next);\n      next();\n    };\n  };\n\n  /**\n   * Check if this route matches `path`, if so\n   * populate `params`.\n   *\n   * @param {string} path\n   * @param {Object} params\n   * @return {boolean}\n   * @api private\n   */\n\n  Route.prototype.match = function(path, params) {\n    var keys = this.keys,\n      qsIndex = path.indexOf('?'),\n      pathname = ~qsIndex ? path.slice(0, qsIndex) : path,\n      m = this.regexp.exec(decodeURIComponent(pathname));\n\n    if (!m) return false;\n\n    for (var i = 1, len = m.length; i < len; ++i) {\n      var key = keys[i - 1];\n      var val = decodeURLEncodedURIComponent(m[i]);\n      if (val !== undefined || !(hasOwnProperty.call(params, key.name))) {\n        params[key.name] = val;\n      }\n    }\n\n    return true;\n  };\n\n\n  /**\n   * Handle \"populate\" events.\n   */\n\n  var onpopstate = (function () {\n    var loaded = false;\n    if ('undefined' === typeof window) {\n      return;\n    }\n    if (document.readyState === 'complete') {\n      loaded = true;\n    } else {\n      window.addEventListener('load', function() {\n        setTimeout(function() {\n          loaded = true;\n        }, 0);\n      });\n    }\n    return function onpopstate(e) {\n      if (!loaded) return;\n      if (e.state) {\n        var path = e.state.path;\n        page.replace(path, e.state);\n      } else {\n        page.show(location.pathname + location.hash, undefined, undefined, false);\n      }\n    };\n  })();\n  /**\n   * Handle \"click\" events.\n   */\n\n  function onclick(e) {\n\n    if (1 !== which(e)) return;\n\n    if (e.metaKey || e.ctrlKey || e.shiftKey) return;\n    if (e.defaultPrevented) return;\n\n\n\n    // ensure link\n    // use shadow dom when available\n    var el = e.path ? e.path[0] : e.target;\n    while (el && 'A' !== el.nodeName) el = el.parentNode;\n    if (!el || 'A' !== el.nodeName) return;\n\n\n\n    // Ignore if tag has\n    // 1. \"download\" attribute\n    // 2. rel=\"external\" attribute\n    if (el.hasAttribute('download') || el.getAttribute('rel') === 'external') return;\n\n    // ensure non-hash for the same path\n    var link = el.getAttribute('href');\n    if (!hashbang && el.pathname === location.pathname && (el.hash || '#' === link)) return;\n\n\n\n    // Check for mailto: in the href\n    if (link && link.indexOf('mailto:') > -1) return;\n\n    // check target\n    if (el.target) return;\n\n    // x-origin\n    if (!sameOrigin(el.href)) return;\n\n\n\n    // rebuild path\n    var path = el.pathname + el.search + (el.hash || '');\n\n    // strip leading \"/[drive letter]:\" on NW.js on Windows\n    if (typeof process !== 'undefined' && path.match(/^\\/[a-zA-Z]:\\//)) {\n      path = path.replace(/^\\/[a-zA-Z]:\\//, '/');\n    }\n\n    // same page\n    var orig = path;\n\n    if (path.indexOf(base) === 0) {\n      path = path.substr(base.length);\n    }\n\n    if (hashbang) path = path.replace('#!', '');\n\n    if (base && orig === path) return;\n\n    e.preventDefault();\n    page.show(orig);\n  }\n\n  /**\n   * Event button.\n   */\n\n  function which(e) {\n    e = e || window.event;\n    return null === e.which ? e.button : e.which;\n  }\n\n  /**\n   * Check if `href` is the same origin.\n   */\n\n  function sameOrigin(href) {\n    var origin = location.protocol + '//' + location.hostname;\n    if (location.port) origin += ':' + location.port;\n    return (href && (0 === href.indexOf(origin)));\n  }\n\n  page.sameOrigin = sameOrigin;\n\n}).call(this,require('_process'))\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9wYWdlL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIgIC8qIGdsb2JhbHMgcmVxdWlyZSwgbW9kdWxlICovXG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuICAgKi9cblxuICB2YXIgcGF0aHRvUmVnZXhwID0gcmVxdWlyZSgncGF0aC10by1yZWdleHAnKTtcblxuICAvKipcbiAgICogTW9kdWxlIGV4cG9ydHMuXG4gICAqL1xuXG4gIG1vZHVsZS5leHBvcnRzID0gcGFnZTtcblxuICAvKipcbiAgICogRGV0ZWN0IGNsaWNrIGV2ZW50XG4gICAqL1xuICB2YXIgY2xpY2tFdmVudCA9ICgndW5kZWZpbmVkJyAhPT0gdHlwZW9mIGRvY3VtZW50KSAmJiBkb2N1bWVudC5vbnRvdWNoc3RhcnQgPyAndG91Y2hzdGFydCcgOiAnY2xpY2snO1xuXG4gIC8qKlxuICAgKiBUbyB3b3JrIHByb3Blcmx5IHdpdGggdGhlIFVSTFxuICAgKiBoaXN0b3J5LmxvY2F0aW9uIGdlbmVyYXRlZCBwb2x5ZmlsbCBpbiBodHRwczovL2dpdGh1Yi5jb20vZGV2b3RlL0hUTUw1LUhpc3RvcnktQVBJXG4gICAqL1xuXG4gIHZhciBsb2NhdGlvbiA9ICgndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdpbmRvdykgJiYgKHdpbmRvdy5oaXN0b3J5LmxvY2F0aW9uIHx8IHdpbmRvdy5sb2NhdGlvbik7XG5cbiAgLyoqXG4gICAqIFBlcmZvcm0gaW5pdGlhbCBkaXNwYXRjaC5cbiAgICovXG5cbiAgdmFyIGRpc3BhdGNoID0gdHJ1ZTtcblxuXG4gIC8qKlxuICAgKiBEZWNvZGUgVVJMIGNvbXBvbmVudHMgKHF1ZXJ5IHN0cmluZywgcGF0aG5hbWUsIGhhc2gpLlxuICAgKiBBY2NvbW1vZGF0ZXMgYm90aCByZWd1bGFyIHBlcmNlbnQgZW5jb2RpbmcgYW5kIHgtd3d3LWZvcm0tdXJsZW5jb2RlZCBmb3JtYXQuXG4gICAqL1xuICB2YXIgZGVjb2RlVVJMQ29tcG9uZW50cyA9IHRydWU7XG5cbiAgLyoqXG4gICAqIEJhc2UgcGF0aC5cbiAgICovXG5cbiAgdmFyIGJhc2UgPSAnJztcblxuICAvKipcbiAgICogUnVubmluZyBmbGFnLlxuICAgKi9cblxuICB2YXIgcnVubmluZztcblxuICAvKipcbiAgICogSGFzaEJhbmcgb3B0aW9uXG4gICAqL1xuXG4gIHZhciBoYXNoYmFuZyA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBQcmV2aW91cyBjb250ZXh0LCBmb3IgY2FwdHVyaW5nXG4gICAqIHBhZ2UgZXhpdCBldmVudHMuXG4gICAqL1xuXG4gIHZhciBwcmV2Q29udGV4dDtcblxuICAvKipcbiAgICogUmVnaXN0ZXIgYHBhdGhgIHdpdGggY2FsbGJhY2sgYGZuKClgLFxuICAgKiBvciByb3V0ZSBgcGF0aGAsIG9yIHJlZGlyZWN0aW9uLFxuICAgKiBvciBgcGFnZS5zdGFydCgpYC5cbiAgICpcbiAgICogICBwYWdlKGZuKTtcbiAgICogICBwYWdlKCcqJywgZm4pO1xuICAgKiAgIHBhZ2UoJy91c2VyLzppZCcsIGxvYWQsIHVzZXIpO1xuICAgKiAgIHBhZ2UoJy91c2VyLycgKyB1c2VyLmlkLCB7IHNvbWU6ICd0aGluZycgfSk7XG4gICAqICAgcGFnZSgnL3VzZXIvJyArIHVzZXIuaWQpO1xuICAgKiAgIHBhZ2UoJy9mcm9tJywgJy90bycpXG4gICAqICAgcGFnZSgpO1xuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ3whRnVuY3Rpb258IU9iamVjdH0gcGF0aFxuICAgKiBAcGFyYW0ge0Z1bmN0aW9uPX0gZm5cbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgZnVuY3Rpb24gcGFnZShwYXRoLCBmbikge1xuICAgIC8vIDxjYWxsYmFjaz5cbiAgICBpZiAoJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIHBhdGgpIHtcbiAgICAgIHJldHVybiBwYWdlKCcqJywgcGF0aCk7XG4gICAgfVxuXG4gICAgLy8gcm91dGUgPHBhdGg+IHRvIDxjYWxsYmFjayAuLi4+XG4gICAgaWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBmbikge1xuICAgICAgdmFyIHJvdXRlID0gbmV3IFJvdXRlKC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAocGF0aCkpO1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgcGFnZS5jYWxsYmFja3MucHVzaChyb3V0ZS5taWRkbGV3YXJlKGFyZ3VtZW50c1tpXSkpO1xuICAgICAgfVxuICAgICAgLy8gc2hvdyA8cGF0aD4gd2l0aCBbc3RhdGVdXG4gICAgfSBlbHNlIGlmICgnc3RyaW5nJyA9PT0gdHlwZW9mIHBhdGgpIHtcbiAgICAgIHBhZ2VbJ3N0cmluZycgPT09IHR5cGVvZiBmbiA/ICdyZWRpcmVjdCcgOiAnc2hvdyddKHBhdGgsIGZuKTtcbiAgICAgIC8vIHN0YXJ0IFtvcHRpb25zXVxuICAgIH0gZWxzZSB7XG4gICAgICBwYWdlLnN0YXJ0KHBhdGgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmdW5jdGlvbnMuXG4gICAqL1xuXG4gIHBhZ2UuY2FsbGJhY2tzID0gW107XG4gIHBhZ2UuZXhpdHMgPSBbXTtcblxuICAvKipcbiAgICogQ3VycmVudCBwYXRoIGJlaW5nIHByb2Nlc3NlZFxuICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgKi9cbiAgcGFnZS5jdXJyZW50ID0gJyc7XG5cbiAgLyoqXG4gICAqIE51bWJlciBvZiBwYWdlcyBuYXZpZ2F0ZWQgdG8uXG4gICAqIEB0eXBlIHtudW1iZXJ9XG4gICAqXG4gICAqICAgICBwYWdlLmxlbiA9PSAwO1xuICAgKiAgICAgcGFnZSgnL2xvZ2luJyk7XG4gICAqICAgICBwYWdlLmxlbiA9PSAxO1xuICAgKi9cblxuICBwYWdlLmxlbiA9IDA7XG5cbiAgLyoqXG4gICAqIEdldCBvciBzZXQgYmFzZXBhdGggdG8gYHBhdGhgLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBwYWdlLmJhc2UgPSBmdW5jdGlvbihwYXRoKSB7XG4gICAgaWYgKDAgPT09IGFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBiYXNlO1xuICAgIGJhc2UgPSBwYXRoO1xuICB9O1xuXG4gIC8qKlxuICAgKiBCaW5kIHdpdGggdGhlIGdpdmVuIGBvcHRpb25zYC5cbiAgICpcbiAgICogT3B0aW9uczpcbiAgICpcbiAgICogICAgLSBgY2xpY2tgIGJpbmQgdG8gY2xpY2sgZXZlbnRzIFt0cnVlXVxuICAgKiAgICAtIGBwb3BzdGF0ZWAgYmluZCB0byBwb3BzdGF0ZSBbdHJ1ZV1cbiAgICogICAgLSBgZGlzcGF0Y2hgIHBlcmZvcm0gaW5pdGlhbCBkaXNwYXRjaCBbdHJ1ZV1cbiAgICpcbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgcGFnZS5zdGFydCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBpZiAocnVubmluZykgcmV0dXJuO1xuICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgIGlmIChmYWxzZSA9PT0gb3B0aW9ucy5kaXNwYXRjaCkgZGlzcGF0Y2ggPSBmYWxzZTtcbiAgICBpZiAoZmFsc2UgPT09IG9wdGlvbnMuZGVjb2RlVVJMQ29tcG9uZW50cykgZGVjb2RlVVJMQ29tcG9uZW50cyA9IGZhbHNlO1xuICAgIGlmIChmYWxzZSAhPT0gb3B0aW9ucy5wb3BzdGF0ZSkgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BvcHN0YXRlJywgb25wb3BzdGF0ZSwgZmFsc2UpO1xuICAgIGlmIChmYWxzZSAhPT0gb3B0aW9ucy5jbGljaykge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihjbGlja0V2ZW50LCBvbmNsaWNrLCBmYWxzZSk7XG4gICAgfVxuICAgIGlmICh0cnVlID09PSBvcHRpb25zLmhhc2hiYW5nKSBoYXNoYmFuZyA9IHRydWU7XG4gICAgaWYgKCFkaXNwYXRjaCkgcmV0dXJuO1xuICAgIHZhciB1cmwgPSAoaGFzaGJhbmcgJiYgfmxvY2F0aW9uLmhhc2guaW5kZXhPZignIyEnKSkgPyBsb2NhdGlvbi5oYXNoLnN1YnN0cigyKSArIGxvY2F0aW9uLnNlYXJjaCA6IGxvY2F0aW9uLnBhdGhuYW1lICsgbG9jYXRpb24uc2VhcmNoICsgbG9jYXRpb24uaGFzaDtcbiAgICBwYWdlLnJlcGxhY2UodXJsLCBudWxsLCB0cnVlLCBkaXNwYXRjaCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVuYmluZCBjbGljayBhbmQgcG9wc3RhdGUgZXZlbnQgaGFuZGxlcnMuXG4gICAqXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIHBhZ2Uuc3RvcCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghcnVubmluZykgcmV0dXJuO1xuICAgIHBhZ2UuY3VycmVudCA9ICcnO1xuICAgIHBhZ2UubGVuID0gMDtcbiAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihjbGlja0V2ZW50LCBvbmNsaWNrLCBmYWxzZSk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvcHN0YXRlJywgb25wb3BzdGF0ZSwgZmFsc2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTaG93IGBwYXRoYCB3aXRoIG9wdGlvbmFsIGBzdGF0ZWAgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxuICAgKiBAcGFyYW0ge09iamVjdD19IHN0YXRlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IGRpc3BhdGNoXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IHB1c2hcbiAgICogQHJldHVybiB7IUNvbnRleHR9XG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIHBhZ2Uuc2hvdyA9IGZ1bmN0aW9uKHBhdGgsIHN0YXRlLCBkaXNwYXRjaCwgcHVzaCkge1xuICAgIHZhciBjdHggPSBuZXcgQ29udGV4dChwYXRoLCBzdGF0ZSk7XG4gICAgcGFnZS5jdXJyZW50ID0gY3R4LnBhdGg7XG4gICAgaWYgKGZhbHNlICE9PSBkaXNwYXRjaCkgcGFnZS5kaXNwYXRjaChjdHgpO1xuICAgIGlmIChmYWxzZSAhPT0gY3R4LmhhbmRsZWQgJiYgZmFsc2UgIT09IHB1c2gpIGN0eC5wdXNoU3RhdGUoKTtcbiAgICByZXR1cm4gY3R4O1xuICB9O1xuXG4gIC8qKlxuICAgKiBHb2VzIGJhY2sgaW4gdGhlIGhpc3RvcnlcbiAgICogQmFjayBzaG91bGQgYWx3YXlzIGxldCB0aGUgY3VycmVudCByb3V0ZSBwdXNoIHN0YXRlIGFuZCB0aGVuIGdvIGJhY2suXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIC0gZmFsbGJhY2sgcGF0aCB0byBnbyBiYWNrIGlmIG5vIG1vcmUgaGlzdG9yeSBleGlzdHMsIGlmIHVuZGVmaW5lZCBkZWZhdWx0cyB0byBwYWdlLmJhc2VcbiAgICogQHBhcmFtIHtPYmplY3Q9fSBzdGF0ZVxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBwYWdlLmJhY2sgPSBmdW5jdGlvbihwYXRoLCBzdGF0ZSkge1xuICAgIGlmIChwYWdlLmxlbiA+IDApIHtcbiAgICAgIC8vIHRoaXMgbWF5IG5lZWQgbW9yZSB0ZXN0aW5nIHRvIHNlZSBpZiBhbGwgYnJvd3NlcnNcbiAgICAgIC8vIHdhaXQgZm9yIHRoZSBuZXh0IHRpY2sgdG8gZ28gYmFjayBpbiBoaXN0b3J5XG4gICAgICBoaXN0b3J5LmJhY2soKTtcbiAgICAgIHBhZ2UubGVuLS07XG4gICAgfSBlbHNlIGlmIChwYXRoKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBwYWdlLnNob3cocGF0aCwgc3RhdGUpO1xuICAgICAgfSk7XG4gICAgfWVsc2V7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBwYWdlLnNob3coYmFzZSwgc3RhdGUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIHJvdXRlIHRvIHJlZGlyZWN0IGZyb20gb25lIHBhdGggdG8gb3RoZXJcbiAgICogb3IganVzdCByZWRpcmVjdCB0byBhbm90aGVyIHJvdXRlXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmcm9tIC0gaWYgcGFyYW0gJ3RvJyBpcyB1bmRlZmluZWQgcmVkaXJlY3RzIHRvICdmcm9tJ1xuICAgKiBAcGFyYW0ge3N0cmluZz19IHRvXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuICBwYWdlLnJlZGlyZWN0ID0gZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgICAvLyBEZWZpbmUgcm91dGUgZnJvbSBhIHBhdGggdG8gYW5vdGhlclxuICAgIGlmICgnc3RyaW5nJyA9PT0gdHlwZW9mIGZyb20gJiYgJ3N0cmluZycgPT09IHR5cGVvZiB0bykge1xuICAgICAgcGFnZShmcm9tLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcGFnZS5yZXBsYWNlKC8qKiBAdHlwZSB7IXN0cmluZ30gKi8gKHRvKSk7XG4gICAgICAgIH0sIDApO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2FpdCBmb3IgdGhlIHB1c2ggc3RhdGUgYW5kIHJlcGxhY2UgaXQgd2l0aCBhbm90aGVyXG4gICAgaWYgKCdzdHJpbmcnID09PSB0eXBlb2YgZnJvbSAmJiAndW5kZWZpbmVkJyA9PT0gdHlwZW9mIHRvKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBwYWdlLnJlcGxhY2UoZnJvbSk7XG4gICAgICB9LCAwKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlcGxhY2UgYHBhdGhgIHdpdGggb3B0aW9uYWwgYHN0YXRlYCBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXG4gICAqIEBwYXJhbSB7T2JqZWN0PX0gc3RhdGVcbiAgICogQHBhcmFtIHtib29sZWFuPX0gaW5pdFxuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBkaXNwYXRjaFxuICAgKiBAcmV0dXJuIHshQ29udGV4dH1cbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cblxuICBwYWdlLnJlcGxhY2UgPSBmdW5jdGlvbihwYXRoLCBzdGF0ZSwgaW5pdCwgZGlzcGF0Y2gpIHtcbiAgICB2YXIgY3R4ID0gbmV3IENvbnRleHQocGF0aCwgc3RhdGUpO1xuICAgIHBhZ2UuY3VycmVudCA9IGN0eC5wYXRoO1xuICAgIGN0eC5pbml0ID0gaW5pdDtcbiAgICBjdHguc2F2ZSgpOyAvLyBzYXZlIGJlZm9yZSBkaXNwYXRjaGluZywgd2hpY2ggbWF5IHJlZGlyZWN0XG4gICAgaWYgKGZhbHNlICE9PSBkaXNwYXRjaCkgcGFnZS5kaXNwYXRjaChjdHgpO1xuICAgIHJldHVybiBjdHg7XG4gIH07XG5cbiAgLyoqXG4gICAqIERpc3BhdGNoIHRoZSBnaXZlbiBgY3R4YC5cbiAgICpcbiAgICogQHBhcmFtIHtDb250ZXh0fSBjdHhcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuICBwYWdlLmRpc3BhdGNoID0gZnVuY3Rpb24oY3R4KSB7XG4gICAgdmFyIHByZXYgPSBwcmV2Q29udGV4dCxcbiAgICAgIGkgPSAwLFxuICAgICAgaiA9IDA7XG5cbiAgICBwcmV2Q29udGV4dCA9IGN0eDtcblxuICAgIGZ1bmN0aW9uIG5leHRFeGl0KCkge1xuICAgICAgdmFyIGZuID0gcGFnZS5leGl0c1tqKytdO1xuICAgICAgaWYgKCFmbikgcmV0dXJuIG5leHRFbnRlcigpO1xuICAgICAgZm4ocHJldiwgbmV4dEV4aXQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5leHRFbnRlcigpIHtcbiAgICAgIHZhciBmbiA9IHBhZ2UuY2FsbGJhY2tzW2krK107XG5cbiAgICAgIGlmIChjdHgucGF0aCAhPT0gcGFnZS5jdXJyZW50KSB7XG4gICAgICAgIGN0eC5oYW5kbGVkID0gZmFsc2U7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICghZm4pIHJldHVybiB1bmhhbmRsZWQoY3R4KTtcbiAgICAgIGZuKGN0eCwgbmV4dEVudGVyKTtcbiAgICB9XG5cbiAgICBpZiAocHJldikge1xuICAgICAgbmV4dEV4aXQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmV4dEVudGVyKCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBVbmhhbmRsZWQgYGN0eGAuIFdoZW4gaXQncyBub3QgdGhlIGluaXRpYWxcbiAgICogcG9wc3RhdGUgdGhlbiByZWRpcmVjdC4gSWYgeW91IHdpc2ggdG8gaGFuZGxlXG4gICAqIDQwNHMgb24geW91ciBvd24gdXNlIGBwYWdlKCcqJywgY2FsbGJhY2spYC5cbiAgICpcbiAgICogQHBhcmFtIHtDb250ZXh0fSBjdHhcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuICBmdW5jdGlvbiB1bmhhbmRsZWQoY3R4KSB7XG4gICAgaWYgKGN0eC5oYW5kbGVkKSByZXR1cm47XG4gICAgdmFyIGN1cnJlbnQ7XG5cbiAgICBpZiAoaGFzaGJhbmcpIHtcbiAgICAgIGN1cnJlbnQgPSBiYXNlICsgbG9jYXRpb24uaGFzaC5yZXBsYWNlKCcjIScsICcnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VycmVudCA9IGxvY2F0aW9uLnBhdGhuYW1lICsgbG9jYXRpb24uc2VhcmNoO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50ID09PSBjdHguY2Fub25pY2FsUGF0aCkgcmV0dXJuO1xuICAgIHBhZ2Uuc3RvcCgpO1xuICAgIGN0eC5oYW5kbGVkID0gZmFsc2U7XG4gICAgbG9jYXRpb24uaHJlZiA9IGN0eC5jYW5vbmljYWxQYXRoO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGFuIGV4aXQgcm91dGUgb24gYHBhdGhgIHdpdGhcbiAgICogY2FsbGJhY2sgYGZuKClgLCB3aGljaCB3aWxsIGJlIGNhbGxlZFxuICAgKiBvbiB0aGUgcHJldmlvdXMgY29udGV4dCB3aGVuIGEgbmV3XG4gICAqIHBhZ2UgaXMgdmlzaXRlZC5cbiAgICovXG4gIHBhZ2UuZXhpdCA9IGZ1bmN0aW9uKHBhdGgsIGZuKSB7XG4gICAgaWYgKHR5cGVvZiBwYXRoID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gcGFnZS5leGl0KCcqJywgcGF0aCk7XG4gICAgfVxuXG4gICAgdmFyIHJvdXRlID0gbmV3IFJvdXRlKHBhdGgpO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgICBwYWdlLmV4aXRzLnB1c2gocm91dGUubWlkZGxld2FyZShhcmd1bWVudHNbaV0pKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBVUkwgZW5jb2RpbmcgZnJvbSB0aGUgZ2l2ZW4gYHN0cmAuXG4gICAqIEFjY29tbW9kYXRlcyB3aGl0ZXNwYWNlIGluIGJvdGggeC13d3ctZm9ybS11cmxlbmNvZGVkXG4gICAqIGFuZCByZWd1bGFyIHBlcmNlbnQtZW5jb2RlZCBmb3JtLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsIC0gVVJMIGNvbXBvbmVudCB0byBkZWNvZGVcbiAgICovXG4gIGZ1bmN0aW9uIGRlY29kZVVSTEVuY29kZWRVUklDb21wb25lbnQodmFsKSB7XG4gICAgaWYgKHR5cGVvZiB2YWwgIT09ICdzdHJpbmcnKSB7IHJldHVybiB2YWw7IH1cbiAgICByZXR1cm4gZGVjb2RlVVJMQ29tcG9uZW50cyA/IGRlY29kZVVSSUNvbXBvbmVudCh2YWwucmVwbGFjZSgvXFwrL2csICcgJykpIDogdmFsO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYSBuZXcgXCJyZXF1ZXN0XCIgYENvbnRleHRgXG4gICAqIHdpdGggdGhlIGdpdmVuIGBwYXRoYCBhbmQgb3B0aW9uYWwgaW5pdGlhbCBgc3RhdGVgLlxuICAgKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcbiAgICogQHBhcmFtIHtPYmplY3Q9fSBzdGF0ZVxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBmdW5jdGlvbiBDb250ZXh0KHBhdGgsIHN0YXRlKSB7XG4gICAgaWYgKCcvJyA9PT0gcGF0aFswXSAmJiAwICE9PSBwYXRoLmluZGV4T2YoYmFzZSkpIHBhdGggPSBiYXNlICsgKGhhc2hiYW5nID8gJyMhJyA6ICcnKSArIHBhdGg7XG4gICAgdmFyIGkgPSBwYXRoLmluZGV4T2YoJz8nKTtcblxuICAgIHRoaXMuY2Fub25pY2FsUGF0aCA9IHBhdGg7XG4gICAgdGhpcy5wYXRoID0gcGF0aC5yZXBsYWNlKGJhc2UsICcnKSB8fCAnLyc7XG4gICAgaWYgKGhhc2hiYW5nKSB0aGlzLnBhdGggPSB0aGlzLnBhdGgucmVwbGFjZSgnIyEnLCAnJykgfHwgJy8nO1xuXG4gICAgdGhpcy50aXRsZSA9IGRvY3VtZW50LnRpdGxlO1xuICAgIHRoaXMuc3RhdGUgPSBzdGF0ZSB8fCB7fTtcbiAgICB0aGlzLnN0YXRlLnBhdGggPSBwYXRoO1xuICAgIHRoaXMucXVlcnlzdHJpbmcgPSB+aSA/IGRlY29kZVVSTEVuY29kZWRVUklDb21wb25lbnQocGF0aC5zbGljZShpICsgMSkpIDogJyc7XG4gICAgdGhpcy5wYXRobmFtZSA9IGRlY29kZVVSTEVuY29kZWRVUklDb21wb25lbnQofmkgPyBwYXRoLnNsaWNlKDAsIGkpIDogcGF0aCk7XG4gICAgdGhpcy5wYXJhbXMgPSB7fTtcblxuICAgIC8vIGZyYWdtZW50XG4gICAgdGhpcy5oYXNoID0gJyc7XG4gICAgaWYgKCFoYXNoYmFuZykge1xuICAgICAgaWYgKCF+dGhpcy5wYXRoLmluZGV4T2YoJyMnKSkgcmV0dXJuO1xuICAgICAgdmFyIHBhcnRzID0gdGhpcy5wYXRoLnNwbGl0KCcjJyk7XG4gICAgICB0aGlzLnBhdGggPSBwYXJ0c1swXTtcbiAgICAgIHRoaXMuaGFzaCA9IGRlY29kZVVSTEVuY29kZWRVUklDb21wb25lbnQocGFydHNbMV0pIHx8ICcnO1xuICAgICAgdGhpcy5xdWVyeXN0cmluZyA9IHRoaXMucXVlcnlzdHJpbmcuc3BsaXQoJyMnKVswXTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXhwb3NlIGBDb250ZXh0YC5cbiAgICovXG5cbiAgcGFnZS5Db250ZXh0ID0gQ29udGV4dDtcblxuICAvKipcbiAgICogUHVzaCBzdGF0ZS5cbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIENvbnRleHQucHJvdG90eXBlLnB1c2hTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHBhZ2UubGVuKys7XG4gICAgaGlzdG9yeS5wdXNoU3RhdGUodGhpcy5zdGF0ZSwgdGhpcy50aXRsZSwgaGFzaGJhbmcgJiYgdGhpcy5wYXRoICE9PSAnLycgPyAnIyEnICsgdGhpcy5wYXRoIDogdGhpcy5jYW5vbmljYWxQYXRoKTtcbiAgfTtcblxuICAvKipcbiAgICogU2F2ZSB0aGUgY29udGV4dCBzdGF0ZS5cbiAgICpcbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgQ29udGV4dC5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuICAgIGhpc3RvcnkucmVwbGFjZVN0YXRlKHRoaXMuc3RhdGUsIHRoaXMudGl0bGUsIGhhc2hiYW5nICYmIHRoaXMucGF0aCAhPT0gJy8nID8gJyMhJyArIHRoaXMucGF0aCA6IHRoaXMuY2Fub25pY2FsUGF0aCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYFJvdXRlYCB3aXRoIHRoZSBnaXZlbiBIVFRQIGBwYXRoYCxcbiAgICogYW5kIGFuIGFycmF5IG9mIGBjYWxsYmFja3NgIGFuZCBgb3B0aW9uc2AuXG4gICAqXG4gICAqIE9wdGlvbnM6XG4gICAqXG4gICAqICAgLSBgc2Vuc2l0aXZlYCAgICBlbmFibGUgY2FzZS1zZW5zaXRpdmUgcm91dGVzXG4gICAqICAgLSBgc3RyaWN0YCAgICAgICBlbmFibGUgc3RyaWN0IG1hdGNoaW5nIGZvciB0cmFpbGluZyBzbGFzaGVzXG4gICAqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxuICAgKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnNcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIGZ1bmN0aW9uIFJvdXRlKHBhdGgsIG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICB0aGlzLnBhdGggPSAocGF0aCA9PT0gJyonKSA/ICcoLiopJyA6IHBhdGg7XG4gICAgdGhpcy5tZXRob2QgPSAnR0VUJztcbiAgICB0aGlzLnJlZ2V4cCA9IHBhdGh0b1JlZ2V4cCh0aGlzLnBhdGgsXG4gICAgICB0aGlzLmtleXMgPSBbXSxcbiAgICAgIG9wdGlvbnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4cG9zZSBgUm91dGVgLlxuICAgKi9cblxuICBwYWdlLlJvdXRlID0gUm91dGU7XG5cbiAgLyoqXG4gICAqIFJldHVybiByb3V0ZSBtaWRkbGV3YXJlIHdpdGhcbiAgICogdGhlIGdpdmVuIGNhbGxiYWNrIGBmbigpYC5cbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIFJvdXRlLnByb3RvdHlwZS5taWRkbGV3YXJlID0gZnVuY3Rpb24oZm4pIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGN0eCwgbmV4dCkge1xuICAgICAgaWYgKHNlbGYubWF0Y2goY3R4LnBhdGgsIGN0eC5wYXJhbXMpKSByZXR1cm4gZm4oY3R4LCBuZXh0KTtcbiAgICAgIG5leHQoKTtcbiAgICB9O1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiB0aGlzIHJvdXRlIG1hdGNoZXMgYHBhdGhgLCBpZiBzb1xuICAgKiBwb3B1bGF0ZSBgcGFyYW1zYC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgUm91dGUucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24ocGF0aCwgcGFyYW1zKSB7XG4gICAgdmFyIGtleXMgPSB0aGlzLmtleXMsXG4gICAgICBxc0luZGV4ID0gcGF0aC5pbmRleE9mKCc/JyksXG4gICAgICBwYXRobmFtZSA9IH5xc0luZGV4ID8gcGF0aC5zbGljZSgwLCBxc0luZGV4KSA6IHBhdGgsXG4gICAgICBtID0gdGhpcy5yZWdleHAuZXhlYyhkZWNvZGVVUklDb21wb25lbnQocGF0aG5hbWUpKTtcblxuICAgIGlmICghbSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgZm9yICh2YXIgaSA9IDEsIGxlbiA9IG0ubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgIHZhciBrZXkgPSBrZXlzW2kgLSAxXTtcbiAgICAgIHZhciB2YWwgPSBkZWNvZGVVUkxFbmNvZGVkVVJJQ29tcG9uZW50KG1baV0pO1xuICAgICAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkIHx8ICEoaGFzT3duUHJvcGVydHkuY2FsbChwYXJhbXMsIGtleS5uYW1lKSkpIHtcbiAgICAgICAgcGFyYW1zW2tleS5uYW1lXSA9IHZhbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuXG4gIC8qKlxuICAgKiBIYW5kbGUgXCJwb3B1bGF0ZVwiIGV2ZW50cy5cbiAgICovXG5cbiAgdmFyIG9ucG9wc3RhdGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBsb2FkZWQgPSBmYWxzZTtcbiAgICBpZiAoJ3VuZGVmaW5lZCcgPT09IHR5cGVvZiB3aW5kb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHtcbiAgICAgIGxvYWRlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgfSwgMCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uIG9ucG9wc3RhdGUoZSkge1xuICAgICAgaWYgKCFsb2FkZWQpIHJldHVybjtcbiAgICAgIGlmIChlLnN0YXRlKSB7XG4gICAgICAgIHZhciBwYXRoID0gZS5zdGF0ZS5wYXRoO1xuICAgICAgICBwYWdlLnJlcGxhY2UocGF0aCwgZS5zdGF0ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYWdlLnNob3cobG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5oYXNoLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZmFsc2UpO1xuICAgICAgfVxuICAgIH07XG4gIH0pKCk7XG4gIC8qKlxuICAgKiBIYW5kbGUgXCJjbGlja1wiIGV2ZW50cy5cbiAgICovXG5cbiAgZnVuY3Rpb24gb25jbGljayhlKSB7XG5cbiAgICBpZiAoMSAhPT0gd2hpY2goZSkpIHJldHVybjtcblxuICAgIGlmIChlLm1ldGFLZXkgfHwgZS5jdHJsS2V5IHx8IGUuc2hpZnRLZXkpIHJldHVybjtcbiAgICBpZiAoZS5kZWZhdWx0UHJldmVudGVkKSByZXR1cm47XG5cblxuXG4gICAgLy8gZW5zdXJlIGxpbmtcbiAgICAvLyB1c2Ugc2hhZG93IGRvbSB3aGVuIGF2YWlsYWJsZVxuICAgIHZhciBlbCA9IGUucGF0aCA/IGUucGF0aFswXSA6IGUudGFyZ2V0O1xuICAgIHdoaWxlIChlbCAmJiAnQScgIT09IGVsLm5vZGVOYW1lKSBlbCA9IGVsLnBhcmVudE5vZGU7XG4gICAgaWYgKCFlbCB8fCAnQScgIT09IGVsLm5vZGVOYW1lKSByZXR1cm47XG5cblxuXG4gICAgLy8gSWdub3JlIGlmIHRhZyBoYXNcbiAgICAvLyAxLiBcImRvd25sb2FkXCIgYXR0cmlidXRlXG4gICAgLy8gMi4gcmVsPVwiZXh0ZXJuYWxcIiBhdHRyaWJ1dGVcbiAgICBpZiAoZWwuaGFzQXR0cmlidXRlKCdkb3dubG9hZCcpIHx8IGVsLmdldEF0dHJpYnV0ZSgncmVsJykgPT09ICdleHRlcm5hbCcpIHJldHVybjtcblxuICAgIC8vIGVuc3VyZSBub24taGFzaCBmb3IgdGhlIHNhbWUgcGF0aFxuICAgIHZhciBsaW5rID0gZWwuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgaWYgKCFoYXNoYmFuZyAmJiBlbC5wYXRobmFtZSA9PT0gbG9jYXRpb24ucGF0aG5hbWUgJiYgKGVsLmhhc2ggfHwgJyMnID09PSBsaW5rKSkgcmV0dXJuO1xuXG5cblxuICAgIC8vIENoZWNrIGZvciBtYWlsdG86IGluIHRoZSBocmVmXG4gICAgaWYgKGxpbmsgJiYgbGluay5pbmRleE9mKCdtYWlsdG86JykgPiAtMSkgcmV0dXJuO1xuXG4gICAgLy8gY2hlY2sgdGFyZ2V0XG4gICAgaWYgKGVsLnRhcmdldCkgcmV0dXJuO1xuXG4gICAgLy8geC1vcmlnaW5cbiAgICBpZiAoIXNhbWVPcmlnaW4oZWwuaHJlZikpIHJldHVybjtcblxuXG5cbiAgICAvLyByZWJ1aWxkIHBhdGhcbiAgICB2YXIgcGF0aCA9IGVsLnBhdGhuYW1lICsgZWwuc2VhcmNoICsgKGVsLmhhc2ggfHwgJycpO1xuXG4gICAgLy8gc3RyaXAgbGVhZGluZyBcIi9bZHJpdmUgbGV0dGVyXTpcIiBvbiBOVy5qcyBvbiBXaW5kb3dzXG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwYXRoLm1hdGNoKC9eXFwvW2EtekEtWl06XFwvLykpIHtcbiAgICAgIHBhdGggPSBwYXRoLnJlcGxhY2UoL15cXC9bYS16QS1aXTpcXC8vLCAnLycpO1xuICAgIH1cblxuICAgIC8vIHNhbWUgcGFnZVxuICAgIHZhciBvcmlnID0gcGF0aDtcblxuICAgIGlmIChwYXRoLmluZGV4T2YoYmFzZSkgPT09IDApIHtcbiAgICAgIHBhdGggPSBwYXRoLnN1YnN0cihiYXNlLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgaWYgKGhhc2hiYW5nKSBwYXRoID0gcGF0aC5yZXBsYWNlKCcjIScsICcnKTtcblxuICAgIGlmIChiYXNlICYmIG9yaWcgPT09IHBhdGgpIHJldHVybjtcblxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBwYWdlLnNob3cob3JpZyk7XG4gIH1cblxuICAvKipcbiAgICogRXZlbnQgYnV0dG9uLlxuICAgKi9cblxuICBmdW5jdGlvbiB3aGljaChlKSB7XG4gICAgZSA9IGUgfHwgd2luZG93LmV2ZW50O1xuICAgIHJldHVybiBudWxsID09PSBlLndoaWNoID8gZS5idXR0b24gOiBlLndoaWNoO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGBocmVmYCBpcyB0aGUgc2FtZSBvcmlnaW4uXG4gICAqL1xuXG4gIGZ1bmN0aW9uIHNhbWVPcmlnaW4oaHJlZikge1xuICAgIHZhciBvcmlnaW4gPSBsb2NhdGlvbi5wcm90b2NvbCArICcvLycgKyBsb2NhdGlvbi5ob3N0bmFtZTtcbiAgICBpZiAobG9jYXRpb24ucG9ydCkgb3JpZ2luICs9ICc6JyArIGxvY2F0aW9uLnBvcnQ7XG4gICAgcmV0dXJuIChocmVmICYmICgwID09PSBocmVmLmluZGV4T2Yob3JpZ2luKSkpO1xuICB9XG5cbiAgcGFnZS5zYW1lT3JpZ2luID0gc2FtZU9yaWdpbjtcbiJdfQ==","var isarray = require('isarray')\n\n/**\n * Expose `pathToRegexp`.\n */\nmodule.exports = pathToRegexp\nmodule.exports.parse = parse\nmodule.exports.compile = compile\nmodule.exports.tokensToFunction = tokensToFunction\nmodule.exports.tokensToRegExp = tokensToRegExp\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \"/:test(\\\\d+)?\" => [\"/\", \"test\", \"\\d+\", undefined, \"?\", undefined]\n  // \"/route(\\\\d+)\"  => [undefined, undefined, undefined, \"\\d+\", undefined, undefined]\n  // \"/*\"            => [\"/\", undefined, undefined, undefined, undefined, \"*\"]\n  '([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^()])+)\\\\))([+*?])?|(\\\\*))'\n].join('|'), 'g')\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {String} str\n * @return {Array}\n */\nfunction parse (str) {\n  var tokens = []\n  var key = 0\n  var index = 0\n  var path = ''\n  var res\n\n  while ((res = PATH_REGEXP.exec(str)) != null) {\n    var m = res[0]\n    var escaped = res[1]\n    var offset = res.index\n    path += str.slice(index, offset)\n    index = offset + m.length\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1]\n      continue\n    }\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path)\n      path = ''\n    }\n\n    var prefix = res[2]\n    var name = res[3]\n    var capture = res[4]\n    var group = res[5]\n    var suffix = res[6]\n    var asterisk = res[7]\n\n    var repeat = suffix === '+' || suffix === '*'\n    var optional = suffix === '?' || suffix === '*'\n    var delimiter = prefix || '/'\n    var pattern = capture || group || (asterisk ? '.*' : '[^' + delimiter + ']+?')\n\n    tokens.push({\n      name: name || key++,\n      prefix: prefix || '',\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      pattern: escapeGroup(pattern)\n    })\n  }\n\n  // Match any characters still remaining.\n  if (index < str.length) {\n    path += str.substr(index)\n  }\n\n  // If the path exists, push it onto the end.\n  if (path) {\n    tokens.push(path)\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {String}   str\n * @return {Function}\n */\nfunction compile (str) {\n  return tokensToFunction(parse(str))\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length)\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^' + tokens[i].pattern + '$')\n    }\n  }\n\n  return function (obj) {\n    var path = ''\n    var data = obj || {}\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i]\n\n      if (typeof token === 'string') {\n        path += token\n\n        continue\n      }\n\n      var value = data[token.name]\n      var segment\n\n      if (value == null) {\n        if (token.optional) {\n          continue\n        } else {\n          throw new TypeError('Expected \"' + token.name + '\" to be defined')\n        }\n      }\n\n      if (isarray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but received \"' + value + '\"')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) {\n            continue\n          } else {\n            throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n          }\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encodeURIComponent(value[j])\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment\n        }\n\n        continue\n      }\n\n      segment = encodeURIComponent(value)\n\n      if (!matches[i].test(segment)) {\n        throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n      }\n\n      path += token.prefix + segment\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {String} str\n * @return {String}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|\\/])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {String} group\n * @return {String}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$\\/()])/g, '\\\\$1')\n}\n\n/**\n * Attach the keys as a property of the regexp.\n *\n * @param  {RegExp} re\n * @param  {Array}  keys\n * @return {RegExp}\n */\nfunction attachKeys (re, keys) {\n  re.keys = keys\n  return re\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {String}\n */\nfunction flags (options) {\n  return options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {RegExp} path\n * @param  {Array}  keys\n * @return {RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g)\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        pattern: null\n      })\n    }\n  }\n\n  return attachKeys(path, keys)\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {Array}  path\n * @param  {Array}  keys\n * @param  {Object} options\n * @return {RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = []\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source)\n  }\n\n  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options))\n\n  return attachKeys(regexp, keys)\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {String} path\n * @param  {Array}  keys\n * @param  {Object} options\n * @return {RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  var tokens = parse(path)\n  var re = tokensToRegExp(tokens, options)\n\n  // Attach keys back to the regexp.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] !== 'string') {\n      keys.push(tokens[i])\n    }\n  }\n\n  return attachKeys(re, keys)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {Array}  tokens\n * @param  {Array}  keys\n * @param  {Object} options\n * @return {RegExp}\n */\nfunction tokensToRegExp (tokens, options) {\n  options = options || {}\n\n  var strict = options.strict\n  var end = options.end !== false\n  var route = ''\n  var lastToken = tokens[tokens.length - 1]\n  var endsWithSlash = typeof lastToken === 'string' && /\\/$/.test(lastToken)\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n\n    if (typeof token === 'string') {\n      route += escapeString(token)\n    } else {\n      var prefix = escapeString(token.prefix)\n      var capture = token.pattern\n\n      if (token.repeat) {\n        capture += '(?:' + prefix + capture + ')*'\n      }\n\n      if (token.optional) {\n        if (prefix) {\n          capture = '(?:' + prefix + '(' + capture + '))?'\n        } else {\n          capture = '(' + capture + ')?'\n        }\n      } else {\n        capture = prefix + '(' + capture + ')'\n      }\n\n      route += capture\n    }\n  }\n\n  // In non-strict mode we allow a slash at the end of match. If the path to\n  // match already ends with a slash, we remove it for consistency. The slash\n  // is valid at the end of a path match, not in the middle. This is important\n  // in non-ending mode, where \"/test/\" shouldn't match \"/test//route\".\n  if (!strict) {\n    route = (endsWithSlash ? route.slice(0, -2) : route) + '(?:\\\\/(?=$))?'\n  }\n\n  if (end) {\n    route += '$'\n  } else {\n    // In non-ending mode, we need the capturing groups to match as much as\n    // possible by using a positive lookahead to the end or next path segment.\n    route += strict && endsWithSlash ? '' : '(?=\\\\/|$)'\n  }\n\n  return new RegExp('^' + route, flags(options))\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(String|RegExp|Array)} path\n * @param  {Array}                 [keys]\n * @param  {Object}                [options]\n * @return {RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  keys = keys || []\n\n  if (!isarray(keys)) {\n    options = keys\n    keys = []\n  } else if (!options) {\n    options = {}\n  }\n\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, keys, options)\n  }\n\n  if (isarray(path)) {\n    return arrayToRegexp(path, keys, options)\n  }\n\n  return stringToRegexp(path, keys, options)\n}\n","import vuBuggyfill from 'viewport-units-buggyfill';\n\nexport const vu = vuBuggyfill.init\n\n// console.log(vuBuggyfill.init)\n\nexport const classList = () => {\n\n  if (typeof window.Element === \"undefined\" || \"classList\" in document.documentElement) return;\n\n  var prototype = Array.prototype,\n    push = prototype.push,\n    splice = prototype.splice,\n    join = prototype.join;\n\n  function DOMTokenList(el) {\n    this.el = el;\n    // The className needs to be trimmed and split on whitespace\n    // to retrieve a list of classes.\n    var classes = el.className.replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\n    for (var i = 0; i < classes.length; i++) {\n      push.call(this, classes[i]);\n    }\n  };\n\n  DOMTokenList.prototype = {\n    add: function(token) {\n      if (this.contains(token)) return;\n      push.call(this, token);\n      this.el.className = this.toString();\n    },\n    contains: function(token) {\n      return this.el.className.indexOf(token) != -1;\n    },\n    item: function(index) {\n      return this[index] || null;\n    },\n    remove: function(token) {\n      if (!this.contains(token)) return;\n      for (var i = 0; i < this.length; i++) {\n        if (this[i] == token) break;\n      }\n      splice.call(this, i, 1);\n      this.el.className = this.toString();\n    },\n    toString: function() {\n      return join.call(this, ' ');\n    },\n    toggle: function(token) {\n      if (!this.contains(token)) {\n        this.add(token);\n      } else {\n        this.remove(token);\n      }\n\n      return this.contains(token);\n    }\n  };\n\n  window.DOMTokenList = DOMTokenList;\n\n  function defineElementGetter(obj, prop, getter) {\n    if (Object.defineProperty) {\n      Object.defineProperty(obj, prop, {\n        get: getter\n      });\n    } else {\n      obj.__defineGetter__(prop, getter);\n    }\n  }\n\n  defineElementGetter(Element.prototype, 'classList', function() {\n    return new DOMTokenList(this);\n  });\n\n}\n\nexport const dataset = () => {\n\n  var forEach = [].forEach,\n    regex = /^data-(.+)/,\n    dashChar = /\\-([a-z])/ig,\n    el = document.createElement('div'),\n    mutationSupported = false,\n    match;\n\n  function detectMutation() {\n    mutationSupported = true;\n    this.removeEventListener('DOMAttrModified', detectMutation, false);\n  }\n\n  function toCamelCase(s) {\n    return s.replace(dashChar, function(m, l) {\n      return l.toUpperCase();\n    });\n  }\n\n  function updateDataset() {\n    var dataset = {};\n    forEach.call(this.attributes, function(attr) {\n      if (match = attr.name.match(regex))\n        dataset[toCamelCase(match[1])] = attr.value;\n    });\n    return dataset;\n  }\n\n  // only add support if the browser doesn't support data-* natively\n  if (el.dataset != undefined) return;\n\n  el.addEventListener('DOMAttrModified', detectMutation, false);\n  el.setAttribute('foo', 'bar');\n\n  function defineElementGetter(obj, prop, getter) {\n    if (Object.defineProperty) {\n      Object.defineProperty(obj, prop, {\n        get: getter\n      });\n    } else {\n      obj.__defineGetter__(prop, getter);\n    }\n  }\n\n  defineElementGetter(Element.prototype, 'dataset', mutationSupported ? function() {\n    if (!this._datasetCache) {\n      this._datasetCache = updateDataset.call(this);\n    }\n    return this._datasetCache;\n  } : updateDataset);\n\n  document.addEventListener('DOMAttrModified', function(event) {\n    delete event.target._datasetCache;\n  }, false);\n\n}","export function inRange(val, range) {\n  return val > range[0] && val < range[1]\n}\n\nexport function inCanvas(x, y, r, canvas) {\n  let w = canvas.width,\n      h = canvas.height\n\n  return (inRange(x, [-r , w + r]) && inRange(y, [-r , h + r]) )\n} \n\nexport function randomInt(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min\n}\n\nexport function randomNum(min, max) {\n  return Math.random() * (max - min) + min\n}\n\nexport function coords(x, y, canvas) {\n  return {\n      x: x * canvas.width / canvas.clientWidth,\n      y: y * canvas.height /  canvas.clientHeight\n  }\n}\n\nexport function inArray(item, array) {\n  return array.indexOf(item) > -1\n}\n\nexport function vw(ratio = 1) {\n  return window.innerWidth * ratio\n}\n\nexport function vh(ratio = 1) {\n  return window.innerHeight * ratio\n}\n\nexport function recur(fn, seed) {\n  let result = fn(seed)\n  if(!!result) {\n    recur(fn, result)\n  }\n} \n\nexport function selectorMatches(el, selector) {\n  let p = Element.prototype\n  let f = p.matches || p.webkitMatchesSelector || p.mozMatchesSelector || p.msMatchesSelector || function(s) {\n    return [].indexOf.call(document.querySelectorAll(s), this) !== -1\n  }\n  return f.call(el, selector)\n}\n\n/**\n *\n * Create a new DOM element\n *\n * @param {string} tagname - Element tagname ('iframe', 'div')\n * @param {object} attributes - Object of attributes to be assigned to the object.\n * @returns {HTMLElement} The DOM element\n *\n */\n\n\nexport function createElement(tagname, attributes = {}, data = {}) {\n  let el = document.createElement(tagname);\n\n  if(el.setAttribute) {\n    for (var k in  attributes) {\n      if (attributes.hasOwnProperty(k)) {\n        el.setAttribute(k, attributes[k])\n      }\n    }\n  }\n\n  el.dataset = data\n\n  return el;\n}\n\n\n/**\n *\n *  Element.addEventListener with event delegation\n *\n *  @param {HTMLElement} el - DOM element to which to append the eventListener\n *  @param {string} eventName - Name of the DOM event to be attached.\n *  @param {string} delegate - Selector string to use for delegation\n *  @param {function} handler - Event handler function\n *\n * @returns {undefined}\n * \n */\n\nexport function delegateEvent(el, eventName, delegate, handler) {\n  \n  if(typeof handler !== 'function') return;\n  if(el.addEventListener) {\n    el.addEventListener(eventName, (e) => {\n      if(selectorMatches(e.target, delegate)) {\n        handler(e);\n      }\n    })\n  }\n\n}\n\n\nexport function map(arrLike, cb) {\n  if(arrLike.length) {\n    return Array.prototype.map.call(arrLike, cb)\n  } else if(arrLike.length !== 'undefined' && arrLike.length == 0) {\n    return [];\n  } else if(arrLike) {\n    return Array.prototype.map.call([arrLike], cb)\n  }\n}\n\nexport function reduce(arrLike, cb, seed) {\n  if(arrLike.length) {\n    return Array.prototype.map.reduce(arrLike, cb)\n  } else if(arrLike) {\n    return Array.prototype.map.reduce([arrLike], cb)\n  }\n}\n\nexport  function extend(){\n  for(let i=1; i<arguments.length; i++)\n    for(let key in arguments[i])\n      if(arguments[i].hasOwnProperty(key))\n        arguments[0][key] = arguments[i][key];\n  return arguments[0];\n}\n","/** \n*\n* Video\n*\n*/\n\nimport { map } from './utils'\n\nexport function videoController(videoEl = null) {\n\n  if(!videoEl || !videoEl.play) {\n    return false\n  }\n\n  let srcs = map(videoEl.querySelectorAll('source'), sourceEl => {\n    sourceEl.src = sourceEl.dataset.src\n  })\n\n  return {\n    el: videoEl,\n\n    isLoaded: false,\n\n    load() {\n      videoEl.load()\n      this.isLoaded = true;\n    },\n\n    play() {\n      videoEl.play()\n    },\n\n    pause() {\n      videoEl.pause()\n    },\n\n    togglePlay() {\n      if(videoEl.paused) {\n        videoEl.play()\n      } else {\n        videoEl.pause()\n      }\n    } \n  }\n}","/** \n*\n* Contact\n*\n*/\n\n// import IScroll from 'iscroll'\n// import mouseEvent from '../modules/mouse-event'\nimport * as PubSub from 'pubsub-js'\nimport { delegateEvent, map, filter, extend } from '../modules/utils'\n\n// function formControlView() {\n//   `<div class=\"form__group form__group--select\">\n//     <label for=\"field-2\">Hello! I'm reaching out because:</label>\n//     <select id=\"field-2\" name=\"field-2\" class=\"form__control\">\n//       <option value=\"option1\">I'd like to hire you</option>\n//       <option value=\"option2\">I have an idea I would want to share with you</option>\n//       <option value=\"option3\">Just looking to connect</option>\n//     </select>\n//   </div>\n\n//   <div class=\"form__group form__group--boxed\">\n//     <label for=\"field-1\">What's your email?</label>\n//     <input id=\"field-1\" name=\"field-1\" type=\"text\" placeholder=\"Field 1\" class=\"form__control\" >\n//   </div>\n\n//   <div class=\"form__group form__group--boxed\">\n//     <label for=\"field-3\">Field 1</label>\n//     <input id=\"field-3\" name=\"field-3\" type=\"text\" placeholder=\"Field 1\" class=\"form__control\">\n//   </div>\n\n//   <div class=\"form__group form__group--boxed\">\n//     <label for=\"field-4\">Field 1</label>\n//     <input id=\"field-4\" name=\"field-4\" type=\"text\" placeholder=\"Field 1\" class=\"form__control\">\n//   </div>\n\n//   <div class=\"form__group form__group--boxed\">\n//     <label for=\"field-5\">Field 1</label>\n//     <input id=\"field-5\" name=\"field-5\" type=\"text\" placeholder=\"Field 1\" class=\"form__control\">\n//   </div>\n\n//   <div class=\"form__group form__group--boxed\">\n//     <label for=\"field-1\">Field 1</label>\n//     <input id=\"field-1\" name=\"field-1\" type=\"text\" placeholder=\"Field 1\" class=\"form__control\">\n//   </div>`\n// }\n\nfunction optionView(option) {\n  console.log(option)\n  return `<option value=\"${ option.value }\">${ option.label }</option>`\n}\n\nfunction labelView(label, id) {\n  return `<label for=\"${ id }\">${ label }</label>`\n}\n\nfunction inputVars(config, defaults) {\n  return extend({}, defaults, config)\n}\n\nfunction selectView(config) {\n\n  let { id, label, name, options } = inputVars(config, {\n    label: false,\n    id: config.name,\n    options: []\n  })\n\n  return `\n    <div class=\"form__group form__group--select\">\n      ${ labelView(label, id) }\n\n      <select id=\"${ id }\" name=\"${ name }\" class=\"form__control\">\n        ${ map(options, optionView) }\n      </select>\n    </div>\n  `\n}\n\nfunction inputView(config) {\n\n  let { id, label, type, placeholder, name } = inputVars(config, {\n    placeholder: '',\n    label: false,\n    id: config.name\n  })\n\n  return `\n    <div class=\"form__group form__group--boxed\">\n      ${ labelView(label, id) }\n      <input id=\"${ id }\" name=\"${ name }\" type=\"${ type }\" placeholder=\"${ placeholder }\" class=\"form__control\" >\n    </div>\n  `\n}\n\nfunction formControlView(field) {\n\n  if(!field.name) {\n    return false;\n  }\n\n  switch(field.type) {\n    case 'select':\n      return selectView(field)\n      break\n    case 'text':\n      return inputView(field)\n      break\n    default:\n      return false\n  } \n}\n\nfunction submitView(label) {\n  return `\n    <p class=\"text-center\">\n      <button type=\"submit\" class=\"btn btn--lg form__submit\">${ label }</button>\n    </p>\n  `\n}\n\n/** \n*\n* TODO\n*\n* Move input vars declaaration to formControls instantiation step\n*\n*/\nexport default function contactFormView(formEl,  config) {\n\n  const { fields, submit } = config\n\n\n  // array of form controls\n  const formControls = map(fields, field => formControlView(field))\n                         .filter(field => field)\n\n  // Submit for validation\n  formEl.addEventListener('submit', (e) => {\n    validate(formEl, formControls)\n  })\n\n  return {\n    render() {\n      formEl.innerHTML = formControls.join('') + submitView('Send')\n    }\n  }\n\n\n}","import * as PubSub from 'pubsub-js'\nimport { inRange, delegateEvent } from '../modules/utils'\n\nconst rootEl = document.body\nconst rootClass = rootEl.classList\n\nconst headerViewProto = {\n  isOpen: false,\n\n  init: (() => {\n\n  })(),\n\n  open() {\n    rootClass.add('is-menu-active')\n    PubSub.publish('header-view:open')\n    this.isOpen = true;\n  },\n  \n  close() {\n    rootClass.remove('is-menu-active')\n    PubSub.publish('header-view:close')\n    this.isOpen = false;\n  },\n\n  toggle() {\n\n    if(!this.isOpen) {\n      this.open()\n    } else {\n      this.close()\n    }\n\n    PubSub.publish('header-view:toggle')\n  }\n}\n\nconst headerView = (headerEl) => {\n\n  const view = Object.create(headerViewProto)\n  const toggleEl = headerEl.querySelector('[data-nav-toggle]')\n\n  if(!headerEl || !toggleEl) {\n    return false;\n  }\n\n  toggleEl.addEventListener('click',  () => view.toggle())\n  \n  window.addEventListener('keydown', (e) => {\n    if(e.keyCode == 27) {\n      view.close()\n    }\n  })\n\n  return view\n\n}\n\n\nexport default headerView","import * as PubSub from 'pubsub-js'\nimport { map, delegateEvent } from '../modules/utils'\n\nconst navViewProto = {\n  isOpen: false,\n\n  init() {\n    this.setStyle()\n  },\n\n  setStyle() {\n    const bgEls = this.el.querySelectorAll('[data-style]')\n    map(bgEls, (el) => {\n      if(el.dataset.style) {\n        el.setAttribute('style', el.dataset.style)\n      }\n    })\n  }\n}\n\nconst navView = (navEl) => {\n\n  const view = Object.create(navViewProto)\n\n  if(!navEl) {\n    return false;\n  }\n\n  view.el = navEl\n\n  return view\n\n}\n\nexport default navView","/** \n*\n* Page Sections\n*\n*/\n\nimport * as PubSub from 'pubsub-js'\nimport { map } from '../modules/utils'\n\nconst emitter = (el, eventName) => {\n\n  let event = false\n\n  if(typeof el == 'object') {\n    el.addEventListener(eventName, (e)=> {\n      PubSub.publish(eventName, e)\n    })\n  }\n\n}\n\nlet em = emitter(window, 'scroll')\n\nconst pageSectionsProto = {\n\n}\n\nconst scrollSubscription = (callback) => {\n  return PubSub.subscribe('scroll', (eventName, e) => {\n    if(typeof callback == 'function') {\n      callback(e)\n    }\n  })\n}\n\nfunction requestAnimation(cb) {\n  if ('requestAnimationFrame' in window) {\n    requestAnimationFrame(cb)\n  }\n}\n\nfunction elementInViewport(top, height) {\n  let { scrollY, innerHeight} = window\n  return (scrollY - height < top) && (scrollY + innerHeight > top)\n}\n\nfunction getOffsetTop( el ) {\n  let top = 0\n\n  while( el = el.offsetParent ) {\n    if ( !isNaN( el.offsetTop ) ) {\n      top += el.offsetTop\n    }\n  }\n\n  return top\n}\n\nfunction elementOffset(el) {\n\n  let top, height, rect\n  let parent = el.parentElement\n  \n  let update = () => {\n    // top = getOffsetTop(el),\n    height = el.offsetHeight\n  }\n\n  window.addEventListener('resize', update)\n  window.addEventListener('load', update)\n\n  update()\n\n  return {\n    height: height,\n  }\n}\n\nfunction sectionView(section, cb) {\n\n  let x = 0\n  let y = window.scrollY*0.2 + 'px'\n  let offset = elementOffset(section)\n  let { classList } = section\n  let cf = {\n    offset: 0\n  }\n\n  return {\n\n    el: section,\n\n    isInView: false,\n\n    set(k, v) {\n      cf[k] = v\n\n      return this\n    },\n\n    render() {\n\n      let rect = section.getBoundingClientRect()\n      let pub = (eventName) => {\n        PubSub.publish(eventName, this)\n      }\n\n      this.isInView = (0 > rect.top - innerHeight + parseInt(cf.offset))\n\n      if(this.isInView) {\n        classList.remove('is-out')\n        pub('section-view:enter')\n      } else if(!this.isInView && !classList.contains('is-out')) {\n        classList.add('is-out')\n        pub('section-view:leave')\n      }\n\n\n      return this\n    }\n  }\n\n}\n\n\n/** \n*\n* Single Project View\n*\n*/\n\nexport default function pageSections(sectionEls) {\n\n  let sectionViews = map(sectionEls, (section) => {\n    return sectionView(section)\n      .set('offset', section.dataset.offset || 50)\n  })\n\n\n  let subscriptionID = scrollSubscription((e) => {\n    sectionViews.map(view => view.render())\n  })\n\n  return sectionViews\n\n}","// shim for using process in browser\n\nvar process = module.exports = {};\n\nprocess.nextTick = (function () {\n    var canSetImmediate = typeof window !== 'undefined'\n    && window.setImmediate;\n    var canMutationObserver = typeof window !== 'undefined'\n    && window.MutationObserver;\n    var canPost = typeof window !== 'undefined'\n    && window.postMessage && window.addEventListener\n    ;\n\n    if (canSetImmediate) {\n        return function (f) { return window.setImmediate(f) };\n    }\n\n    var queue = [];\n\n    if (canMutationObserver) {\n        var hiddenDiv = document.createElement(\"div\");\n        var observer = new MutationObserver(function () {\n            var queueList = queue.slice();\n            queue.length = 0;\n            queueList.forEach(function (fn) {\n                fn();\n            });\n        });\n\n        observer.observe(hiddenDiv, { attributes: true });\n\n        return function nextTick(fn) {\n            if (!queue.length) {\n                hiddenDiv.setAttribute('yes', 'no');\n            }\n            queue.push(fn);\n        };\n    }\n\n    if (canPost) {\n        window.addEventListener('message', function (ev) {\n            var source = ev.source;\n            if ((source === window || source === null) && ev.data === 'process-tick') {\n                ev.stopPropagation();\n                if (queue.length > 0) {\n                    var fn = queue.shift();\n                    fn();\n                }\n            }\n        }, true);\n\n        return function nextTick(fn) {\n            queue.push(fn);\n            window.postMessage('process-tick', '*');\n        };\n    }\n\n    return function nextTick(fn) {\n        setTimeout(fn, 0);\n    };\n})();\n\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\n// TODO(shtylman)\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\n","/*\nCopyright (c) 2010,2011,2012,2013,2014 Morgan Roderick http://roderick.dk\nLicense: MIT - http://mrgnrdrck.mit-license.org\n\nhttps://github.com/mroderick/PubSubJS\n*/\n(function (root, factory){\n\t'use strict';\n\n    if (typeof define === 'function' && define.amd){\n        // AMD. Register as an anonymous module.\n        define(['exports'], factory);\n\n    } else if (typeof exports === 'object'){\n        // CommonJS\n        factory(exports);\n\n    }\n\n    // Browser globals\n    var PubSub = {};\n    root.PubSub = PubSub;\n    factory(PubSub);\n    \n}(( typeof window === 'object' && window ) || this, function (PubSub){\n\t'use strict';\n\n\tvar messages = {},\n\t\tlastUid = -1;\n\n\tfunction hasKeys(obj){\n\t\tvar key;\n\n\t\tfor (key in obj){\n\t\t\tif ( obj.hasOwnProperty(key) ){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t *\tReturns a function that throws the passed exception, for use as argument for setTimeout\n\t *\t@param { Object } ex An Error object\n\t */\n\tfunction throwException( ex ){\n\t\treturn function reThrowException(){\n\t\t\tthrow ex;\n\t\t};\n\t}\n\n\tfunction callSubscriberWithDelayedExceptions( subscriber, message, data ){\n\t\ttry {\n\t\t\tsubscriber( message, data );\n\t\t} catch( ex ){\n\t\t\tsetTimeout( throwException( ex ), 0);\n\t\t}\n\t}\n\n\tfunction callSubscriberWithImmediateExceptions( subscriber, message, data ){\n\t\tsubscriber( message, data );\n\t}\n\n\tfunction deliverMessage( originalMessage, matchedMessage, data, immediateExceptions ){\n\t\tvar subscribers = messages[matchedMessage],\n\t\t\tcallSubscriber = immediateExceptions ? callSubscriberWithImmediateExceptions : callSubscriberWithDelayedExceptions,\n\t\t\ts;\n\n\t\tif ( !messages.hasOwnProperty( matchedMessage ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (s in subscribers){\n\t\t\tif ( subscribers.hasOwnProperty(s)){\n\t\t\t\tcallSubscriber( subscribers[s], originalMessage, data );\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction createDeliveryFunction( message, data, immediateExceptions ){\n\t\treturn function deliverNamespaced(){\n\t\t\tvar topic = String( message ),\n\t\t\t\tposition = topic.lastIndexOf( '.' );\n\n\t\t\t// deliver the message as it is now\n\t\t\tdeliverMessage(message, message, data, immediateExceptions);\n\n\t\t\t// trim the hierarchy and deliver message to each level\n\t\t\twhile( position !== -1 ){\n\t\t\t\ttopic = topic.substr( 0, position );\n\t\t\t\tposition = topic.lastIndexOf('.');\n\t\t\t\tdeliverMessage( message, topic, data, immediateExceptions );\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction messageHasSubscribers( message ){\n\t\tvar topic = String( message ),\n\t\t\tfound = Boolean(messages.hasOwnProperty( topic ) && hasKeys(messages[topic])),\n\t\t\tposition = topic.lastIndexOf( '.' );\n\n\t\twhile ( !found && position !== -1 ){\n\t\t\ttopic = topic.substr( 0, position );\n\t\t\tposition = topic.lastIndexOf( '.' );\n\t\t\tfound = Boolean(messages.hasOwnProperty( topic ) && hasKeys(messages[topic]));\n\t\t}\n\n\t\treturn found;\n\t}\n\n\tfunction publish( message, data, sync, immediateExceptions ){\n\t\tvar deliver = createDeliveryFunction( message, data, immediateExceptions ),\n\t\t\thasSubscribers = messageHasSubscribers( message );\n\n\t\tif ( !hasSubscribers ){\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( sync === true ){\n\t\t\tdeliver();\n\t\t} else {\n\t\t\tsetTimeout( deliver, 0 );\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t *\tPubSub.publish( message[, data] ) -> Boolean\n\t *\t- message (String): The message to publish\n\t *\t- data: The data to pass to subscribers\n\t *\tPublishes the the message, passing the data to it's subscribers\n\t**/\n\tPubSub.publish = function( message, data ){\n\t\treturn publish( message, data, false, PubSub.immediateExceptions );\n\t};\n\n\t/**\n\t *\tPubSub.publishSync( message[, data] ) -> Boolean\n\t *\t- message (String): The message to publish\n\t *\t- data: The data to pass to subscribers\n\t *\tPublishes the the message synchronously, passing the data to it's subscribers\n\t**/\n\tPubSub.publishSync = function( message, data ){\n\t\treturn publish( message, data, true, PubSub.immediateExceptions );\n\t};\n\n\t/**\n\t *\tPubSub.subscribe( message, func ) -> String\n\t *\t- message (String): The message to subscribe to\n\t *\t- func (Function): The function to call when a new message is published\n\t *\tSubscribes the passed function to the passed message. Every returned token is unique and should be stored if\n\t *\tyou need to unsubscribe\n\t**/\n\tPubSub.subscribe = function( message, func ){\n\t\tif ( typeof func !== 'function'){\n\t\t\treturn false;\n\t\t}\n\n\t\t// message is not registered yet\n\t\tif ( !messages.hasOwnProperty( message ) ){\n\t\t\tmessages[message] = {};\n\t\t}\n\n\t\t// forcing token as String, to allow for future expansions without breaking usage\n\t\t// and allow for easy use as key names for the 'messages' object\n\t\tvar token = 'uid_' + String(++lastUid);\n\t\tmessages[message][token] = func;\n\n\t\t// return token for unsubscribing\n\t\treturn token;\n\t};\n\n\t/* Public: Clears all subscriptions\n\t */\n\tPubSub.clearAllSubscriptions = function clearAllSubscriptions(){\n\t\tmessages = {};\n\t};\n\n\t/*Public: Clear subscriptions by the topic\n\t*/\n\tPubSub.clearSubscriptions = function clearSubscriptions(topic){\n\t\tvar m; \n\t\tfor (m in messages){\n\t\t\tif (messages.hasOwnProperty(m) && m.indexOf(topic) === 0){\n\t\t\t\tdelete messages[m];\n\t\t\t}\n\t\t}\n\t};\n\n\t/* Public: removes subscriptions.\n\t * When passed a token, removes a specific subscription.\n\t * When passed a function, removes all subscriptions for that function\n\t * When passed a topic, removes all subscriptions for that topic (hierarchy)\n\t *\n\t * value - A token, function or topic to unsubscribe.\n\t *\n\t * Examples\n\t *\n\t *\t\t// Example 1 - unsubscribing with a token\n\t *\t\tvar token = PubSub.subscribe('mytopic', myFunc);\n\t *\t\tPubSub.unsubscribe(token);\n\t *\n\t *\t\t// Example 2 - unsubscribing with a function\n\t *\t\tPubSub.unsubscribe(myFunc);\n\t *\n\t *\t\t// Example 3 - unsubscribing a topic\n\t *\t\tPubSub.unsubscribe('mytopic');\n\t */\n\tPubSub.unsubscribe = function(value){\n\t\tvar isTopic    = typeof value === 'string' && messages.hasOwnProperty(value),\n\t\t\tisToken    = !isTopic && typeof value === 'string',\n\t\t\tisFunction = typeof value === 'function',\n\t\t\tresult = false,\n\t\t\tm, message, t;\n\n\t\tif (isTopic){\n\t\t\tdelete messages[value];\n\t\t\treturn;\n\t\t}\n\n\t\tfor ( m in messages ){\n\t\t\tif ( messages.hasOwnProperty( m ) ){\n\t\t\t\tmessage = messages[m];\n\n\t\t\t\tif ( isToken && message[value] ){\n\t\t\t\t\tdelete message[value];\n\t\t\t\t\tresult = value;\n\t\t\t\t\t// tokens are unique, so we can just stop here\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (isFunction) {\n\t\t\t\t\tfor ( t in message ){\n\t\t\t\t\t\tif (message.hasOwnProperty(t) && message[t] === value){\n\t\t\t\t\t\t\tdelete message[t];\n\t\t\t\t\t\t\tresult = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n}));\n","/*!\n * viewport-units-buggyfill v0.5.5\n * @web: https://github.com/rodneyrehm/viewport-units-buggyfill/\n * @author: Rodney Rehm - http://rodneyrehm.de/en/\n */\n\n(function (root, factory) {\n  'use strict';\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like enviroments that support module.exports,\n    // like Node.\n    module.exports = factory();\n  } else {\n    // Browser globals (root is window)\n    root.viewportUnitsBuggyfill = factory();\n  }\n}(this, function () {\n  'use strict';\n  /*global document, window, navigator, location, XMLHttpRequest, XDomainRequest*/\n\n  var initialized = false;\n  var options;\n  var userAgent = window.navigator.userAgent;\n  var viewportUnitExpression = /([+-]?[0-9.]+)(vh|vw|vmin|vmax)/g;\n  var forEach = [].forEach;\n  var dimensions;\n  var declarations;\n  var styleNode;\n  var isBuggyIE = /MSIE [0-9]\\./i.test(userAgent);\n  var isOldIE = /MSIE [0-8]\\./i.test(userAgent);\n  var isOperaMini = userAgent.indexOf('Opera Mini') > -1;\n\n  var isMobileSafari = /(iPhone|iPod|iPad).+AppleWebKit/i.test(userAgent) && (function() {\n    // Regexp for iOS-version tested against the following userAgent strings:\n    // Example WebView UserAgents:\n    // * iOS Chrome on iOS8: \"Mozilla/5.0 (iPad; CPU OS 8_1 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) CriOS/39.0.2171.50 Mobile/12B410 Safari/600.1.4\"\n    // * iOS Facebook on iOS7: \"Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Mobile/11D201 [FBAN/FBIOS;FBAV/12.1.0.24.20; FBBV/3214247; FBDV/iPhone6,1;FBMD/iPhone; FBSN/iPhone OS;FBSV/7.1.1; FBSS/2; FBCR/AT&T;FBID/phone;FBLC/en_US;FBOP/5]\"\n    // Example Safari UserAgents:\n    // * Safari iOS8: \"Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/600.1.3 (KHTML, like Gecko) Version/8.0 Mobile/12A4345d Safari/600.1.4\"\n    // * Safari iOS7: \"Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A4449d Safari/9537.53\"\n    var iOSversion = userAgent.match(/OS (\\d)/);\n    // viewport units work fine in mobile Safari and webView on iOS 8+\n    return iOSversion && iOSversion.length>1 && parseInt(iOSversion[1]) < 8;\n  })();\n\n  var isBadStockAndroid = (function() {\n    // Android stock browser test derived from\n    // http://stackoverflow.com/questions/24926221/distinguish-android-chrome-from-stock-browser-stock-browsers-user-agent-contai\n    var isAndroid = userAgent.indexOf(' Android ') > -1;\n    if (!isAndroid) {\n      return false;\n    }\n\n    var isStockAndroid = userAgent.indexOf('Version/') > -1;\n    if (!isStockAndroid) {\n      return false;\n    }\n\n    var versionNumber = parseFloat((userAgent.match('Android ([0-9.]+)') || [])[1]);\n    // anything below 4.4 uses WebKit without *any* viewport support,\n    // 4.4 has issues with viewport units within calc()\n    return versionNumber <= 4.4;\n  })();\n\n  // added check for IE11, since it *still* doesn't understand vmax!!!\n  if (!isBuggyIE) {\n    isBuggyIE = !!navigator.userAgent.match(/Trident.*rv[ :]*11\\./);\n  }\n\n  // Polyfill for creating CustomEvents on IE9/10/11\n  // from https://github.com/krambuhl/custom-event-polyfill\n  try {\n    new CustomEvent('test');\n  } catch(e) {\n    var CustomEvent = function(event, params) {\n      var evt;\n      params = params || {\n            bubbles: false,\n            cancelable: false,\n            detail: undefined\n          };\n\n      evt = document.createEvent('CustomEvent');\n      evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n      return evt;\n    };\n    CustomEvent.prototype = window.Event.prototype;\n    window.CustomEvent = CustomEvent; // expose definition to window\n  }\n\n  function debounce(func, wait) {\n    var timeout;\n    return function() {\n      var context = this;\n      var args = arguments;\n      var callback = function() {\n        func.apply(context, args);\n      };\n\n      clearTimeout(timeout);\n      timeout = setTimeout(callback, wait);\n    };\n  }\n\n  // from http://stackoverflow.com/questions/326069/how-to-identify-if-a-webpage-is-being-loaded-inside-an-iframe-or-directly-into-t\n  function inIframe() {\n    try {\n      return window.self !== window.top;\n    } catch (e) {\n      return true;\n    }\n  }\n\n  function initialize(initOptions) {\n    if (initialized) {\n      return;\n    }\n\n    if (initOptions === true) {\n      initOptions = {\n        force: true\n      };\n    }\n\n    options = initOptions || {};\n    options.isMobileSafari = isMobileSafari;\n    options.isBadStockAndroid = isBadStockAndroid;\n\n    if (isOldIE || (!options.force && !isMobileSafari && !isBuggyIE && !isBadStockAndroid && !isOperaMini && (!options.hacks || !options.hacks.required(options)))) {\n      // this buggyfill only applies to mobile safari, IE9-10 and the Stock Android Browser.\n      if (window.console && isOldIE) {\n        console.info('viewport-units-buggyfill requires a proper CSSOM and basic viewport unit support, which are not available in IE8 and below');\n      }\n\n      return {\n        init: function () {}\n      };\n    }\n\n    // fire a custom event that buggyfill was initialize\n    window.dispatchEvent(new CustomEvent('viewport-units-buggyfill-init'));\n\n    options.hacks && options.hacks.initialize(options);\n\n    initialized = true;\n    styleNode = document.createElement('style');\n    styleNode.id = 'patched-viewport';\n    document.head.appendChild(styleNode);\n\n    // Issue #6: Cross Origin Stylesheets are not accessible through CSSOM,\n    // therefore download and inject them as <style> to circumvent SOP.\n    importCrossOriginLinks(function() {\n      var _refresh = debounce(refresh, options.refreshDebounceWait || 100);\n      // doing a full refresh rather than updateStyles because an orientationchange\n      // could activate different stylesheets\n      window.addEventListener('orientationchange', _refresh, true);\n      // orientationchange might have happened while in a different window\n      window.addEventListener('pageshow', _refresh, true);\n\n      if (options.force || isBuggyIE || inIframe()) {\n        window.addEventListener('resize', _refresh, true);\n        options._listeningToResize = true;\n      }\n\n      options.hacks && options.hacks.initializeEvents(options, refresh, _refresh);\n\n      refresh();\n    });\n  }\n\n  function updateStyles() {\n    styleNode.textContent = getReplacedViewportUnits();\n    // move to the end in case inline <style>s were added dynamically\n    styleNode.parentNode.appendChild(styleNode);\n    // fire a custom event that styles were updated\n    window.dispatchEvent(new CustomEvent('viewport-units-buggyfill-style'));\n  }\n\n  function refresh() {\n    if (!initialized) {\n      return;\n    }\n\n    findProperties();\n\n    // iOS Safari will report window.innerWidth and .innerHeight as 0 unless a timeout is used here.\n    // TODO: figure out WHY innerWidth === 0\n    setTimeout(function() {\n      updateStyles();\n    }, 1);\n  }\n\n  function findProperties() {\n    declarations = [];\n    forEach.call(document.styleSheets, function(sheet) {\n      if (sheet.ownerNode.id === 'patched-viewport' || !sheet.cssRules || sheet.ownerNode.getAttribute('data-viewport-units-buggyfill') === 'ignore') {\n        // skip entire sheet because no rules are present, it's supposed to be ignored or it's the target-element of the buggyfill\n        return;\n      }\n\n      if (sheet.media && sheet.media.mediaText && window.matchMedia && !window.matchMedia(sheet.media.mediaText).matches) {\n        // skip entire sheet because media attribute doesn't match\n        return;\n      }\n\n      forEach.call(sheet.cssRules, findDeclarations);\n    });\n\n    return declarations;\n  }\n\n  function findDeclarations(rule) {\n    if (rule.type === 7) {\n      var value;\n\n      // there may be a case where accessing cssText throws an error.\n      // I could not reproduce this issue, but the worst that can happen\n      // this way is an animation not running properly.\n      // not awesome, but probably better than a script error\n      // see https://github.com/rodneyrehm/viewport-units-buggyfill/issues/21\n      try {\n        value = rule.cssText;\n      } catch(e) {\n        return;\n      }\n\n      viewportUnitExpression.lastIndex = 0;\n      if (viewportUnitExpression.test(value)) {\n        // KeyframesRule does not have a CSS-PropertyName\n        declarations.push([rule, null, value]);\n        options.hacks && options.hacks.findDeclarations(declarations, rule, null, value);\n      }\n\n      return;\n    }\n\n    if (!rule.style) {\n      if (!rule.cssRules) {\n        return;\n      }\n\n      forEach.call(rule.cssRules, function(_rule) {\n        findDeclarations(_rule);\n      });\n\n      return;\n    }\n\n    forEach.call(rule.style, function(name) {\n      var value = rule.style.getPropertyValue(name);\n      // preserve those !important rules\n      if (rule.style.getPropertyPriority(name)) {\n        value += ' !important';\n      }\n\n      viewportUnitExpression.lastIndex = 0;\n      if (viewportUnitExpression.test(value)) {\n        declarations.push([rule, name, value]);\n        options.hacks && options.hacks.findDeclarations(declarations, rule, name, value);\n      }\n    });\n  }\n\n  function getReplacedViewportUnits() {\n    dimensions = getViewport();\n\n    var css = [];\n    var buffer = [];\n    var open;\n    var close;\n\n    declarations.forEach(function(item) {\n      var _item = overwriteDeclaration.apply(null, item);\n      var _open = _item.selector.length ? (_item.selector.join(' {\\n') + ' {\\n') : '';\n      var _close = new Array(_item.selector.length + 1).join('\\n}');\n\n      if (!_open || _open !== open) {\n        if (buffer.length) {\n          css.push(open + buffer.join('\\n') + close);\n          buffer.length = 0;\n        }\n\n        if (_open) {\n          open = _open;\n          close = _close;\n          buffer.push(_item.content);\n        } else {\n          css.push(_item.content);\n          open = null;\n          close = null;\n        }\n\n        return;\n      }\n\n      if (_open && !open) {\n        open = _open;\n        close = _close;\n      }\n\n      buffer.push(_item.content);\n    });\n\n    if (buffer.length) {\n      css.push(open + buffer.join('\\n') + close);\n    }\n\n    // Opera Mini messes up on the content hack (it replaces the DOM node's innerHTML with the value).\n    // This fixes it. We test for Opera Mini only since it is the most expensive CSS selector\n    // see https://developer.mozilla.org/en-US/docs/Web/CSS/Universal_selectors\n    if (isOperaMini) {\n      css.push('* { content: normal !important; }');\n    }\n\n    return css.join('\\n\\n');\n  }\n\n  function overwriteDeclaration(rule, name, value) {\n    var _value;\n    var _selectors = [];\n\n    _value = value.replace(viewportUnitExpression, replaceValues);\n\n    if (options.hacks) {\n      _value = options.hacks.overwriteDeclaration(rule, name, _value);\n    }\n\n    if (name) {\n      // skipping KeyframesRule\n      _selectors.push(rule.selectorText);\n      _value = name + ': ' + _value + ';';\n    }\n\n    var _rule = rule.parentRule;\n    while (_rule) {\n      _selectors.unshift('@media ' + _rule.media.mediaText);\n      _rule = _rule.parentRule;\n    }\n\n    return {\n      selector: _selectors,\n      content: _value\n    };\n  }\n\n  function replaceValues(match, number, unit) {\n    var _base = dimensions[unit];\n    var _number = parseFloat(number) / 100;\n    return (_number * _base) + 'px';\n  }\n\n  function getViewport() {\n    var vh = window.innerHeight;\n    var vw = window.innerWidth;\n\n    return {\n      vh: vh,\n      vw: vw,\n      vmax: Math.max(vw, vh),\n      vmin: Math.min(vw, vh)\n    };\n  }\n\n  function importCrossOriginLinks(next) {\n    var _waiting = 0;\n    var decrease = function() {\n      _waiting--;\n      if (!_waiting) {\n        next();\n      }\n    };\n\n    forEach.call(document.styleSheets, function(sheet) {\n      if (!sheet.href || origin(sheet.href) === origin(location.href) || sheet.ownerNode.getAttribute('data-viewport-units-buggyfill') === 'ignore') {\n        // skip <style> and <link> from same origin or explicitly declared to ignore\n        return;\n      }\n\n      _waiting++;\n      convertLinkToStyle(sheet.ownerNode, decrease);\n    });\n\n    if (!_waiting) {\n      next();\n    }\n  }\n\n  function origin(url) {\n    return url.slice(0, url.indexOf('/', url.indexOf('://') + 3));\n  }\n\n  function convertLinkToStyle(link, next) {\n    getCors(link.href, function() {\n      var style = document.createElement('style');\n      style.media = link.media;\n      style.setAttribute('data-href', link.href);\n      style.textContent = this.responseText;\n      link.parentNode.replaceChild(style, link);\n      next();\n    }, next);\n  }\n\n  function getCors(url, success, error) {\n    var xhr = new XMLHttpRequest();\n    if ('withCredentials' in xhr) {\n      // XHR for Chrome/Firefox/Opera/Safari.\n      xhr.open('GET', url, true);\n    } else if (typeof XDomainRequest !== 'undefined') {\n      // XDomainRequest for IE.\n      xhr = new XDomainRequest();\n      xhr.open('GET', url);\n    } else {\n      throw new Error('cross-domain XHR not supported');\n    }\n\n    xhr.onload = success;\n    xhr.onerror = error;\n    xhr.send();\n    return xhr;\n  }\n\n  return {\n    version: '0.5.5',\n    findProperties: findProperties,\n    getCss: getReplacedViewportUnits,\n    init: initialize,\n    refresh: refresh\n  };\n\n}));\n"]}