{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","app.js","../../../node_modules/isarray/index.js","../../../node_modules/page/index.js","../../../node_modules/path-to-regexp/index.js","actions.js","component.js","polyfills.js","reducers.js","utils.js","video.js","contact.js","header.js","nav.js","pageSections.js","node_modules/browserify/node_modules/process/browser.js","node_modules/diffhtml/dist/diffhtml.js","node_modules/pubsub-js/src/pubsub.js","node_modules/redux/lib/applyMiddleware.js","node_modules/redux/lib/bindActionCreators.js","node_modules/redux/lib/combineReducers.js","node_modules/redux/lib/compose.js","node_modules/redux/lib/createStore.js","node_modules/redux/lib/index.js","node_modules/redux/lib/utils/isPlainObject.js","node_modules/redux/lib/utils/mapValues.js","node_modules/redux/lib/utils/pick.js","node_modules/redux/lib/utils/warning.js","node_modules/viewport-units-buggyfill/viewport-units-buggyfill.js"],"names":[],"mappings":"AAAA;;;;;ICAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAaZ;AACA;AACA;;AAEA,IAAM,WAAW,SAAS,gBAAT,CAA0B,uBAA1B,CAAX;AACN,IAAM,eAAe,4BAAa,QAAb,CAAf;;AAEN,gBAAI,QAAJ,EAAc,UAAC,OAAD,EAAa;;AAEzB,MAAM,SAAS,4BAAgB,QAAQ,aAAR,CAAsB,qBAAtB,CAAhB,CAAT,CAFmB;AAGzB,MAAM,SAAS,QAAQ,gBAAR,CAAyB,KAAzB,CAAT,CAHmB;;AAKzB,MAAG,MAAH,EAAW;AACT,YAAQ,MAAR,GAAiB,MAAjB,CADS;GAAX;CALY,CAAd;;AAWA,SAAS,aAAT,CAAuB,SAAvB,EAAkC,WAAlC,EAA+C;MAEvC,WAAgB,YAAhB,SAFuC;MAE7B,KAAM,YAAN,GAF6B;MAGvC,SAAmB,GAAnB,OAHuC;MAG/B,SAAW,GAAX,OAH+B;;AAK7C,MAAG,MAAH,EAAW;AACT,QAAG,QAAH,EAAa;AACX,UAAG,CAAC,OAAO,QAAP,EAAiB;AACnB,eAAO,IAAP,GADmB;OAArB;;AAIA,aAAO,IAAP,GALW;KAAb,MAOO;AACL,aAAO,KAAP,GADK;KAPP;GADF;CALF;;AAoBA,IAAM,SAAS,sBAAW,SAAS,cAAT,CAAwB,aAAxB,CAAX,CAAT;AACN,IAAM,MAAM,mBAAQ,SAAS,cAAT,CAAwB,YAAxB,CAAR,CAAN;;AAEN,OAAO,SAAP,CAAkB,oBAAlB,EAAyC,aAAzC;AACA,OAAO,SAAP,CAAkB,oBAAlB,EAAyC,aAAzC;AACA,OAAO,SAAP,CAAkB,kBAAlB,EAAuC,YAAK;AAC1C,MAAI,IAAJ,GAD0C;CAAL,CAAvC;;AAIA,oBAAK,UAAL,EAAiB,YAAM;AACrB,MAAM,aAAa,KAAK,UAAL,CAAgB,MAAhB,GAAyB,KAAK,UAAL,GAAkB,CAAC,CAAD,CAA3C,CADE;AAErB,MAAM,cAAc,uBAAgB,SAAS,cAAT,CAAwB,cAAxB,CAAhB,EAAyD;AAC3E,YAAQ,UAAR;GADkB,CAAd,CAFe;;AAMrB,cAAY,MAAZ,GANqB;CAAN,CAAjB;;AASA,oBAAK;AACH,SAAO,KAAP;AACA,YAAU,KAAV;CAFF;;;;;ACrEA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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iBAAa,GAAb,CAAiB;aAAQ,KAAK,MAAL;KAAR,CAAjB,CAD6C;GAAP,CAApC,CAR2C;;AAY/C,SAAO,YAAP,CAZ+C;CAAlC;;;ACnIf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC51FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import * as PubSub from 'pubsub-js'\nimport page from 'page'\n\nimport { map, reduce } from './modules/utils'\nimport { classList, dataset, vu } from './modules/polyfills'\n\nimport { videoController } from './modules/video'\nimport pageSections from './views/pageSections'\nimport headerView from './views/header'\nimport navView from './views/nav'\nimport contactFormView from './views/contact'\n\n// Polyfills\nclassList()\ndataset()\nvu()\n\nconst sections = document.querySelectorAll('[data-scroll-section]')\nconst sectionViews = pageSections(sections);\n\nmap(sections, (section) => {\n\n  const player = videoController(section.querySelector('[data-video-player]'))\n  const images = section.querySelectorAll('img')\n\n  if(player) {\n    section.player = player\n  }\n\n})\n\nfunction handleSection(eventName, sectionView) {\n\n  let { isInView, el} = sectionView\n  let { images, player } = el\n\n  if(player) {\n    if(isInView) {\n      if(!player.isLoaded) {\n        player.load()\n      }\n\n      player.play()\n\n    } else {\n      player.pause()\n    }\n  }\n\n}\n\nconst header = headerView(document.getElementById('site-header'))\nconst nav = navView(document.getElementById('navigation'))\n\nPubSub.subscribe(('section-view:enter'), handleSection)\nPubSub.subscribe(('section-view:leave'), handleSection)\nPubSub.subscribe(('header-view:open'), ()=> {\n  nav.init()\n})\n\npage('/contact', () => {\n  const formFields = data.formFields.length ? data.formFields : [0]\n  const contactForm = contactFormView(document.getElementById('contact-form'), {\n    fields: formFields\n  })\n\n  contactForm.render()\n})\n\npage({\n  click: false,\n  popstate: false\n})\n\n// page.show(location.pathname)\n\n","module.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n","(function (process){\n  /* globals require, module */\n\n  'use strict';\n\n  /**\n   * Module dependencies.\n   */\n\n  var pathtoRegexp = require('path-to-regexp');\n\n  /**\n   * Module exports.\n   */\n\n  module.exports = page;\n\n  /**\n   * Detect click event\n   */\n  var clickEvent = ('undefined' !== typeof document) && document.ontouchstart ? 'touchstart' : 'click';\n\n  /**\n   * To work properly with the URL\n   * history.location generated polyfill in https://github.com/devote/HTML5-History-API\n   */\n\n  var location = ('undefined' !== typeof window) && (window.history.location || window.location);\n\n  /**\n   * Perform initial dispatch.\n   */\n\n  var dispatch = true;\n\n\n  /**\n   * Decode URL components (query string, pathname, hash).\n   * Accommodates both regular percent encoding and x-www-form-urlencoded format.\n   */\n  var decodeURLComponents = true;\n\n  /**\n   * Base path.\n   */\n\n  var base = '';\n\n  /**\n   * Running flag.\n   */\n\n  var running;\n\n  /**\n   * HashBang option\n   */\n\n  var hashbang = false;\n\n  /**\n   * Previous context, for capturing\n   * page exit events.\n   */\n\n  var prevContext;\n\n  /**\n   * Register `path` with callback `fn()`,\n   * or route `path`, or redirection,\n   * or `page.start()`.\n   *\n   *   page(fn);\n   *   page('*', fn);\n   *   page('/user/:id', load, user);\n   *   page('/user/' + user.id, { some: 'thing' });\n   *   page('/user/' + user.id);\n   *   page('/from', '/to')\n   *   page();\n   *\n   * @param {string|!Function|!Object} path\n   * @param {Function=} fn\n   * @api public\n   */\n\n  function page(path, fn) {\n    // <callback>\n    if ('function' === typeof path) {\n      return page('*', path);\n    }\n\n    // route <path> to <callback ...>\n    if ('function' === typeof fn) {\n      var route = new Route(/** @type {string} */ (path));\n      for (var i = 1; i < arguments.length; ++i) {\n        page.callbacks.push(route.middleware(arguments[i]));\n      }\n      // show <path> with [state]\n    } else if ('string' === typeof path) {\n      page['string' === typeof fn ? 'redirect' : 'show'](path, fn);\n      // start [options]\n    } else {\n      page.start(path);\n    }\n  }\n\n  /**\n   * Callback functions.\n   */\n\n  page.callbacks = [];\n  page.exits = [];\n\n  /**\n   * Current path being processed\n   * @type {string}\n   */\n  page.current = '';\n\n  /**\n   * Number of pages navigated to.\n   * @type {number}\n   *\n   *     page.len == 0;\n   *     page('/login');\n   *     page.len == 1;\n   */\n\n  page.len = 0;\n\n  /**\n   * Get or set basepath to `path`.\n   *\n   * @param {string} path\n   * @api public\n   */\n\n  page.base = function(path) {\n    if (0 === arguments.length) return base;\n    base = path;\n  };\n\n  /**\n   * Bind with the given `options`.\n   *\n   * Options:\n   *\n   *    - `click` bind to click events [true]\n   *    - `popstate` bind to popstate [true]\n   *    - `dispatch` perform initial dispatch [true]\n   *\n   * @param {Object} options\n   * @api public\n   */\n\n  page.start = function(options) {\n    options = options || {};\n    if (running) return;\n    running = true;\n    if (false === options.dispatch) dispatch = false;\n    if (false === options.decodeURLComponents) decodeURLComponents = false;\n    if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);\n    if (false !== options.click) {\n      document.addEventListener(clickEvent, onclick, false);\n    }\n    if (true === options.hashbang) hashbang = true;\n    if (!dispatch) return;\n    var url = (hashbang && ~location.hash.indexOf('#!')) ? location.hash.substr(2) + location.search : location.pathname + location.search + location.hash;\n    page.replace(url, null, true, dispatch);\n  };\n\n  /**\n   * Unbind click and popstate event handlers.\n   *\n   * @api public\n   */\n\n  page.stop = function() {\n    if (!running) return;\n    page.current = '';\n    page.len = 0;\n    running = false;\n    document.removeEventListener(clickEvent, onclick, false);\n    window.removeEventListener('popstate', onpopstate, false);\n  };\n\n  /**\n   * Show `path` with optional `state` object.\n   *\n   * @param {string} path\n   * @param {Object=} state\n   * @param {boolean=} dispatch\n   * @param {boolean=} push\n   * @return {!Context}\n   * @api public\n   */\n\n  page.show = function(path, state, dispatch, push) {\n    var ctx = new Context(path, state);\n    page.current = ctx.path;\n    if (false !== dispatch) page.dispatch(ctx);\n    if (false !== ctx.handled && false !== push) ctx.pushState();\n    return ctx;\n  };\n\n  /**\n   * Goes back in the history\n   * Back should always let the current route push state and then go back.\n   *\n   * @param {string} path - fallback path to go back if no more history exists, if undefined defaults to page.base\n   * @param {Object=} state\n   * @api public\n   */\n\n  page.back = function(path, state) {\n    if (page.len > 0) {\n      // this may need more testing to see if all browsers\n      // wait for the next tick to go back in history\n      history.back();\n      page.len--;\n    } else if (path) {\n      setTimeout(function() {\n        page.show(path, state);\n      });\n    }else{\n      setTimeout(function() {\n        page.show(base, state);\n      });\n    }\n  };\n\n\n  /**\n   * Register route to redirect from one path to other\n   * or just redirect to another route\n   *\n   * @param {string} from - if param 'to' is undefined redirects to 'from'\n   * @param {string=} to\n   * @api public\n   */\n  page.redirect = function(from, to) {\n    // Define route from a path to another\n    if ('string' === typeof from && 'string' === typeof to) {\n      page(from, function(e) {\n        setTimeout(function() {\n          page.replace(/** @type {!string} */ (to));\n        }, 0);\n      });\n    }\n\n    // Wait for the push state and replace it with another\n    if ('string' === typeof from && 'undefined' === typeof to) {\n      setTimeout(function() {\n        page.replace(from);\n      }, 0);\n    }\n  };\n\n  /**\n   * Replace `path` with optional `state` object.\n   *\n   * @param {string} path\n   * @param {Object=} state\n   * @param {boolean=} init\n   * @param {boolean=} dispatch\n   * @return {!Context}\n   * @api public\n   */\n\n\n  page.replace = function(path, state, init, dispatch) {\n    var ctx = new Context(path, state);\n    page.current = ctx.path;\n    ctx.init = init;\n    ctx.save(); // save before dispatching, which may redirect\n    if (false !== dispatch) page.dispatch(ctx);\n    return ctx;\n  };\n\n  /**\n   * Dispatch the given `ctx`.\n   *\n   * @param {Context} ctx\n   * @api private\n   */\n  page.dispatch = function(ctx) {\n    var prev = prevContext,\n      i = 0,\n      j = 0;\n\n    prevContext = ctx;\n\n    function nextExit() {\n      var fn = page.exits[j++];\n      if (!fn) return nextEnter();\n      fn(prev, nextExit);\n    }\n\n    function nextEnter() {\n      var fn = page.callbacks[i++];\n\n      if (ctx.path !== page.current) {\n        ctx.handled = false;\n        return;\n      }\n      if (!fn) return unhandled(ctx);\n      fn(ctx, nextEnter);\n    }\n\n    if (prev) {\n      nextExit();\n    } else {\n      nextEnter();\n    }\n  };\n\n  /**\n   * Unhandled `ctx`. When it's not the initial\n   * popstate then redirect. If you wish to handle\n   * 404s on your own use `page('*', callback)`.\n   *\n   * @param {Context} ctx\n   * @api private\n   */\n  function unhandled(ctx) {\n    if (ctx.handled) return;\n    var current;\n\n    if (hashbang) {\n      current = base + location.hash.replace('#!', '');\n    } else {\n      current = location.pathname + location.search;\n    }\n\n    if (current === ctx.canonicalPath) return;\n    page.stop();\n    ctx.handled = false;\n    location.href = ctx.canonicalPath;\n  }\n\n  /**\n   * Register an exit route on `path` with\n   * callback `fn()`, which will be called\n   * on the previous context when a new\n   * page is visited.\n   */\n  page.exit = function(path, fn) {\n    if (typeof path === 'function') {\n      return page.exit('*', path);\n    }\n\n    var route = new Route(path);\n    for (var i = 1; i < arguments.length; ++i) {\n      page.exits.push(route.middleware(arguments[i]));\n    }\n  };\n\n  /**\n   * Remove URL encoding from the given `str`.\n   * Accommodates whitespace in both x-www-form-urlencoded\n   * and regular percent-encoded form.\n   *\n   * @param {string} val - URL component to decode\n   */\n  function decodeURLEncodedURIComponent(val) {\n    if (typeof val !== 'string') { return val; }\n    return decodeURLComponents ? decodeURIComponent(val.replace(/\\+/g, ' ')) : val;\n  }\n\n  /**\n   * Initialize a new \"request\" `Context`\n   * with the given `path` and optional initial `state`.\n   *\n   * @constructor\n   * @param {string} path\n   * @param {Object=} state\n   * @api public\n   */\n\n  function Context(path, state) {\n    if ('/' === path[0] && 0 !== path.indexOf(base)) path = base + (hashbang ? '#!' : '') + path;\n    var i = path.indexOf('?');\n\n    this.canonicalPath = path;\n    this.path = path.replace(base, '') || '/';\n    if (hashbang) this.path = this.path.replace('#!', '') || '/';\n\n    this.title = document.title;\n    this.state = state || {};\n    this.state.path = path;\n    this.querystring = ~i ? decodeURLEncodedURIComponent(path.slice(i + 1)) : '';\n    this.pathname = decodeURLEncodedURIComponent(~i ? path.slice(0, i) : path);\n    this.params = {};\n\n    // fragment\n    this.hash = '';\n    if (!hashbang) {\n      if (!~this.path.indexOf('#')) return;\n      var parts = this.path.split('#');\n      this.path = parts[0];\n      this.hash = decodeURLEncodedURIComponent(parts[1]) || '';\n      this.querystring = this.querystring.split('#')[0];\n    }\n  }\n\n  /**\n   * Expose `Context`.\n   */\n\n  page.Context = Context;\n\n  /**\n   * Push state.\n   *\n   * @api private\n   */\n\n  Context.prototype.pushState = function() {\n    page.len++;\n    history.pushState(this.state, this.title, hashbang && this.path !== '/' ? '#!' + this.path : this.canonicalPath);\n  };\n\n  /**\n   * Save the context state.\n   *\n   * @api public\n   */\n\n  Context.prototype.save = function() {\n    history.replaceState(this.state, this.title, hashbang && this.path !== '/' ? '#!' + this.path : this.canonicalPath);\n  };\n\n  /**\n   * Initialize `Route` with the given HTTP `path`,\n   * and an array of `callbacks` and `options`.\n   *\n   * Options:\n   *\n   *   - `sensitive`    enable case-sensitive routes\n   *   - `strict`       enable strict matching for trailing slashes\n   *\n   * @constructor\n   * @param {string} path\n   * @param {Object=} options\n   * @api private\n   */\n\n  function Route(path, options) {\n    options = options || {};\n    this.path = (path === '*') ? '(.*)' : path;\n    this.method = 'GET';\n    this.regexp = pathtoRegexp(this.path,\n      this.keys = [],\n      options);\n  }\n\n  /**\n   * Expose `Route`.\n   */\n\n  page.Route = Route;\n\n  /**\n   * Return route middleware with\n   * the given callback `fn()`.\n   *\n   * @param {Function} fn\n   * @return {Function}\n   * @api public\n   */\n\n  Route.prototype.middleware = function(fn) {\n    var self = this;\n    return function(ctx, next) {\n      if (self.match(ctx.path, ctx.params)) return fn(ctx, next);\n      next();\n    };\n  };\n\n  /**\n   * Check if this route matches `path`, if so\n   * populate `params`.\n   *\n   * @param {string} path\n   * @param {Object} params\n   * @return {boolean}\n   * @api private\n   */\n\n  Route.prototype.match = function(path, params) {\n    var keys = this.keys,\n      qsIndex = path.indexOf('?'),\n      pathname = ~qsIndex ? path.slice(0, qsIndex) : path,\n      m = this.regexp.exec(decodeURIComponent(pathname));\n\n    if (!m) return false;\n\n    for (var i = 1, len = m.length; i < len; ++i) {\n      var key = keys[i - 1];\n      var val = decodeURLEncodedURIComponent(m[i]);\n      if (val !== undefined || !(hasOwnProperty.call(params, key.name))) {\n        params[key.name] = val;\n      }\n    }\n\n    return true;\n  };\n\n\n  /**\n   * Handle \"populate\" events.\n   */\n\n  var onpopstate = (function () {\n    var loaded = false;\n    if ('undefined' === typeof window) {\n      return;\n    }\n    if (document.readyState === 'complete') {\n      loaded = true;\n    } else {\n      window.addEventListener('load', function() {\n        setTimeout(function() {\n          loaded = true;\n        }, 0);\n      });\n    }\n    return function onpopstate(e) {\n      if (!loaded) return;\n      if (e.state) {\n        var path = e.state.path;\n        page.replace(path, e.state);\n      } else {\n        page.show(location.pathname + location.hash, undefined, undefined, false);\n      }\n    };\n  })();\n  /**\n   * Handle \"click\" events.\n   */\n\n  function onclick(e) {\n\n    if (1 !== which(e)) return;\n\n    if (e.metaKey || e.ctrlKey || e.shiftKey) return;\n    if (e.defaultPrevented) return;\n\n\n\n    // ensure link\n    // use shadow dom when available\n    var el = e.path ? e.path[0] : e.target;\n    while (el && 'A' !== el.nodeName) el = el.parentNode;\n    if (!el || 'A' !== el.nodeName) return;\n\n\n\n    // Ignore if tag has\n    // 1. \"download\" attribute\n    // 2. rel=\"external\" attribute\n    if (el.hasAttribute('download') || el.getAttribute('rel') === 'external') return;\n\n    // ensure non-hash for the same path\n    var link = el.getAttribute('href');\n    if (!hashbang && el.pathname === location.pathname && (el.hash || '#' === link)) return;\n\n\n\n    // Check for mailto: in the href\n    if (link && link.indexOf('mailto:') > -1) return;\n\n    // check target\n    if (el.target) return;\n\n    // x-origin\n    if (!sameOrigin(el.href)) return;\n\n\n\n    // rebuild path\n    var path = el.pathname + el.search + (el.hash || '');\n\n    // strip leading \"/[drive letter]:\" on NW.js on Windows\n    if (typeof process !== 'undefined' && path.match(/^\\/[a-zA-Z]:\\//)) {\n      path = path.replace(/^\\/[a-zA-Z]:\\//, '/');\n    }\n\n    // same page\n    var orig = path;\n\n    if (path.indexOf(base) === 0) {\n      path = path.substr(base.length);\n    }\n\n    if (hashbang) path = path.replace('#!', '');\n\n    if (base && orig === path) return;\n\n    e.preventDefault();\n    page.show(orig);\n  }\n\n  /**\n   * Event button.\n   */\n\n  function which(e) {\n    e = e || window.event;\n    return null === e.which ? e.button : e.which;\n  }\n\n  /**\n   * Check if `href` is the same origin.\n   */\n\n  function sameOrigin(href) {\n    var origin = location.protocol + '//' + location.hostname;\n    if (location.port) origin += ':' + location.port;\n    return (href && (0 === href.indexOf(origin)));\n  }\n\n  page.sameOrigin = sameOrigin;\n\n}).call(this,require('_process'))\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9wYWdlL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIgIC8qIGdsb2JhbHMgcmVxdWlyZSwgbW9kdWxlICovXG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuICAgKi9cblxuICB2YXIgcGF0aHRvUmVnZXhwID0gcmVxdWlyZSgncGF0aC10by1yZWdleHAnKTtcblxuICAvKipcbiAgICogTW9kdWxlIGV4cG9ydHMuXG4gICAqL1xuXG4gIG1vZHVsZS5leHBvcnRzID0gcGFnZTtcblxuICAvKipcbiAgICogRGV0ZWN0IGNsaWNrIGV2ZW50XG4gICAqL1xuICB2YXIgY2xpY2tFdmVudCA9ICgndW5kZWZpbmVkJyAhPT0gdHlwZW9mIGRvY3VtZW50KSAmJiBkb2N1bWVudC5vbnRvdWNoc3RhcnQgPyAndG91Y2hzdGFydCcgOiAnY2xpY2snO1xuXG4gIC8qKlxuICAgKiBUbyB3b3JrIHByb3Blcmx5IHdpdGggdGhlIFVSTFxuICAgKiBoaXN0b3J5LmxvY2F0aW9uIGdlbmVyYXRlZCBwb2x5ZmlsbCBpbiBodHRwczovL2dpdGh1Yi5jb20vZGV2b3RlL0hUTUw1LUhpc3RvcnktQVBJXG4gICAqL1xuXG4gIHZhciBsb2NhdGlvbiA9ICgndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdpbmRvdykgJiYgKHdpbmRvdy5oaXN0b3J5LmxvY2F0aW9uIHx8IHdpbmRvdy5sb2NhdGlvbik7XG5cbiAgLyoqXG4gICAqIFBlcmZvcm0gaW5pdGlhbCBkaXNwYXRjaC5cbiAgICovXG5cbiAgdmFyIGRpc3BhdGNoID0gdHJ1ZTtcblxuXG4gIC8qKlxuICAgKiBEZWNvZGUgVVJMIGNvbXBvbmVudHMgKHF1ZXJ5IHN0cmluZywgcGF0aG5hbWUsIGhhc2gpLlxuICAgKiBBY2NvbW1vZGF0ZXMgYm90aCByZWd1bGFyIHBlcmNlbnQgZW5jb2RpbmcgYW5kIHgtd3d3LWZvcm0tdXJsZW5jb2RlZCBmb3JtYXQuXG4gICAqL1xuICB2YXIgZGVjb2RlVVJMQ29tcG9uZW50cyA9IHRydWU7XG5cbiAgLyoqXG4gICAqIEJhc2UgcGF0aC5cbiAgICovXG5cbiAgdmFyIGJhc2UgPSAnJztcblxuICAvKipcbiAgICogUnVubmluZyBmbGFnLlxuICAgKi9cblxuICB2YXIgcnVubmluZztcblxuICAvKipcbiAgICogSGFzaEJhbmcgb3B0aW9uXG4gICAqL1xuXG4gIHZhciBoYXNoYmFuZyA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBQcmV2aW91cyBjb250ZXh0LCBmb3IgY2FwdHVyaW5nXG4gICAqIHBhZ2UgZXhpdCBldmVudHMuXG4gICAqL1xuXG4gIHZhciBwcmV2Q29udGV4dDtcblxuICAvKipcbiAgICogUmVnaXN0ZXIgYHBhdGhgIHdpdGggY2FsbGJhY2sgYGZuKClgLFxuICAgKiBvciByb3V0ZSBgcGF0aGAsIG9yIHJlZGlyZWN0aW9uLFxuICAgKiBvciBgcGFnZS5zdGFydCgpYC5cbiAgICpcbiAgICogICBwYWdlKGZuKTtcbiAgICogICBwYWdlKCcqJywgZm4pO1xuICAgKiAgIHBhZ2UoJy91c2VyLzppZCcsIGxvYWQsIHVzZXIpO1xuICAgKiAgIHBhZ2UoJy91c2VyLycgKyB1c2VyLmlkLCB7IHNvbWU6ICd0aGluZycgfSk7XG4gICAqICAgcGFnZSgnL3VzZXIvJyArIHVzZXIuaWQpO1xuICAgKiAgIHBhZ2UoJy9mcm9tJywgJy90bycpXG4gICAqICAgcGFnZSgpO1xuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ3whRnVuY3Rpb258IU9iamVjdH0gcGF0aFxuICAgKiBAcGFyYW0ge0Z1bmN0aW9uPX0gZm5cbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgZnVuY3Rpb24gcGFnZShwYXRoLCBmbikge1xuICAgIC8vIDxjYWxsYmFjaz5cbiAgICBpZiAoJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIHBhdGgpIHtcbiAgICAgIHJldHVybiBwYWdlKCcqJywgcGF0aCk7XG4gICAgfVxuXG4gICAgLy8gcm91dGUgPHBhdGg+IHRvIDxjYWxsYmFjayAuLi4+XG4gICAgaWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBmbikge1xuICAgICAgdmFyIHJvdXRlID0gbmV3IFJvdXRlKC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAocGF0aCkpO1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgcGFnZS5jYWxsYmFja3MucHVzaChyb3V0ZS5taWRkbGV3YXJlKGFyZ3VtZW50c1tpXSkpO1xuICAgICAgfVxuICAgICAgLy8gc2hvdyA8cGF0aD4gd2l0aCBbc3RhdGVdXG4gICAgfSBlbHNlIGlmICgnc3RyaW5nJyA9PT0gdHlwZW9mIHBhdGgpIHtcbiAgICAgIHBhZ2VbJ3N0cmluZycgPT09IHR5cGVvZiBmbiA/ICdyZWRpcmVjdCcgOiAnc2hvdyddKHBhdGgsIGZuKTtcbiAgICAgIC8vIHN0YXJ0IFtvcHRpb25zXVxuICAgIH0gZWxzZSB7XG4gICAgICBwYWdlLnN0YXJ0KHBhdGgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmdW5jdGlvbnMuXG4gICAqL1xuXG4gIHBhZ2UuY2FsbGJhY2tzID0gW107XG4gIHBhZ2UuZXhpdHMgPSBbXTtcblxuICAvKipcbiAgICogQ3VycmVudCBwYXRoIGJlaW5nIHByb2Nlc3NlZFxuICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgKi9cbiAgcGFnZS5jdXJyZW50ID0gJyc7XG5cbiAgLyoqXG4gICAqIE51bWJlciBvZiBwYWdlcyBuYXZpZ2F0ZWQgdG8uXG4gICAqIEB0eXBlIHtudW1iZXJ9XG4gICAqXG4gICAqICAgICBwYWdlLmxlbiA9PSAwO1xuICAgKiAgICAgcGFnZSgnL2xvZ2luJyk7XG4gICAqICAgICBwYWdlLmxlbiA9PSAxO1xuICAgKi9cblxuICBwYWdlLmxlbiA9IDA7XG5cbiAgLyoqXG4gICAqIEdldCBvciBzZXQgYmFzZXBhdGggdG8gYHBhdGhgLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBwYWdlLmJhc2UgPSBmdW5jdGlvbihwYXRoKSB7XG4gICAgaWYgKDAgPT09IGFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBiYXNlO1xuICAgIGJhc2UgPSBwYXRoO1xuICB9O1xuXG4gIC8qKlxuICAgKiBCaW5kIHdpdGggdGhlIGdpdmVuIGBvcHRpb25zYC5cbiAgICpcbiAgICogT3B0aW9uczpcbiAgICpcbiAgICogICAgLSBgY2xpY2tgIGJpbmQgdG8gY2xpY2sgZXZlbnRzIFt0cnVlXVxuICAgKiAgICAtIGBwb3BzdGF0ZWAgYmluZCB0byBwb3BzdGF0ZSBbdHJ1ZV1cbiAgICogICAgLSBgZGlzcGF0Y2hgIHBlcmZvcm0gaW5pdGlhbCBkaXNwYXRjaCBbdHJ1ZV1cbiAgICpcbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgcGFnZS5zdGFydCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBpZiAocnVubmluZykgcmV0dXJuO1xuICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgIGlmIChmYWxzZSA9PT0gb3B0aW9ucy5kaXNwYXRjaCkgZGlzcGF0Y2ggPSBmYWxzZTtcbiAgICBpZiAoZmFsc2UgPT09IG9wdGlvbnMuZGVjb2RlVVJMQ29tcG9uZW50cykgZGVjb2RlVVJMQ29tcG9uZW50cyA9IGZhbHNlO1xuICAgIGlmIChmYWxzZSAhPT0gb3B0aW9ucy5wb3BzdGF0ZSkgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BvcHN0YXRlJywgb25wb3BzdGF0ZSwgZmFsc2UpO1xuICAgIGlmIChmYWxzZSAhPT0gb3B0aW9ucy5jbGljaykge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihjbGlja0V2ZW50LCBvbmNsaWNrLCBmYWxzZSk7XG4gICAgfVxuICAgIGlmICh0cnVlID09PSBvcHRpb25zLmhhc2hiYW5nKSBoYXNoYmFuZyA9IHRydWU7XG4gICAgaWYgKCFkaXNwYXRjaCkgcmV0dXJuO1xuICAgIHZhciB1cmwgPSAoaGFzaGJhbmcgJiYgfmxvY2F0aW9uLmhhc2guaW5kZXhPZignIyEnKSkgPyBsb2NhdGlvbi5oYXNoLnN1YnN0cigyKSArIGxvY2F0aW9uLnNlYXJjaCA6IGxvY2F0aW9uLnBhdGhuYW1lICsgbG9jYXRpb24uc2VhcmNoICsgbG9jYXRpb24uaGFzaDtcbiAgICBwYWdlLnJlcGxhY2UodXJsLCBudWxsLCB0cnVlLCBkaXNwYXRjaCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVuYmluZCBjbGljayBhbmQgcG9wc3RhdGUgZXZlbnQgaGFuZGxlcnMuXG4gICAqXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIHBhZ2Uuc3RvcCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghcnVubmluZykgcmV0dXJuO1xuICAgIHBhZ2UuY3VycmVudCA9ICcnO1xuICAgIHBhZ2UubGVuID0gMDtcbiAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihjbGlja0V2ZW50LCBvbmNsaWNrLCBmYWxzZSk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvcHN0YXRlJywgb25wb3BzdGF0ZSwgZmFsc2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTaG93IGBwYXRoYCB3aXRoIG9wdGlvbmFsIGBzdGF0ZWAgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxuICAgKiBAcGFyYW0ge09iamVjdD19IHN0YXRlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IGRpc3BhdGNoXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IHB1c2hcbiAgICogQHJldHVybiB7IUNvbnRleHR9XG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIHBhZ2Uuc2hvdyA9IGZ1bmN0aW9uKHBhdGgsIHN0YXRlLCBkaXNwYXRjaCwgcHVzaCkge1xuICAgIHZhciBjdHggPSBuZXcgQ29udGV4dChwYXRoLCBzdGF0ZSk7XG4gICAgcGFnZS5jdXJyZW50ID0gY3R4LnBhdGg7XG4gICAgaWYgKGZhbHNlICE9PSBkaXNwYXRjaCkgcGFnZS5kaXNwYXRjaChjdHgpO1xuICAgIGlmIChmYWxzZSAhPT0gY3R4LmhhbmRsZWQgJiYgZmFsc2UgIT09IHB1c2gpIGN0eC5wdXNoU3RhdGUoKTtcbiAgICByZXR1cm4gY3R4O1xuICB9O1xuXG4gIC8qKlxuICAgKiBHb2VzIGJhY2sgaW4gdGhlIGhpc3RvcnlcbiAgICogQmFjayBzaG91bGQgYWx3YXlzIGxldCB0aGUgY3VycmVudCByb3V0ZSBwdXNoIHN0YXRlIGFuZCB0aGVuIGdvIGJhY2suXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIC0gZmFsbGJhY2sgcGF0aCB0byBnbyBiYWNrIGlmIG5vIG1vcmUgaGlzdG9yeSBleGlzdHMsIGlmIHVuZGVmaW5lZCBkZWZhdWx0cyB0byBwYWdlLmJhc2VcbiAgICogQHBhcmFtIHtPYmplY3Q9fSBzdGF0ZVxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBwYWdlLmJhY2sgPSBmdW5jdGlvbihwYXRoLCBzdGF0ZSkge1xuICAgIGlmIChwYWdlLmxlbiA+IDApIHtcbiAgICAgIC8vIHRoaXMgbWF5IG5lZWQgbW9yZSB0ZXN0aW5nIHRvIHNlZSBpZiBhbGwgYnJvd3NlcnNcbiAgICAgIC8vIHdhaXQgZm9yIHRoZSBuZXh0IHRpY2sgdG8gZ28gYmFjayBpbiBoaXN0b3J5XG4gICAgICBoaXN0b3J5LmJhY2soKTtcbiAgICAgIHBhZ2UubGVuLS07XG4gICAgfSBlbHNlIGlmIChwYXRoKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBwYWdlLnNob3cocGF0aCwgc3RhdGUpO1xuICAgICAgfSk7XG4gICAgfWVsc2V7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBwYWdlLnNob3coYmFzZSwgc3RhdGUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIHJvdXRlIHRvIHJlZGlyZWN0IGZyb20gb25lIHBhdGggdG8gb3RoZXJcbiAgICogb3IganVzdCByZWRpcmVjdCB0byBhbm90aGVyIHJvdXRlXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmcm9tIC0gaWYgcGFyYW0gJ3RvJyBpcyB1bmRlZmluZWQgcmVkaXJlY3RzIHRvICdmcm9tJ1xuICAgKiBAcGFyYW0ge3N0cmluZz19IHRvXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuICBwYWdlLnJlZGlyZWN0ID0gZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgICAvLyBEZWZpbmUgcm91dGUgZnJvbSBhIHBhdGggdG8gYW5vdGhlclxuICAgIGlmICgnc3RyaW5nJyA9PT0gdHlwZW9mIGZyb20gJiYgJ3N0cmluZycgPT09IHR5cGVvZiB0bykge1xuICAgICAgcGFnZShmcm9tLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcGFnZS5yZXBsYWNlKC8qKiBAdHlwZSB7IXN0cmluZ30gKi8gKHRvKSk7XG4gICAgICAgIH0sIDApO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2FpdCBmb3IgdGhlIHB1c2ggc3RhdGUgYW5kIHJlcGxhY2UgaXQgd2l0aCBhbm90aGVyXG4gICAgaWYgKCdzdHJpbmcnID09PSB0eXBlb2YgZnJvbSAmJiAndW5kZWZpbmVkJyA9PT0gdHlwZW9mIHRvKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBwYWdlLnJlcGxhY2UoZnJvbSk7XG4gICAgICB9LCAwKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlcGxhY2UgYHBhdGhgIHdpdGggb3B0aW9uYWwgYHN0YXRlYCBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXG4gICAqIEBwYXJhbSB7T2JqZWN0PX0gc3RhdGVcbiAgICogQHBhcmFtIHtib29sZWFuPX0gaW5pdFxuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBkaXNwYXRjaFxuICAgKiBAcmV0dXJuIHshQ29udGV4dH1cbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cblxuICBwYWdlLnJlcGxhY2UgPSBmdW5jdGlvbihwYXRoLCBzdGF0ZSwgaW5pdCwgZGlzcGF0Y2gpIHtcbiAgICB2YXIgY3R4ID0gbmV3IENvbnRleHQocGF0aCwgc3RhdGUpO1xuICAgIHBhZ2UuY3VycmVudCA9IGN0eC5wYXRoO1xuICAgIGN0eC5pbml0ID0gaW5pdDtcbiAgICBjdHguc2F2ZSgpOyAvLyBzYXZlIGJlZm9yZSBkaXNwYXRjaGluZywgd2hpY2ggbWF5IHJlZGlyZWN0XG4gICAgaWYgKGZhbHNlICE9PSBkaXNwYXRjaCkgcGFnZS5kaXNwYXRjaChjdHgpO1xuICAgIHJldHVybiBjdHg7XG4gIH07XG5cbiAgLyoqXG4gICAqIERpc3BhdGNoIHRoZSBnaXZlbiBgY3R4YC5cbiAgICpcbiAgICogQHBhcmFtIHtDb250ZXh0fSBjdHhcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuICBwYWdlLmRpc3BhdGNoID0gZnVuY3Rpb24oY3R4KSB7XG4gICAgdmFyIHByZXYgPSBwcmV2Q29udGV4dCxcbiAgICAgIGkgPSAwLFxuICAgICAgaiA9IDA7XG5cbiAgICBwcmV2Q29udGV4dCA9IGN0eDtcblxuICAgIGZ1bmN0aW9uIG5leHRFeGl0KCkge1xuICAgICAgdmFyIGZuID0gcGFnZS5leGl0c1tqKytdO1xuICAgICAgaWYgKCFmbikgcmV0dXJuIG5leHRFbnRlcigpO1xuICAgICAgZm4ocHJldiwgbmV4dEV4aXQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5leHRFbnRlcigpIHtcbiAgICAgIHZhciBmbiA9IHBhZ2UuY2FsbGJhY2tzW2krK107XG5cbiAgICAgIGlmIChjdHgucGF0aCAhPT0gcGFnZS5jdXJyZW50KSB7XG4gICAgICAgIGN0eC5oYW5kbGVkID0gZmFsc2U7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICghZm4pIHJldHVybiB1bmhhbmRsZWQoY3R4KTtcbiAgICAgIGZuKGN0eCwgbmV4dEVudGVyKTtcbiAgICB9XG5cbiAgICBpZiAocHJldikge1xuICAgICAgbmV4dEV4aXQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmV4dEVudGVyKCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBVbmhhbmRsZWQgYGN0eGAuIFdoZW4gaXQncyBub3QgdGhlIGluaXRpYWxcbiAgICogcG9wc3RhdGUgdGhlbiByZWRpcmVjdC4gSWYgeW91IHdpc2ggdG8gaGFuZGxlXG4gICAqIDQwNHMgb24geW91ciBvd24gdXNlIGBwYWdlKCcqJywgY2FsbGJhY2spYC5cbiAgICpcbiAgICogQHBhcmFtIHtDb250ZXh0fSBjdHhcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuICBmdW5jdGlvbiB1bmhhbmRsZWQoY3R4KSB7XG4gICAgaWYgKGN0eC5oYW5kbGVkKSByZXR1cm47XG4gICAgdmFyIGN1cnJlbnQ7XG5cbiAgICBpZiAoaGFzaGJhbmcpIHtcbiAgICAgIGN1cnJlbnQgPSBiYXNlICsgbG9jYXRpb24uaGFzaC5yZXBsYWNlKCcjIScsICcnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VycmVudCA9IGxvY2F0aW9uLnBhdGhuYW1lICsgbG9jYXRpb24uc2VhcmNoO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50ID09PSBjdHguY2Fub25pY2FsUGF0aCkgcmV0dXJuO1xuICAgIHBhZ2Uuc3RvcCgpO1xuICAgIGN0eC5oYW5kbGVkID0gZmFsc2U7XG4gICAgbG9jYXRpb24uaHJlZiA9IGN0eC5jYW5vbmljYWxQYXRoO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGFuIGV4aXQgcm91dGUgb24gYHBhdGhgIHdpdGhcbiAgICogY2FsbGJhY2sgYGZuKClgLCB3aGljaCB3aWxsIGJlIGNhbGxlZFxuICAgKiBvbiB0aGUgcHJldmlvdXMgY29udGV4dCB3aGVuIGEgbmV3XG4gICAqIHBhZ2UgaXMgdmlzaXRlZC5cbiAgICovXG4gIHBhZ2UuZXhpdCA9IGZ1bmN0aW9uKHBhdGgsIGZuKSB7XG4gICAgaWYgKHR5cGVvZiBwYXRoID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gcGFnZS5leGl0KCcqJywgcGF0aCk7XG4gICAgfVxuXG4gICAgdmFyIHJvdXRlID0gbmV3IFJvdXRlKHBhdGgpO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgICBwYWdlLmV4aXRzLnB1c2gocm91dGUubWlkZGxld2FyZShhcmd1bWVudHNbaV0pKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBVUkwgZW5jb2RpbmcgZnJvbSB0aGUgZ2l2ZW4gYHN0cmAuXG4gICAqIEFjY29tbW9kYXRlcyB3aGl0ZXNwYWNlIGluIGJvdGggeC13d3ctZm9ybS11cmxlbmNvZGVkXG4gICAqIGFuZCByZWd1bGFyIHBlcmNlbnQtZW5jb2RlZCBmb3JtLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsIC0gVVJMIGNvbXBvbmVudCB0byBkZWNvZGVcbiAgICovXG4gIGZ1bmN0aW9uIGRlY29kZVVSTEVuY29kZWRVUklDb21wb25lbnQodmFsKSB7XG4gICAgaWYgKHR5cGVvZiB2YWwgIT09ICdzdHJpbmcnKSB7IHJldHVybiB2YWw7IH1cbiAgICByZXR1cm4gZGVjb2RlVVJMQ29tcG9uZW50cyA/IGRlY29kZVVSSUNvbXBvbmVudCh2YWwucmVwbGFjZSgvXFwrL2csICcgJykpIDogdmFsO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYSBuZXcgXCJyZXF1ZXN0XCIgYENvbnRleHRgXG4gICAqIHdpdGggdGhlIGdpdmVuIGBwYXRoYCBhbmQgb3B0aW9uYWwgaW5pdGlhbCBgc3RhdGVgLlxuICAgKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcbiAgICogQHBhcmFtIHtPYmplY3Q9fSBzdGF0ZVxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBmdW5jdGlvbiBDb250ZXh0KHBhdGgsIHN0YXRlKSB7XG4gICAgaWYgKCcvJyA9PT0gcGF0aFswXSAmJiAwICE9PSBwYXRoLmluZGV4T2YoYmFzZSkpIHBhdGggPSBiYXNlICsgKGhhc2hiYW5nID8gJyMhJyA6ICcnKSArIHBhdGg7XG4gICAgdmFyIGkgPSBwYXRoLmluZGV4T2YoJz8nKTtcblxuICAgIHRoaXMuY2Fub25pY2FsUGF0aCA9IHBhdGg7XG4gICAgdGhpcy5wYXRoID0gcGF0aC5yZXBsYWNlKGJhc2UsICcnKSB8fCAnLyc7XG4gICAgaWYgKGhhc2hiYW5nKSB0aGlzLnBhdGggPSB0aGlzLnBhdGgucmVwbGFjZSgnIyEnLCAnJykgfHwgJy8nO1xuXG4gICAgdGhpcy50aXRsZSA9IGRvY3VtZW50LnRpdGxlO1xuICAgIHRoaXMuc3RhdGUgPSBzdGF0ZSB8fCB7fTtcbiAgICB0aGlzLnN0YXRlLnBhdGggPSBwYXRoO1xuICAgIHRoaXMucXVlcnlzdHJpbmcgPSB+aSA/IGRlY29kZVVSTEVuY29kZWRVUklDb21wb25lbnQocGF0aC5zbGljZShpICsgMSkpIDogJyc7XG4gICAgdGhpcy5wYXRobmFtZSA9IGRlY29kZVVSTEVuY29kZWRVUklDb21wb25lbnQofmkgPyBwYXRoLnNsaWNlKDAsIGkpIDogcGF0aCk7XG4gICAgdGhpcy5wYXJhbXMgPSB7fTtcblxuICAgIC8vIGZyYWdtZW50XG4gICAgdGhpcy5oYXNoID0gJyc7XG4gICAgaWYgKCFoYXNoYmFuZykge1xuICAgICAgaWYgKCF+dGhpcy5wYXRoLmluZGV4T2YoJyMnKSkgcmV0dXJuO1xuICAgICAgdmFyIHBhcnRzID0gdGhpcy5wYXRoLnNwbGl0KCcjJyk7XG4gICAgICB0aGlzLnBhdGggPSBwYXJ0c1swXTtcbiAgICAgIHRoaXMuaGFzaCA9IGRlY29kZVVSTEVuY29kZWRVUklDb21wb25lbnQocGFydHNbMV0pIHx8ICcnO1xuICAgICAgdGhpcy5xdWVyeXN0cmluZyA9IHRoaXMucXVlcnlzdHJpbmcuc3BsaXQoJyMnKVswXTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXhwb3NlIGBDb250ZXh0YC5cbiAgICovXG5cbiAgcGFnZS5Db250ZXh0ID0gQ29udGV4dDtcblxuICAvKipcbiAgICogUHVzaCBzdGF0ZS5cbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIENvbnRleHQucHJvdG90eXBlLnB1c2hTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHBhZ2UubGVuKys7XG4gICAgaGlzdG9yeS5wdXNoU3RhdGUodGhpcy5zdGF0ZSwgdGhpcy50aXRsZSwgaGFzaGJhbmcgJiYgdGhpcy5wYXRoICE9PSAnLycgPyAnIyEnICsgdGhpcy5wYXRoIDogdGhpcy5jYW5vbmljYWxQYXRoKTtcbiAgfTtcblxuICAvKipcbiAgICogU2F2ZSB0aGUgY29udGV4dCBzdGF0ZS5cbiAgICpcbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgQ29udGV4dC5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuICAgIGhpc3RvcnkucmVwbGFjZVN0YXRlKHRoaXMuc3RhdGUsIHRoaXMudGl0bGUsIGhhc2hiYW5nICYmIHRoaXMucGF0aCAhPT0gJy8nID8gJyMhJyArIHRoaXMucGF0aCA6IHRoaXMuY2Fub25pY2FsUGF0aCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYFJvdXRlYCB3aXRoIHRoZSBnaXZlbiBIVFRQIGBwYXRoYCxcbiAgICogYW5kIGFuIGFycmF5IG9mIGBjYWxsYmFja3NgIGFuZCBgb3B0aW9uc2AuXG4gICAqXG4gICAqIE9wdGlvbnM6XG4gICAqXG4gICAqICAgLSBgc2Vuc2l0aXZlYCAgICBlbmFibGUgY2FzZS1zZW5zaXRpdmUgcm91dGVzXG4gICAqICAgLSBgc3RyaWN0YCAgICAgICBlbmFibGUgc3RyaWN0IG1hdGNoaW5nIGZvciB0cmFpbGluZyBzbGFzaGVzXG4gICAqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxuICAgKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnNcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIGZ1bmN0aW9uIFJvdXRlKHBhdGgsIG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICB0aGlzLnBhdGggPSAocGF0aCA9PT0gJyonKSA/ICcoLiopJyA6IHBhdGg7XG4gICAgdGhpcy5tZXRob2QgPSAnR0VUJztcbiAgICB0aGlzLnJlZ2V4cCA9IHBhdGh0b1JlZ2V4cCh0aGlzLnBhdGgsXG4gICAgICB0aGlzLmtleXMgPSBbXSxcbiAgICAgIG9wdGlvbnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4cG9zZSBgUm91dGVgLlxuICAgKi9cblxuICBwYWdlLlJvdXRlID0gUm91dGU7XG5cbiAgLyoqXG4gICAqIFJldHVybiByb3V0ZSBtaWRkbGV3YXJlIHdpdGhcbiAgICogdGhlIGdpdmVuIGNhbGxiYWNrIGBmbigpYC5cbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIFJvdXRlLnByb3RvdHlwZS5taWRkbGV3YXJlID0gZnVuY3Rpb24oZm4pIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGN0eCwgbmV4dCkge1xuICAgICAgaWYgKHNlbGYubWF0Y2goY3R4LnBhdGgsIGN0eC5wYXJhbXMpKSByZXR1cm4gZm4oY3R4LCBuZXh0KTtcbiAgICAgIG5leHQoKTtcbiAgICB9O1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiB0aGlzIHJvdXRlIG1hdGNoZXMgYHBhdGhgLCBpZiBzb1xuICAgKiBwb3B1bGF0ZSBgcGFyYW1zYC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgUm91dGUucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24ocGF0aCwgcGFyYW1zKSB7XG4gICAgdmFyIGtleXMgPSB0aGlzLmtleXMsXG4gICAgICBxc0luZGV4ID0gcGF0aC5pbmRleE9mKCc/JyksXG4gICAgICBwYXRobmFtZSA9IH5xc0luZGV4ID8gcGF0aC5zbGljZSgwLCBxc0luZGV4KSA6IHBhdGgsXG4gICAgICBtID0gdGhpcy5yZWdleHAuZXhlYyhkZWNvZGVVUklDb21wb25lbnQocGF0aG5hbWUpKTtcblxuICAgIGlmICghbSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgZm9yICh2YXIgaSA9IDEsIGxlbiA9IG0ubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgIHZhciBrZXkgPSBrZXlzW2kgLSAxXTtcbiAgICAgIHZhciB2YWwgPSBkZWNvZGVVUkxFbmNvZGVkVVJJQ29tcG9uZW50KG1baV0pO1xuICAgICAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkIHx8ICEoaGFzT3duUHJvcGVydHkuY2FsbChwYXJhbXMsIGtleS5uYW1lKSkpIHtcbiAgICAgICAgcGFyYW1zW2tleS5uYW1lXSA9IHZhbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuXG4gIC8qKlxuICAgKiBIYW5kbGUgXCJwb3B1bGF0ZVwiIGV2ZW50cy5cbiAgICovXG5cbiAgdmFyIG9ucG9wc3RhdGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBsb2FkZWQgPSBmYWxzZTtcbiAgICBpZiAoJ3VuZGVmaW5lZCcgPT09IHR5cGVvZiB3aW5kb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHtcbiAgICAgIGxvYWRlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgfSwgMCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uIG9ucG9wc3RhdGUoZSkge1xuICAgICAgaWYgKCFsb2FkZWQpIHJldHVybjtcbiAgICAgIGlmIChlLnN0YXRlKSB7XG4gICAgICAgIHZhciBwYXRoID0gZS5zdGF0ZS5wYXRoO1xuICAgICAgICBwYWdlLnJlcGxhY2UocGF0aCwgZS5zdGF0ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYWdlLnNob3cobG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5oYXNoLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZmFsc2UpO1xuICAgICAgfVxuICAgIH07XG4gIH0pKCk7XG4gIC8qKlxuICAgKiBIYW5kbGUgXCJjbGlja1wiIGV2ZW50cy5cbiAgICovXG5cbiAgZnVuY3Rpb24gb25jbGljayhlKSB7XG5cbiAgICBpZiAoMSAhPT0gd2hpY2goZSkpIHJldHVybjtcblxuICAgIGlmIChlLm1ldGFLZXkgfHwgZS5jdHJsS2V5IHx8IGUuc2hpZnRLZXkpIHJldHVybjtcbiAgICBpZiAoZS5kZWZhdWx0UHJldmVudGVkKSByZXR1cm47XG5cblxuXG4gICAgLy8gZW5zdXJlIGxpbmtcbiAgICAvLyB1c2Ugc2hhZG93IGRvbSB3aGVuIGF2YWlsYWJsZVxuICAgIHZhciBlbCA9IGUucGF0aCA/IGUucGF0aFswXSA6IGUudGFyZ2V0O1xuICAgIHdoaWxlIChlbCAmJiAnQScgIT09IGVsLm5vZGVOYW1lKSBlbCA9IGVsLnBhcmVudE5vZGU7XG4gICAgaWYgKCFlbCB8fCAnQScgIT09IGVsLm5vZGVOYW1lKSByZXR1cm47XG5cblxuXG4gICAgLy8gSWdub3JlIGlmIHRhZyBoYXNcbiAgICAvLyAxLiBcImRvd25sb2FkXCIgYXR0cmlidXRlXG4gICAgLy8gMi4gcmVsPVwiZXh0ZXJuYWxcIiBhdHRyaWJ1dGVcbiAgICBpZiAoZWwuaGFzQXR0cmlidXRlKCdkb3dubG9hZCcpIHx8IGVsLmdldEF0dHJpYnV0ZSgncmVsJykgPT09ICdleHRlcm5hbCcpIHJldHVybjtcblxuICAgIC8vIGVuc3VyZSBub24taGFzaCBmb3IgdGhlIHNhbWUgcGF0aFxuICAgIHZhciBsaW5rID0gZWwuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgaWYgKCFoYXNoYmFuZyAmJiBlbC5wYXRobmFtZSA9PT0gbG9jYXRpb24ucGF0aG5hbWUgJiYgKGVsLmhhc2ggfHwgJyMnID09PSBsaW5rKSkgcmV0dXJuO1xuXG5cblxuICAgIC8vIENoZWNrIGZvciBtYWlsdG86IGluIHRoZSBocmVmXG4gICAgaWYgKGxpbmsgJiYgbGluay5pbmRleE9mKCdtYWlsdG86JykgPiAtMSkgcmV0dXJuO1xuXG4gICAgLy8gY2hlY2sgdGFyZ2V0XG4gICAgaWYgKGVsLnRhcmdldCkgcmV0dXJuO1xuXG4gICAgLy8geC1vcmlnaW5cbiAgICBpZiAoIXNhbWVPcmlnaW4oZWwuaHJlZikpIHJldHVybjtcblxuXG5cbiAgICAvLyByZWJ1aWxkIHBhdGhcbiAgICB2YXIgcGF0aCA9IGVsLnBhdGhuYW1lICsgZWwuc2VhcmNoICsgKGVsLmhhc2ggfHwgJycpO1xuXG4gICAgLy8gc3RyaXAgbGVhZGluZyBcIi9bZHJpdmUgbGV0dGVyXTpcIiBvbiBOVy5qcyBvbiBXaW5kb3dzXG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwYXRoLm1hdGNoKC9eXFwvW2EtekEtWl06XFwvLykpIHtcbiAgICAgIHBhdGggPSBwYXRoLnJlcGxhY2UoL15cXC9bYS16QS1aXTpcXC8vLCAnLycpO1xuICAgIH1cblxuICAgIC8vIHNhbWUgcGFnZVxuICAgIHZhciBvcmlnID0gcGF0aDtcblxuICAgIGlmIChwYXRoLmluZGV4T2YoYmFzZSkgPT09IDApIHtcbiAgICAgIHBhdGggPSBwYXRoLnN1YnN0cihiYXNlLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgaWYgKGhhc2hiYW5nKSBwYXRoID0gcGF0aC5yZXBsYWNlKCcjIScsICcnKTtcblxuICAgIGlmIChiYXNlICYmIG9yaWcgPT09IHBhdGgpIHJldHVybjtcblxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBwYWdlLnNob3cob3JpZyk7XG4gIH1cblxuICAvKipcbiAgICogRXZlbnQgYnV0dG9uLlxuICAgKi9cblxuICBmdW5jdGlvbiB3aGljaChlKSB7XG4gICAgZSA9IGUgfHwgd2luZG93LmV2ZW50O1xuICAgIHJldHVybiBudWxsID09PSBlLndoaWNoID8gZS5idXR0b24gOiBlLndoaWNoO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGBocmVmYCBpcyB0aGUgc2FtZSBvcmlnaW4uXG4gICAqL1xuXG4gIGZ1bmN0aW9uIHNhbWVPcmlnaW4oaHJlZikge1xuICAgIHZhciBvcmlnaW4gPSBsb2NhdGlvbi5wcm90b2NvbCArICcvLycgKyBsb2NhdGlvbi5ob3N0bmFtZTtcbiAgICBpZiAobG9jYXRpb24ucG9ydCkgb3JpZ2luICs9ICc6JyArIGxvY2F0aW9uLnBvcnQ7XG4gICAgcmV0dXJuIChocmVmICYmICgwID09PSBocmVmLmluZGV4T2Yob3JpZ2luKSkpO1xuICB9XG5cbiAgcGFnZS5zYW1lT3JpZ2luID0gc2FtZU9yaWdpbjtcbiJdfQ==","var isarray = require('isarray')\n\n/**\n * Expose `pathToRegexp`.\n */\nmodule.exports = pathToRegexp\nmodule.exports.parse = parse\nmodule.exports.compile = compile\nmodule.exports.tokensToFunction = tokensToFunction\nmodule.exports.tokensToRegExp = tokensToRegExp\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \"/:test(\\\\d+)?\" => [\"/\", \"test\", \"\\d+\", undefined, \"?\", undefined]\n  // \"/route(\\\\d+)\"  => [undefined, undefined, undefined, \"\\d+\", undefined, undefined]\n  // \"/*\"            => [\"/\", undefined, undefined, undefined, undefined, \"*\"]\n  '([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^()])+)\\\\))([+*?])?|(\\\\*))'\n].join('|'), 'g')\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {String} str\n * @return {Array}\n */\nfunction parse (str) {\n  var tokens = []\n  var key = 0\n  var index = 0\n  var path = ''\n  var res\n\n  while ((res = PATH_REGEXP.exec(str)) != null) {\n    var m = res[0]\n    var escaped = res[1]\n    var offset = res.index\n    path += str.slice(index, offset)\n    index = offset + m.length\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1]\n      continue\n    }\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path)\n      path = ''\n    }\n\n    var prefix = res[2]\n    var name = res[3]\n    var capture = res[4]\n    var group = res[5]\n    var suffix = res[6]\n    var asterisk = res[7]\n\n    var repeat = suffix === '+' || suffix === '*'\n    var optional = suffix === '?' || suffix === '*'\n    var delimiter = prefix || '/'\n    var pattern = capture || group || (asterisk ? '.*' : '[^' + delimiter + ']+?')\n\n    tokens.push({\n      name: name || key++,\n      prefix: prefix || '',\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      pattern: escapeGroup(pattern)\n    })\n  }\n\n  // Match any characters still remaining.\n  if (index < str.length) {\n    path += str.substr(index)\n  }\n\n  // If the path exists, push it onto the end.\n  if (path) {\n    tokens.push(path)\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {String}   str\n * @return {Function}\n */\nfunction compile (str) {\n  return tokensToFunction(parse(str))\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length)\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^' + tokens[i].pattern + '$')\n    }\n  }\n\n  return function (obj) {\n    var path = ''\n    var data = obj || {}\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i]\n\n      if (typeof token === 'string') {\n        path += token\n\n        continue\n      }\n\n      var value = data[token.name]\n      var segment\n\n      if (value == null) {\n        if (token.optional) {\n          continue\n        } else {\n          throw new TypeError('Expected \"' + token.name + '\" to be defined')\n        }\n      }\n\n      if (isarray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but received \"' + value + '\"')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) {\n            continue\n          } else {\n            throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n          }\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encodeURIComponent(value[j])\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment\n        }\n\n        continue\n      }\n\n      segment = encodeURIComponent(value)\n\n      if (!matches[i].test(segment)) {\n        throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n      }\n\n      path += token.prefix + segment\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {String} str\n * @return {String}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|\\/])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {String} group\n * @return {String}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$\\/()])/g, '\\\\$1')\n}\n\n/**\n * Attach the keys as a property of the regexp.\n *\n * @param  {RegExp} re\n * @param  {Array}  keys\n * @return {RegExp}\n */\nfunction attachKeys (re, keys) {\n  re.keys = keys\n  return re\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {String}\n */\nfunction flags (options) {\n  return options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {RegExp} path\n * @param  {Array}  keys\n * @return {RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g)\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        pattern: null\n      })\n    }\n  }\n\n  return attachKeys(path, keys)\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {Array}  path\n * @param  {Array}  keys\n * @param  {Object} options\n * @return {RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = []\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source)\n  }\n\n  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options))\n\n  return attachKeys(regexp, keys)\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {String} path\n * @param  {Array}  keys\n * @param  {Object} options\n * @return {RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  var tokens = parse(path)\n  var re = tokensToRegExp(tokens, options)\n\n  // Attach keys back to the regexp.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] !== 'string') {\n      keys.push(tokens[i])\n    }\n  }\n\n  return attachKeys(re, keys)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {Array}  tokens\n * @param  {Array}  keys\n * @param  {Object} options\n * @return {RegExp}\n */\nfunction tokensToRegExp (tokens, options) {\n  options = options || {}\n\n  var strict = options.strict\n  var end = options.end !== false\n  var route = ''\n  var lastToken = tokens[tokens.length - 1]\n  var endsWithSlash = typeof lastToken === 'string' && /\\/$/.test(lastToken)\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n\n    if (typeof token === 'string') {\n      route += escapeString(token)\n    } else {\n      var prefix = escapeString(token.prefix)\n      var capture = token.pattern\n\n      if (token.repeat) {\n        capture += '(?:' + prefix + capture + ')*'\n      }\n\n      if (token.optional) {\n        if (prefix) {\n          capture = '(?:' + prefix + '(' + capture + '))?'\n        } else {\n          capture = '(' + capture + ')?'\n        }\n      } else {\n        capture = prefix + '(' + capture + ')'\n      }\n\n      route += capture\n    }\n  }\n\n  // In non-strict mode we allow a slash at the end of match. If the path to\n  // match already ends with a slash, we remove it for consistency. The slash\n  // is valid at the end of a path match, not in the middle. This is important\n  // in non-ending mode, where \"/test/\" shouldn't match \"/test//route\".\n  if (!strict) {\n    route = (endsWithSlash ? route.slice(0, -2) : route) + '(?:\\\\/(?=$))?'\n  }\n\n  if (end) {\n    route += '$'\n  } else {\n    // In non-ending mode, we need the capturing groups to match as much as\n    // possible by using a positive lookahead to the end or next path segment.\n    route += strict && endsWithSlash ? '' : '(?=\\\\/|$)'\n  }\n\n  return new RegExp('^' + route, flags(options))\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(String|RegExp|Array)} path\n * @param  {Array}                 [keys]\n * @param  {Object}                [options]\n * @return {RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  keys = keys || []\n\n  if (!isarray(keys)) {\n    options = keys\n    keys = []\n  } else if (!options) {\n    options = {}\n  }\n\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, keys, options)\n  }\n\n  if (isarray(path)) {\n    return arrayToRegexp(path, keys, options)\n  }\n\n  return stringToRegexp(path, keys, options)\n}\n","/*\n * action types\n */\n\nexport const UPDATE_SELECTION = 'UPDATE_SELECTION'\nexport const TOGGLE_NAVIGATION = 'TOGGLE_NAVIGATION'\nexport const ADD_ITEM = 'ADD_ITEM'\nexport const REMOVE_ITEM = 'REMOVE_ITEM'\nexport const TOGGLE_ACTIVE= 'TOGGLE_ACTIVE'\n\nexport function updateSelection(tax, value) {\n  return {\n    type: UPDATE_SELECTION,\n    value: value,\n    tax: tax\n  }\n}\n\nexport function toggleNavigation(isOpen) {\n  return {\n    type: TOGGLE_NAVIGATION,\n    isOpen: isOpen\n  }\n}\n\n\nexport function addItem() {\n  return {\n    type: ADD_ITEM\n  }\n}\n\nexport function removeItem() {\n  return {\n    type: REMOVE_ITEM\n  }\n}\n\nexport function toggleActive(index) {\n  return {\n    type: TOGGLE_ACTIVE,\n    index: index\n  }\n}\n","import * as diff from 'diffhtml'\nimport { map, extend, delegateEvent } from '../modules/utils'\n\nexport default function componentFactory(config) {\n\n  const component = extend({}, config, { \n\n    render(state) {\n      const markup = this.markup(state)\n      diff.innerHTML(this.rootEl, markup)\n    }\n\n  })\n\n  map(component.events, (eventConfig) => {\n\n    const opts = extend({}, {\n      type: '',\n      selector: '',\n      handler(){}\n    }, eventConfig)\n\n    const selector = '[' + opts.selector.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase() + ']'\n\n    delegateEvent(component.rootEl, opts.type, selector, opts.handler)\n  \n  })\n\n  return component\n}","import vuBuggyfill from 'viewport-units-buggyfill'\n\nexport const vu = vuBuggyfill.init\n\n// console.log(vuBuggyfill.init)\n\nexport const classList = () => {\n\n  if (typeof window.Element === \"undefined\" || \"classList\" in document.documentElement) return\n\n  var prototype = Array.prototype,\n    push = prototype.push,\n    splice = prototype.splice,\n    join = prototype.join\n\n  function DOMTokenList(el) {\n    this.el = el\n    // The className needs to be trimmed and split on whitespace\n    // to retrieve a list of classes.\n    var classes = el.className.replace(/^\\s+|\\s+$/g, '').split(/\\s+/)\n    for (var i = 0; i < classes.length; i++) {\n      push.call(this, classes[i])\n    }\n  }\n\n  DOMTokenList.prototype = {\n    add: function(token) {\n      if (this.contains(token)) return\n      push.call(this, token)\n      this.el.className = this.toString()\n    },\n    contains: function(token) {\n      return this.el.className.indexOf(token) != -1\n    },\n    item: function(index) {\n      return this[index] || null\n    },\n    remove: function(token) {\n      if (!this.contains(token)) return\n      for (var i = 0; i < this.length; i++) {\n        if (this[i] == token) break\n      }\n      splice.call(this, i, 1)\n      this.el.className = this.toString()\n    },\n    toString: function() {\n      return join.call(this, ' ')\n    },\n    toggle: function(token) {\n      if (!this.contains(token)) {\n        this.add(token)\n      } else {\n        this.remove(token)\n      }\n\n      return this.contains(token)\n    }\n  }\n\n  window.DOMTokenList = DOMTokenList\n\n  function defineElementGetter(obj, prop, getter) {\n    if (Object.defineProperty) {\n      Object.defineProperty(obj, prop, {\n        get: getter\n      })\n    } else {\n      obj.__defineGetter__(prop, getter)\n    }\n  }\n\n  defineElementGetter(Element.prototype, 'classList', function() {\n    return new DOMTokenList(this)\n  })\n\n}\n\nexport const dataset = () => {\n\n  var forEach = [].forEach,\n    regex = /^data-(.+)/,\n    dashChar = /\\-([a-z])/ig,\n    el = document.createElement('div'),\n    mutationSupported = false,\n    match\n\n  function detectMutation() {\n    mutationSupported = true\n    this.removeEventListener('DOMAttrModified', detectMutation, false)\n  }\n\n  function toCamelCase(s) {\n    return s.replace(dashChar, function(m, l) {\n      return l.toUpperCase()\n    })\n  }\n\n  function updateDataset() {\n    var dataset = {}\n    forEach.call(this.attributes, function(attr) {\n      if (match = attr.name.match(regex))\n        dataset[toCamelCase(match[1])] = attr.value\n    })\n    return dataset\n  }\n\n  // only add support if the browser doesn't support data-* natively\n  if (el.dataset != undefined) return\n\n  el.addEventListener('DOMAttrModified', detectMutation, false)\n  el.setAttribute('foo', 'bar')\n\n  function defineElementGetter(obj, prop, getter) {\n    if (Object.defineProperty) {\n      Object.defineProperty(obj, prop, {\n        get: getter\n      })\n    } else {\n      obj.__defineGetter__(prop, getter)\n    }\n  }\n\n  defineElementGetter(Element.prototype, 'dataset', mutationSupported ? function() {\n    if (!this._datasetCache) {\n      this._datasetCache = updateDataset.call(this)\n    }\n    return this._datasetCache\n  } : updateDataset)\n\n  document.addEventListener('DOMAttrModified', function(event) {\n    delete event.target._datasetCache\n  }, false)\n\n}\n\nexport const domParser = () => {\n\n  /*\n   * DOMParser HTML extension\n   * 2012-09-04\n   * \n   * By Eli Grey, http://eligrey.com\n   * Public domain.\n   * NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n   */\n\n  /*! @source https://gist.github.com/1129031 */\n  /*global document, DOMParser*/\n\n  (function(DOMParser) {\n    \"use strict\"\n\n    let DOMParser_proto = DOMParser.prototype, \n        real_parseFromString = DOMParser_proto.parseFromString\n    \n\n    // Firefox/Opera/IE throw errors on unsupported types\n    try {\n      // WebKit returns null on unsupported types\n      if ((new DOMParser).parseFromString(\"\", \"text/html\")) {\n        // text/html parsing is natively supported\n        return\n      }\n    } catch (ex) {}\n\n    DOMParser_proto.parseFromString = function(markup, type) {\n      if (/^\\s*text\\/html\\s*(?:|$)/i.test(type)) {\n        var\n          doc = document.implementation.createHTMLDocument(\"\")\n        \n              if (markup.toLowerCase().indexOf('<!doctype') > -1) {\n                doc.documentElement.innerHTML = markup\n              }\n              else {\n                doc.body.innerHTML = markup\n              }\n        return doc\n      } else {\n        return real_parseFromString.apply(this, arguments)\n      }\n    }\n\n  }(window.DOMParser))\n\n}\n","import { combineReducers } from 'redux'\nimport { inArray, map } from './utils'\n\nimport { \n  UPDATE_SELECTION, \n  TOGGLE_NAVIGATION, \n  ADD_ITEM,\n  REMOVE_ITEM,\n  TOGGLE_ACTIVE\n} from './actions'\n\n\nfunction item(state, action) {\n  switch (action.type) {\n    case UPDATE_SELECTION :\n\n      const { item, selection } = state\n      const isFiltered = item.taxonomies.reduce((bool, tax) => {\n        return bool ? bool : (selection[tax.taxonomy_name] && selection[tax.taxonomy_name] !== tax.value) ? true : false\n      }, false)\n\n      return {\n        ...item,\n        isFiltered: isFiltered\n      }\n    \n    default :\n      return state\n  }\n}\n\nfunction filter(state, action) {\n  switch (action.type) {\n    case UPDATE_SELECTION :\n\n      const { filter, items, selection } = state\n      const updatedOptions = filter.options.map(option => {\n\n        const newSelection = {\n          ...selection,\n          [filter.taxonomy_name]: option.option_name\n        }\n\n        const filteredItems = items\n          .map(i => item({item: i, selection: newSelection}, action))\n          .map(item => item.isFiltered)\n\n        return {\n          ...option,\n          isValid: inArray(false, filteredItems)\n        }\n\n      })\n\n      return {\n        ...filter,\n        options: updatedOptions\n      }\n\n    default : \n      return state\n  }\n}\n\nfunction appliedFilters(state = {}, action) {\n  switch (action.type) {\n    case UPDATE_SELECTION : \n\n      const { items, filters } = state\n      const newSelection = {\n        ...state.selection,\n        [action.tax]: action.value\n      }\n      const filteredItems = items.map(i => item({item: i, selection: newSelection}, action))\n      const updatedFilters = filters.map(f => filter({\n        filter: f,\n        items: filteredItems,\n        selection: newSelection\n      }, action))\n\n      return {\n        ...state,\n        items: filteredItems,\n        selection: newSelection,\n        filters: updatedFilters\n      }\n\n    default : \n      return state\n\n  }\n}\n\nfunction header(state = {}, action) {\n\n  switch (action.type) {\n    case TOGGLE_NAVIGATION : \n\n      return {\n        ...state,\n        isOpen: !state.isOpen\n      }\n\n    default : \n      return state\n\n  }\n}\n\nfunction componentReducer(state = {}, action) {\n  \n  switch(action.type) {\n    case ADD_ITEM :\n\n      state.items.push({\n        title: 'New Item'\n      })\n      \n      return {\n        ...state,\n        items: [\n          ...state.items\n        ]\n      }\n\n    case REMOVE_ITEM :\n\n      state.items.splice(-1, 1)\n      return {\n        ...state,\n        items: [\n          ...state.items\n        ]\n      }\n\n    case TOGGLE_ACTIVE : \n\n      return {\n        ...state,\n        items: map(state.items, (item, i) => {\n\n          if(i == action.index) {\n            item.isActive = !item.isActive\n          }\n\n          return item\n        })\n      }\n\n    default: \n      return state\n  }\n}\n\nfunction contactReducer(state = {}, action) {\n  \n  switch(action.type) {\n    default :\n      return {\n        ...state\n      }\n  }\n}\n\nconst filterApp = combineReducers({\n  appliedFilters\n})\n\nconst headerReducer = combineReducers({\n  header, appliedFilters\n})\n\nexport { filterApp, headerReducer, componentReducer, contactReducer }","export function inRange(val, range) {\n  return val > range[0] && val < range[1]\n}\n\nexport function inCanvas(x, y, r, canvas) {\n  let w = canvas.width,\n      h = canvas.height\n\n  return (inRange(x, [-r , w + r]) && inRange(y, [-r , h + r]) )\n} \n\nexport function randomInt(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min\n}\n\nexport function randomNum(min, max) {\n  return Math.random() * (max - min) + min\n}\n\nexport function coords(x, y, canvas) {\n  return {\n      x: x * canvas.width / canvas.clientWidth,\n      y: y * canvas.height /  canvas.clientHeight\n  }\n}\n\nexport function inArray(item, array) {\n  return array.indexOf(item) > -1\n}\n\nexport function vw(ratio = 1) {\n  return window.innerWidth * ratio\n}\n\nexport function vh(ratio = 1) {\n  return window.innerHeight * ratio\n}\n\nexport function recur(fn, seed) {\n  let result = fn(seed)\n  if(!!result) {\n    recur(fn, result)\n  }\n} \n\nexport function selectorMatches(el, selector) {\n  let p = Element.prototype\n  let f = p.matches || p.webkitMatchesSelector || p.mozMatchesSelector || p.msMatchesSelector || function(s) {\n    return [].indexOf.call(document.querySelectorAll(s), this) !== -1\n  }\n  return f.call(el, selector)\n}\n\n/**\n *\n * Create a new DOM element\n *\n * @param {string} tagname - Element tagname ('iframe', 'div')\n * @param {object} attributes - Object of attributes to be assigned to the object.\n * @returns {HTMLElement} The DOM element\n *\n */\n\n\nexport function createElement(tagname, attributes = {}, data = {}) {\n\n  let el = document.createElement(tagname);\n\n  if(el.setAttribute) {\n    map(attributes, (k, v) => {\n      el.setAttribute(k, v)\n    })\n\n    map(data, (k, v) => {\n      el.setAttribute('data-' + k, v)\n    })\n  }\n\n  return el;\n}\n\n\n/**\n *\n *  Element.addEventListener with event delegation\n *\n *  @param {HTMLElement} el - DOM element to which to append the eventListener\n *  @param {string} eventName - Name of the DOM event to be attached.\n *  @param {string} delegate - Selector string to use for delegation\n *  @param {function} handler - Event handler function\n *\n * @returns {undefined}\n * \n */\n\nexport function delegateEvent(el, eventName, delegate, handler) {\n  \n  if(typeof handler !== 'function') return;\n  if(el.addEventListener) {\n    el.addEventListener(eventName, (e) => {\n      if(selectorMatches(e.target, delegate)) {        \n        handler(e)\n      }\n    })\n  }\n\n}\n\n\nexport function map(arrLike, cb) {\n\n  if(!arrLike) {\n    return false\n  }\n\n  if(arrLike.length) {\n\n    return Array.prototype.map.call(arrLike, cb)\n  \n  } else if(arrLike.length !== 'undefined' && arrLike.length == 0) {\n  \n    return [];\n  \n  } else if(typeof arrLike == 'object' && arrLike.constructor == Object) {\n    \n    const newArrLike = {}\n    for (var k in arrLike) {\n      if (arrLike.hasOwnProperty(k)) {\n        newArrLike[k] = cb(k, arrLike[k])\n      }\n    }\n    return newArrLike\n\n  } else if(arrLike) {\n    return Array.prototype.map.call([arrLike], cb)\n  } \n}\n\nexport function mapJoin(arrLike, cb, separator = '') {\n  return map(arrLike, cb).join(separator)\n}\n\nexport function filter(arrLike, cb) {\n\n  if(!arrLike) {\n    return false\n  }\n\n  if(arrLike.length) {\n\n    return Array.prototype.filter.call(arrLike, cb)\n  \n  } else if(arrLike.length !== 'undefined' && arrLike.length == 0) {\n  \n    return [];\n  \n  } else if(typeof arrLike == 'object' && arrLike.constructor == Object) {\n    \n    // const newArrLike = {}\n    // for (var k in arrLike) {\n    //   if (arrLike.hasOwnProperty(k)) {\n    //     newArrLike[k] = cb(k, arrLike[k])\n    //   }\n    // }\n    // return newArrLike\n\n  }\n}\n\nexport function reduce(arrLike, cb, seed) {\n\n  if(!arrLike) {\n    return false\n  }\n\n  if(arrLike.length) {\n    return Array.prototype.map.reduce(arrLike, cb)\n  } else if(arrLike) {\n    return Array.prototype.map.reduce([arrLike], cb)\n  }\n}\n\nexport  function extend(){\n  for(let i=1; i<arguments.length; i++)\n    for(let key in arguments[i])\n      if(arguments[i].hasOwnProperty(key))\n        arguments[0][key] = arguments[i][key];\n  return arguments[0];\n}\n\nexport function equalsAny(item, arr) {\n  let flag = false\n\n  arr.map(i => {\n    if(i == item) {\n      flag = true\n    }\n  })\n\n  return flag\n}\n","/** \n*\n* Video\n*\n*/\n\nimport { map } from './utils'\n\nexport function videoController(videoEl = null) {\n\n  if(!videoEl || !videoEl.play) {\n    return false\n  }\n\n  let srcs = map(videoEl.querySelectorAll('source'), sourceEl => {\n    sourceEl.src = sourceEl.dataset.src\n  })\n\n  return {\n    el: videoEl,\n\n    isLoaded: false,\n\n    load() {\n      videoEl.load()\n      this.isLoaded = true;\n    },\n\n    play() {\n      videoEl.play()\n    },\n\n    pause() {\n      videoEl.pause()\n    },\n\n    togglePlay() {\n      if(videoEl.paused) {\n        videoEl.play()\n      } else {\n        videoEl.pause()\n      }\n    } \n  }\n}","/** \n*\n* Contact\n*\n*/\n\nimport * as PubSub from 'pubsub-js'\nimport { createStore } from 'redux'\nimport { validateField } from '../modules/actions'\nimport { contactReducer } from '../modules/reducers'\nimport componentFactory from '../modules/component'\nimport { delegateEvent, map, filter, extend, createElement, equalsAny } from '../modules/utils'\n\nfunction inputVars(field) {\n  return extend({}, {\n    label: false,\n    id: field.name,\n    options: [],\n    placeholder: '',\n    required: true\n  }, field)\n\n}\n\nfunction selectView(rootEl, field) {\n\n  let { id, label, name, options, required } = inputVars(field)\n\n  return componentFactory({\n    rootEl: rootEl,\n    markup(state) {\n\n      return `\n        <div class=\"form__group form__group--select\">\n\n          <select id=\"${ id }\" name=\"${ name }\" class=\"form__control\">\n            ${ map(options, option => `<option value=${ option.value }>${ option.label }</option>`) }\n          </select>\n          <label for=${ id }>${ label }</label>\n        </div>\n      `\n    }\n  })\n\n}\n\nfunction submitView(label) {\n  return `\n    <div class=\"form__submit\">\n      <button type=\"submit\" class=\"btn btn--lg form__submit\">${ label }</button>\n    </div>\n  `\n}\n\nfunction radioView(rootEl, field) {\n\n  let { id, label, name, options, required } = inputVars(field)\n\n  return componentFactory({\n    rootEl: rootEl,\n    markup(state) {\n      return `\n        <div class=\"form__group form__group--radio\">\n          <label>${ label }</label>\n          ${ map(options, (option, i) => `\n              <input class=\"form__control\" id=${ id }-${ i } name=${ name } type=\"radio\">\n              <label for=${ id }-${ i }><span>${ option.label }</span></label>\n          `).join('') }\n        </div>\n      `\n    }\n  })\n}\n\n\nfunction inputView(rootEl, field) {\n\n  let { id, label, type, placeholder, name, required } = inputVars(field)\n\n  return componentFactory({\n    rootEl: rootEl,\n    markup(state) {\n      return `\n        <div class=\"form__group form__group--boxed\">\n          <input id=\"${ id }\" name=\"${ name }\" type=\"${ type }\" placeholder=\"${ placeholder }\" class=\"form__control\" >\n          <label for=\"${ id }\">${ label }</label>\n        </div>\n      `\n    }\n  })\n}\n\nfunction formControlView(rootEl, field) {\n\n  if(!field.name) {\n    return false;\n  }\n\n  if(equalsAny(field.type, ['text', 'email', 'url'])) {\n    return inputView(rootEl, field)\n  }\n\n  switch(field.type) {\n    case 'select':\n      return selectView(rootEl, field)\n      break\n    case 'radio' :\n      return radioView(rootEl, field)\n      break\n  } \n}\n\n\n/** \n*\n* TODO\n*\n* Move input vars declaaration to formControls instantiation step\n*\n*/\nexport default function contactFormView(rootEl, config) {\n  \n  const store = createStore(contactReducer, {\n    fields: config.fields\n  })\n\n  const formView = componentFactory({\n    rootEl: rootEl,\n    events: [],\n    markup(state) {\n\n      return map(state.fields, field => formControlView(rootEl, field))\n        .filter(field => field)\n        .map(fieldControl => fieldControl.markup())\n        .join('')\n    }\n  })\n\n  const render = () => {\n    const { fields } = store.getState()\n\n    formView.render({\n      fields: fields\n    })\n\n  }\n\n  return {\n    render() {\n      store.subscribe(render)\n      render()\n    }\n  }\n\n}\n\n\n","import * as PubSub from 'pubsub-js'\nimport { inRange, delegateEvent } from '../modules/utils'\n\nconst rootEl = document.body\nconst rootClass = rootEl.classList\n\nconst headerViewProto = {\n  isOpen: false,\n\n  init: (() => {\n\n  })(),\n\n  open() {\n    rootClass.add('is-menu-active')\n    PubSub.publish('header-view:open')\n    this.isOpen = true;\n  },\n  \n  close() {\n    rootClass.remove('is-menu-active')\n    PubSub.publish('header-view:close')\n    this.isOpen = false;\n  },\n\n  toggle() {\n\n    if(!this.isOpen) {\n      this.open()\n    } else {\n      this.close()\n    }\n\n    PubSub.publish('header-view:toggle')\n  }\n}\n\nconst headerView = (headerEl) => {\n\n  const view = Object.create(headerViewProto)\n  const toggleEl = headerEl.querySelector('[data-nav-toggle]')\n\n  if(!headerEl || !toggleEl) {\n    return false;\n  }\n\n  toggleEl.addEventListener('click',  () => view.toggle())\n  \n  window.addEventListener('keydown', (e) => {\n    if(e.keyCode == 27) {\n      view.close()\n    }\n  })\n\n  return view\n\n}\n\n\nexport default headerView","import * as PubSub from 'pubsub-js'\nimport { map, delegateEvent } from '../modules/utils'\n\nconst navViewProto = {\n  isOpen: false,\n\n  init() {\n    this.setStyle()\n  },\n\n  setStyle() {\n    const bgEls = this.el.querySelectorAll('[data-style]')\n    map(bgEls, (el) => {\n      if(el.dataset.style) {\n        el.setAttribute('style', el.dataset.style)\n      }\n    })\n  }\n}\n\nconst navView = (navEl) => {\n\n  const view = Object.create(navViewProto)\n\n  if(!navEl) {\n    return false;\n  }\n\n  view.el = navEl\n\n  return view\n\n}\n\nexport default navView","/** \n*\n* Page Sections\n*\n*/\n\nimport * as PubSub from 'pubsub-js'\nimport { map } from '../modules/utils'\n\nconst emitter = (el, eventName) => {\n\n  let event = false\n\n  if(typeof el == 'object') {\n    el.addEventListener(eventName, (e)=> {\n      PubSub.publish(eventName, e)\n    })\n  }\n\n}\n\nlet em = emitter(window, 'scroll')\n\nconst pageSectionsProto = {\n\n}\n\nconst scrollSubscription = (callback) => {\n  return PubSub.subscribe('scroll', (eventName, e) => {\n    if(typeof callback == 'function') {\n      callback(e)\n    }\n  })\n}\n\nfunction requestAnimation(cb) {\n  if ('requestAnimationFrame' in window) {\n    requestAnimationFrame(cb)\n  }\n}\n\nfunction elementInViewport(top, height) {\n  let { scrollY, innerHeight} = window\n  return (scrollY - height < top) && (scrollY + innerHeight > top)\n}\n\nfunction getOffsetTop( el ) {\n  let top = 0\n\n  while( el = el.offsetParent ) {\n    if ( !isNaN( el.offsetTop ) ) {\n      top += el.offsetTop\n    }\n  }\n\n  return top\n}\n\nfunction elementOffset(el) {\n\n  let top, height, rect\n  let parent = el.parentElement\n  \n  let update = () => {\n    // top = getOffsetTop(el),\n    height = el.offsetHeight\n  }\n\n  window.addEventListener('resize', update)\n  window.addEventListener('load', update)\n\n  update()\n\n  return {\n    height: height,\n  }\n}\n\nfunction sectionView(section, cb) {\n\n  let x = 0\n  let y = window.scrollY*0.2 + 'px'\n  let offset = elementOffset(section)\n  let { classList } = section\n  let cf = {\n    offset: 0\n  }\n\n  return {\n\n    el: section,\n\n    isInView: false,\n\n    set(k, v) {\n      cf[k] = v\n\n      return this\n    },\n\n    render() {\n\n      let rect = section.getBoundingClientRect()\n      let pub = (eventName) => {\n        PubSub.publish(eventName, this)\n      }\n\n      this.isInView = (0 > rect.top - innerHeight + parseInt(cf.offset))\n\n      if(this.isInView) {\n        classList.remove('is-out')\n        pub('section-view:enter')\n      } else if(!this.isInView && !classList.contains('is-out')) {\n        classList.add('is-out')\n        pub('section-view:leave')\n      }\n\n\n      return this\n    }\n  }\n\n}\n\n\n/** \n*\n* Single Project View\n*\n*/\n\nexport default function pageSections(sectionEls) {\n\n  let sectionViews = map(sectionEls, (section) => {\n    return sectionView(section)\n      .set('offset', section.dataset.offset || 50)\n  })\n\n\n  let subscriptionID = scrollSubscription((e) => {\n    sectionViews.map(view => view.render())\n  })\n\n  return sectionViews\n\n}","// shim for using process in browser\n\nvar process = module.exports = {};\n\nprocess.nextTick = (function () {\n    var canSetImmediate = typeof window !== 'undefined'\n    && window.setImmediate;\n    var canMutationObserver = typeof window !== 'undefined'\n    && window.MutationObserver;\n    var canPost = typeof window !== 'undefined'\n    && window.postMessage && window.addEventListener\n    ;\n\n    if (canSetImmediate) {\n        return function (f) { return window.setImmediate(f) };\n    }\n\n    var queue = [];\n\n    if (canMutationObserver) {\n        var hiddenDiv = document.createElement(\"div\");\n        var observer = new MutationObserver(function () {\n            var queueList = queue.slice();\n            queue.length = 0;\n            queueList.forEach(function (fn) {\n                fn();\n            });\n        });\n\n        observer.observe(hiddenDiv, { attributes: true });\n\n        return function nextTick(fn) {\n            if (!queue.length) {\n                hiddenDiv.setAttribute('yes', 'no');\n            }\n            queue.push(fn);\n        };\n    }\n\n    if (canPost) {\n        window.addEventListener('message', function (ev) {\n            var source = ev.source;\n            if ((source === window || source === null) && ev.data === 'process-tick') {\n                ev.stopPropagation();\n                if (queue.length > 0) {\n                    var fn = queue.shift();\n                    fn();\n                }\n            }\n        }, true);\n\n        return function nextTick(fn) {\n            queue.push(fn);\n            window.postMessage('process-tick', '*');\n        };\n    }\n\n    return function nextTick(fn) {\n        setTimeout(fn, 0);\n    };\n})();\n\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\n// TODO(shtylman)\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\n","(function (global){\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.diff = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.upgrade = upgrade;\n/**\n * Store all Custom Element definitions in this object. The tagName is the key.\n *\n * @public\n */\nvar components = exports.components = {};\n\n/**\n * Ensures the element instance matches the CustomElement's prototype.\n *\n * @param nodeName - The HTML nodeName to use for the Custom Element\n * @param element - The element to upgrade\n * @param descriptor - The virtual node backing the element\n * @return {Boolean} successfully upgraded\n */\nfunction upgrade(nodeName, element, descriptor) {\n  // Value of the `is` attribute, if it exists.\n  var isAttr = null;\n\n  // Check for the `is` attribute. It has a known bug where it cannot be\n  // applied dynamically.\n  if (!components[nodeName] && Array.isArray(descriptor.attributes)) {\n    descriptor.attributes.some(function (attr, idx) {\n      if (attr.name === 'is') {\n        isAttr = attr.value;\n        return true;\n      }\n    });\n  }\n\n  // Hack around the `is` attribute being unable to be set dynamically.\n  if (isAttr && components[isAttr]) {\n    nodeName = isAttr;\n  }\n\n  var CustomElement = components[nodeName];\n\n  if (!CustomElement) {\n    return false;\n  }\n\n  if (CustomElement.extends && CustomElement.extends !== descriptor.nodeName) {\n    return false;\n  }\n\n  // If no Custom Element was registered, bail early. Don't need to upgrade\n  // if the element was already processed..\n  if (typeof CustomElement === 'function' && element instanceof CustomElement) {\n    return false;\n  }\n\n  // Copy the prototype into the Element.\n  element.__proto__ = Object.create(CustomElement.prototype);\n\n  // Custom elements have a createdCallback method that should be called.\n  if (CustomElement.prototype.createdCallback) {\n    CustomElement.prototype.createdCallback.call(element);\n  }\n\n  // Is the element existing in the DOM?\n  var inDOM = element.ownerDocument.contains(element);\n\n  // If the Node is in the DOM, trigger attached callback.\n  if (inDOM && CustomElement.prototype.attachedCallback) {\n    element.attachedCallback();\n  }\n\n  // The upgrade was successful.\n  return true;\n}\n\n},{}],2:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = get;\n\nvar _make = _dereq_('../node/make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nvar _make3 = _dereq_('../element/make');\n\nvar _make4 = _interopRequireDefault(_make3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Takes in an element descriptor and resolve it to a uuid and DOM Node.\n *\n * @param descriptor - Element descriptor\n * @return {Object} containing the uuid and DOM node\n */\nfunction get(descriptor) {\n  var uuid = descriptor.uuid;\n  var element = (0, _make4.default)(descriptor);\n\n  return { uuid: uuid, element: element };\n}\n\n},{\"../element/make\":3,\"../node/make\":6}],3:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = make;\n\nvar _svg = _dereq_('../svg');\n\nvar svg = _interopRequireWildcard(_svg);\n\nvar _make = _dereq_('../node/make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nvar _custom = _dereq_('./custom');\n\nvar _entities = _dereq_('../util/entities');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/**\n * Takes in a virtual descriptor and creates an HTML element. Sets the element\n * into the cache.\n *\n * @param descriptor - Element descriptor\n * @return {Element} - The newly created DOM Node\n */\nfunction make(descriptor) {\n  var element = null;\n  var isSvg = false;\n  // Get the Custom Element constructor for a given element.\n  var nodeName = descriptor.nodeName;\n  var CustomElement = _custom.components[nodeName];\n\n  // If the element descriptor was already created, reuse the existing element.\n  if (_make2.default.nodes[descriptor.uuid]) {\n    return _make2.default.nodes[descriptor.uuid];\n  }\n\n  if (descriptor.nodeName === '#text') {\n    element = document.createTextNode(descriptor.nodeValue);\n  } else {\n    if (svg.elements.indexOf(descriptor.nodeName) > -1) {\n      isSvg = true;\n      element = document.createElementNS(svg.namespace, descriptor.nodeName);\n    } else {\n      element = document.createElement(descriptor.nodeName);\n    }\n\n    // Copy all the attributes from the descriptor into the newly created DOM\n    // Node.\n    if (descriptor.attributes && descriptor.attributes.length) {\n      for (var i = 0; i < descriptor.attributes.length; i++) {\n        var attribute = descriptor.attributes[i];\n        element.setAttribute(attribute.name, attribute.value);\n      }\n    }\n\n    // Append all the children into the element, making sure to run them\n    // through this `make` function as well.\n    if (descriptor.childNodes && descriptor.childNodes.length) {\n      for (var _i = 0; _i < descriptor.childNodes.length; _i++) {\n        element.appendChild(make(descriptor.childNodes[_i]));\n      }\n    }\n  }\n\n  // Upgrade the element after creating it, if necessary.\n  (0, _custom.upgrade)(nodeName, element, descriptor);\n\n  // Custom elements have a createdCallback method that should be called.\n  if (CustomElement && CustomElement.prototype.createdCallback) {\n    CustomElement.prototype.createdCallback.call(element);\n  }\n\n  // Add to the nodes cache using the designated uuid as the lookup key.\n  _make2.default.nodes[descriptor.uuid] = element;\n\n  return element;\n}\n\n},{\"../node/make\":6,\"../svg\":12,\"../util/entities\":14,\"./custom\":1}],4:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar missingStackTrace = 'Browser doesn\\'t support error stack traces.';\n\n/**\n * Identifies an error with transitions.\n */\n\nvar TransitionStateError = exports.TransitionStateError = function (_Error) {\n  _inherits(TransitionStateError, _Error);\n\n  function TransitionStateError(message) {\n    var _this;\n\n    _classCallCheck(this, TransitionStateError);\n\n    var error = (_this = _possibleConstructorReturn(this, Object.getPrototypeOf(TransitionStateError).call(this)), _this);\n\n    _this.message = message;\n    _this.stack = error.stack || missingStackTrace;\n    return _this;\n  }\n\n  return TransitionStateError;\n}(Error);\n\n/**\n * Identifies an error with registering an element.\n */\n\n\nvar DOMException = exports.DOMException = function (_Error2) {\n  _inherits(DOMException, _Error2);\n\n  function DOMException(message) {\n    var _this2;\n\n    _classCallCheck(this, DOMException);\n\n    var error = (_this2 = _possibleConstructorReturn(this, Object.getPrototypeOf(DOMException).call(this)), _this2);\n\n    _this2.message = 'Uncaught DOMException: ' + message;\n    _this2.stack = error.stack || missingStackTrace;\n    return _this2;\n  }\n\n  return DOMException;\n}(Error);\n\n},{}],5:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DOMException = exports.TransitionStateError = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _errors = _dereq_('./errors');\n\nObject.defineProperty(exports, 'TransitionStateError', {\n  enumerable: true,\n  get: function get() {\n    return _errors.TransitionStateError;\n  }\n});\nObject.defineProperty(exports, 'DOMException', {\n  enumerable: true,\n  get: function get() {\n    return _errors.DOMException;\n  }\n});\nexports.outerHTML = outerHTML;\nexports.innerHTML = innerHTML;\nexports.element = element;\nexports.release = release;\nexports.registerElement = registerElement;\nexports.addTransitionState = addTransitionState;\nexports.removeTransitionState = removeTransitionState;\nexports.enableProllyfill = enableProllyfill;\n\nvar _patch = _dereq_('./node/patch');\n\nvar _patch2 = _interopRequireDefault(_patch);\n\nvar _release = _dereq_('./node/release');\n\nvar _release2 = _interopRequireDefault(_release);\n\nvar _make = _dereq_('./node/make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nvar _tree = _dereq_('./node/tree');\n\nvar _transitions = _dereq_('./transitions');\n\nvar _custom = _dereq_('./element/custom');\n\nvar _memory = _dereq_('./util/memory');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Used to diff the outerHTML contents of the passed element with the markup\n * contents.  Very useful for applying a global diff on the\n * `document.documentElement`.\n *\n * @param element\n * @param markup=''\n * @param options={}\n */\nfunction outerHTML(element) {\n  var markup = arguments.length <= 1 || arguments[1] === undefined ? '' : arguments[1];\n  var options = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n  options.inner = false;\n  (0, _patch2.default)(element, markup, options);\n}\n\n/**\n * Used to diff the innerHTML contents of the passed element with the markup\n * contents.  This is useful with libraries like Backbone that render Views\n * into element container.\n *\n * @param element\n * @param markup=''\n * @param options={}\n */\nfunction innerHTML(element) {\n  var markup = arguments.length <= 1 || arguments[1] === undefined ? '' : arguments[1];\n  var options = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n  options.inner = true;\n  (0, _patch2.default)(element, markup, options);\n}\n\n/**\n * Used to diff two elements.  The `inner` Boolean property can be specified in\n * the options to set innerHTML\\outerHTML behavior.  By default it is\n * outerHTML.\n *\n * @param element\n * @param newElement\n * @param options={}\n */\nfunction element(element, newElement) {\n  var options = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n  (0, _patch2.default)(element, newElement, options);\n}\n\n/**\n * Releases the worker and memory allocated to this element. Useful for\n * cleaning up components when removed in tests and applications.\n *\n * @param element\n */\nfunction release(element) {\n  (0, _release2.default)(element);\n}\n\n// Store a reference to the real `registerElement` method if it exists.\nvar realRegisterElement = document.registerElement;\n\n/**\n * Register's a constructor with an element to provide lifecycle events.\n *\n * @param tagName\n * @param constructor\n */\nfunction registerElement(tagName, constructor) {\n  // Upgrade simple objects to inherit from HTMLElement and be usable in a real\n  // implementation.\n  var normalized = typeof constructor === 'function' ? constructor : null;\n\n  // If this is not a valid constructor, create one.\n  if (normalized === null) {\n    normalized = function HTMLElement() {};\n    normalized.__proto__ = constructor;\n    normalized.prototype = constructor.prototype || constructor;\n    normalized.prototype.__proto__ = HTMLElement.prototype;\n  }\n\n  // If the native web component specification is loaded, use that instead.\n  if (realRegisterElement) {\n    // Still store the reference internally, since we use it to circumvent the\n    // `is` attribute bug.\n    _custom.components[tagName] = normalized;\n    return realRegisterElement.call(document, tagName, normalized);\n  }\n\n  // If the element has already been registered, raise an error.\n  if (tagName in _custom.components) {\n    throw new _errors.DOMException('\\n      Failed to execute \\'registerElement\\' on \\'Document\\': Registration failed\\n      for type \\'' + tagName + '\\'. A type with that name is already registered.\\n    ');\n  }\n\n  // Assign the custom element reference to the constructor.\n  _custom.components[tagName] = normalized;\n}\n\n/**\n * Adds a global transition listener.  With many elements this could be an\n * expensive operation, so try to limit the amount of listeners added if you're\n * concerned about performance.\n *\n * Since the callback triggers with various elements, most of which you\n * probably don't care about, you'll want to filter.  A good way of filtering\n * is to use the DOM `matches` method.  It's fairly well supported\n * (http://caniuse.com/#feat=matchesselector) and may suit many projects.  If\n * you need backwards compatibility, consider using jQuery's `is`.\n *\n * You can do fun, highly specific, filters:\n *\n * addTransitionState('attached', function(element) {\n *   // Fade in the main container after it's added.\n *   if (element.matches('body main.container')) {\n *     $(element).stop(true, true).fadeIn();\n *   }\n * });\n *\n * @param state - String name that matches what's available in the\n * documentation above.\n * @param callback - Function to receive the matching elements.\n */\nfunction addTransitionState(state, callback) {\n  if (!state) {\n    throw new _errors.TransitionStateError('Missing transition state name');\n  }\n\n  if (!callback) {\n    throw new _errors.TransitionStateError('Missing transition state callback');\n  }\n\n  // Not a valid state name.\n  if (Object.keys(_transitions.states).indexOf(state) === -1) {\n    throw new _errors.TransitionStateError('Invalid state name: ' + state);\n  }\n\n  _transitions.states[state].push(callback);\n}\n\n/**\n * Removes a global transition listener.\n *\n * When invoked with no arguments, this method will remove all transition\n * callbacks.  When invoked with the name argument it will remove all\n * transition state callbacks matching the name, and so on for the callback.\n *\n * @param state - String name that matches what's available in the\n * documentation above.\n * @param callback - Function to receive the matching elements.\n */\nfunction removeTransitionState(state, callback) {\n  if (!callback && state) {\n    _transitions.states[state].length = 0;\n  } else if (state && callback) {\n    // Not a valid state name.\n    if (Object.keys(_transitions.states).indexOf(state) === -1) {\n      throw new _errors.TransitionStateError('Invalid state name ' + state);\n    }\n\n    var index = _transitions.states[state].indexOf(callback);\n    _transitions.states[state].splice(index, 1);\n  } else {\n    for (var _state in _transitions.states) {\n      _transitions.states[_state].length = 0;\n    }\n  }\n}\n\n/**\n * By calling this function your browser environment is enhanced globally. This\n * project would love to hit the standards track and allow all developers to\n * benefit from the performance gains of DOM diffing.\n */\nfunction enableProllyfill() {\n  // Exposes the `TransitionStateError` constructor globally so that developers\n  // can instanceof check exception errors.\n  Object.defineProperty(window, 'TransitionStateError', {\n    configurable: true,\n\n    value: _errors.TransitionStateError\n  });\n\n  // Allows a developer to add transition state callbacks.\n  Object.defineProperty(document, 'addTransitionState', {\n    configurable: true,\n\n    value: function value(state, callback) {\n      addTransitionState(state, callback);\n    }\n  });\n\n  // Allows a developer to remove transition state callbacks.\n  Object.defineProperty(document, 'removeTransitionState', {\n    configurable: true,\n\n    value: function value(state, callback) {\n      removeTransitionState(state, callback);\n    }\n  });\n\n  // Exposes the API into the Element, ShadowDOM, and DocumentFragment\n  // constructors.\n  [typeof Element !== 'undefined' ? Element : undefined, typeof HTMLElement !== 'undefined' ? HTMLElement : undefined, typeof ShadowRoot !== 'undefined' ? ShadowRoot : undefined, typeof DocumentFragment !== 'undefined' ? DocumentFragment : undefined].filter(Boolean).forEach(function (Ctor) {\n    Object.defineProperty(Ctor.prototype, 'diffInnerHTML', {\n      configurable: true,\n\n      set: function set(newHTML) {\n        innerHTML(this, newHTML);\n      }\n    });\n\n    // Allows a developer to set the `outerHTML` of an element.\n    Object.defineProperty(Ctor.prototype, 'diffOuterHTML', {\n      configurable: true,\n\n      set: function set(newHTML) {\n        outerHTML(this, newHTML);\n      }\n    });\n\n    // Allows a developer to diff the current element with a new element.\n    Object.defineProperty(Ctor.prototype, 'diffElement', {\n      configurable: true,\n\n      value: function value(newElement, options) {\n        element(this, newElement, options);\n      }\n    });\n\n    // Releases the retained memory and worker instance.\n    Object.defineProperty(Ctor.prototype, 'diffRelease', {\n      configurable: true,\n\n      value: function value() {\n        (0, _release2.default)(this);\n      }\n    });\n  });\n\n  // Polyfill in the `registerElement` method if it doesn't already exist. This\n  // requires patching `createElement` as well to ensure that the proper proto\n  // chain exists.\n  Object.defineProperty(document, 'registerElement', {\n    configurable: true,\n\n    value: function value(tagName, component) {\n      registerElement(tagName, component);\n    }\n  });\n\n  // If HTMLElement is an object, rejigger it to work like a function so that\n  // it can be extended. Specifically affects IE and Safari.\n  Object.getOwnPropertyNames(window).filter(function (key) {\n    return key.indexOf('HTML') === 0 && _typeof(window[key]) === 'object';\n  }).forEach(function (key) {\n    // Fall back to the Element constructor if the HTMLElement does not exist.\n    var realElement = window[key];\n\n    // If there is no `__proto__` available, add one to the prototype.\n    if (!realElement.__proto__) {\n      var copy = {\n        set: function set(val) {\n          val = Object.keys(val).length ? val : Object.getPrototypeOf(val);\n\n          for (var _key in val) {\n            if (val.hasOwnProperty(_key)) {\n              this[_key] = val[_key];\n            }\n          }\n        }\n      };\n\n      Object.defineProperty(realElement, '__proto__', copy);\n      Object.defineProperty(realElement.prototype, '__proto__', copy);\n    }\n\n    var Element = new Function('return function ' + key + '() {};')();\n    Element.prototype = Object.create(realElement.prototype);\n    Element.__proto__ = realElement;\n\n    // Ensure that the global Element matches the HTMLElement.\n    window[key] = Element;\n  });\n\n  /**\n   * Will automatically activate any components found in the page automatically\n   * after calling `enableProllyfill`. This is useful to simulate a real-world\n   * usage of Custom Elements.\n   */\n  var activateComponents = function activateComponents() {\n    var documentElement = document.documentElement;\n    var bufferSet = false;\n\n    // If this element is already rendering, add this new render request into\n    // the buffer queue. Check and see if any element is currently rendering,\n    // can only do one at a time.\n    _tree.TreeCache.forEach(function iterateTreeCache(elementMeta, element) {\n      if (elementMeta.isRendering) {\n        bufferSet = true;\n      }\n    });\n\n    // Short circuit the rest of this render.\n    if (bufferSet) {\n      // Remove the load event listener, since it's complete.\n      return window.removeEventListener('load', activateComponents);\n    }\n\n    var descriptor = (0, _make2.default)(documentElement);\n\n    // After the initial render, clean up the resources, no point in lingering.\n    documentElement.addEventListener('renderComplete', function render() {\n      var elementMeta = _tree.TreeCache.get(documentElement) || {};\n\n      // Release resources allocated to the element.\n      if (!elementMeta.isRendering) {\n\n        // Unprotect after the activation is complete.\n        (0, _memory.unprotectElement)(descriptor, _make2.default);\n        documentElement.diffRelease(documentElement);\n      }\n\n      // Remove this event listener.\n      documentElement.removeEventListener('renderComplete', render);\n    });\n\n    // Protect the documentElement before applying the changes.\n    (0, _memory.protectElement)(descriptor);\n\n    // Diff the entire document on activation of the prollyfill.\n    documentElement.diffOuterHTML = documentElement.outerHTML;\n\n    // Remove the load event listener, since it's complete.\n    window.removeEventListener('load', activateComponents);\n  };\n\n  // If the document has already loaded, immediately activate the components.\n  if (document.readyState === 'complete') {\n    activateComponents();\n  } else {\n    // This section will automatically parse out your entire page to ensure all\n    // custom elements are hooked into.\n    window.addEventListener('load', activateComponents);\n  }\n}\n\n},{\"./element/custom\":1,\"./errors\":4,\"./node/make\":6,\"./node/patch\":7,\"./node/release\":8,\"./node/tree\":10,\"./transitions\":13,\"./util/memory\":15}],6:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = make;\n\nvar _pools2 = _dereq_('../util/pools');\n\nvar _custom = _dereq_('../element/custom');\n\nvar pools = _pools2.pools;\nvar empty = {};\n\n// Cache created nodes inside this object.\nmake.nodes = {};\n\n/**\n * Converts a live node into a virtual node.\n *\n * @param node\n * @return\n */\nfunction make(node) {\n  var nodeType = node.nodeType;\n\n  // Whitelist: Elements, TextNodes, and Shadow Root.\n  if (nodeType !== 1 && nodeType !== 3 && nodeType !== 11) {\n    return false;\n  }\n\n  // Virtual representation of a node, containing only the data we wish to\n  // diff and patch.\n  var entry = pools.elementObject.get();\n\n  // Associate this newly allocated uuid with this Node.\n  make.nodes[entry.uuid] = node;\n\n  // Set a lowercased (normalized) version of the element's nodeName.\n  entry.nodeName = node.nodeName.toLowerCase();\n\n  // If the element is a text node set the nodeValue.\n  if (nodeType === 3) {\n    entry.nodeValue = node.textContent;\n  } else {\n    entry.nodeValue = '';\n  }\n\n  entry.childNodes.length = 0;\n  entry.attributes.length = 0;\n\n  // Collect attributes.\n  var attributes = node.attributes;\n\n  // If the element has no attributes, skip over.\n  if (attributes) {\n    var attributesLength = attributes.length;\n\n    if (attributesLength) {\n      for (var i = 0; i < attributesLength; i++) {\n        var attr = pools.attributeObject.get();\n\n        attr.name = attributes[i].name;\n        attr.value = attributes[i].value;\n\n        entry.attributes[entry.attributes.length] = attr;\n      }\n    }\n  }\n\n  // Collect childNodes.\n  var childNodes = node.childNodes ? node.childNodes : [];\n  var childNodesLength = childNodes.length;\n\n  // If the element has child nodes, convert them all to virtual nodes.\n  if (nodeType !== 3 && childNodesLength) {\n    for (var _i = 0; _i < childNodesLength; _i++) {\n      var newNode = make(childNodes[_i]);\n\n      if (newNode) {\n        entry.childNodes[entry.childNodes.length] = newNode;\n      }\n    }\n  }\n\n  // Prune out whitespace from between HTML tags in markup.\n  if (entry.nodeName === 'html') {\n    entry.childNodes = entry.childNodes.filter(function (el) {\n      return el.nodeName === 'head' || el.nodeName === 'body';\n    });\n  }\n\n  // Reset the prototype chain for this element. Upgrade will return `true`\n  // if the element was upgraded for the first time. This is useful so we\n  // don't end up in a loop when working with the same element.\n  (0, _custom.upgrade)(entry.nodeName, node, entry, true);\n\n  return entry;\n}\n\n},{\"../element/custom\":1,\"../util/pools\":17}],7:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = patchNode;\n\nvar _create = _dereq_('../worker/create');\n\nvar _memory = _dereq_('../util/memory');\n\nvar _parser = _dereq_('../util/parser');\n\nvar _render = _dereq_('../util/render');\n\nvar _make = _dereq_('./make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nvar _process = _dereq_('../patches/process');\n\nvar _process2 = _interopRequireDefault(_process);\n\nvar _sync = _dereq_('./sync');\n\nvar _sync2 = _interopRequireDefault(_sync);\n\nvar _tree = _dereq_('./tree');\n\nvar _pools = _dereq_('../util/pools');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Patches an element's DOM to match that of the passed markup.\n *\n * @param element\n * @param newHTML\n */\nfunction patchNode(element, newHTML, options) {\n  // Ensure that the document disable worker is always picked up.\n  if (typeof options.enableWorker !== 'boolean') {\n    options.enableWorker = document.ENABLE_WORKER;\n  }\n\n  // The element meta object is a location to associate metadata with the\n  // currently rendering element. This prevents attaching properties to the\n  // instance itself.\n  var elementMeta = _tree.TreeCache.get(element) || {};\n\n  // Last options used.\n  elementMeta.options = options;\n\n  // Always ensure the most up-to-date meta object is stored.\n  _tree.TreeCache.set(element, elementMeta);\n\n  var bufferSet = false;\n  var isInner = options.inner;\n  var previousMarkup = elementMeta.previousMarkup;\n\n  // If this element is already rendering, add this new render request into the\n  // buffer queue. Check and see if any element is currently rendering, can\n  // only do one at a time.\n  _tree.TreeCache.forEach(function iterateTreeCache(_elementMeta, _element) {\n    if (_elementMeta.isRendering) {\n      elementMeta.renderBuffer = { element: element, newHTML: newHTML, options: options };\n      bufferSet = true;\n    }\n  });\n\n  // Short circuit the rest of this render.\n  if (bufferSet) {\n    return;\n  }\n\n  var sameInnerHTML = isInner ? previousMarkup === element.innerHTML : true;\n  var sameOuterHTML = !isInner ? previousMarkup === element.outerHTML : true;\n  var sameTextContent = elementMeta._textContent === element.textContent;\n\n  // If the contents haven't changed, abort, since there is no point in\n  // continuing.\n  if (elementMeta.newHTML === newHTML) {\n    return;\n  }\n\n  // Associate the last markup rendered with this element.\n  elementMeta.newHTML = newHTML;\n\n  // Start with worker being a falsy value.\n  var worker = null;\n\n  // If we can use a worker and the user wants one, try and create it.\n  if (options.enableWorker && _create.hasWorker) {\n    // Create a worker for this element.\n    worker = elementMeta.worker = elementMeta.worker || (0, _create.create)();\n  }\n\n  var rebuildTree = function rebuildTree() {\n    var oldTree = elementMeta.oldTree;\n\n    if (oldTree) {\n      (0, _memory.unprotectElement)(oldTree, _make2.default);\n      (0, _memory.cleanMemory)(_make2.default);\n    }\n\n    elementMeta.oldTree = (0, _memory.protectElement)((0, _make2.default)(element));\n    elementMeta.updateWorkerTree = true;\n  };\n\n  // The last render was done via Worker, but now we're rendering in the UI\n  // thread. This is very uncommon, but we need to ensure trees stay in sync.\n  if (elementMeta.renderedViaWorker === true && !options.enableWorker) {\n    rebuildTree();\n  }\n\n  if (!sameInnerHTML || !sameOuterHTML || !sameTextContent) {\n    rebuildTree();\n  }\n\n  // Will want to ensure that the first render went through, the worker can\n  // take a bit to startup and we want to show changes as soon as possible.\n  if (options.enableWorker && _create.hasWorker && worker) {\n    // Set a render lock as to not flood the worker.\n    elementMeta.isRendering = true;\n    elementMeta.renderedViaWorker = true;\n    elementMeta.workerCache = elementMeta.workerCache || [];\n\n    // Attach all properties here to transport.\n    var transferObject = {};\n\n    // This should only occur once, or whenever the markup changes externally\n    // to diffHTML.\n    if (!elementMeta.hasWorkerRendered || elementMeta.updateWorkerTree) {\n      transferObject.oldTree = elementMeta.oldTree;\n      elementMeta.updateWorkerTree = false;\n    }\n\n    // Wait for the worker to finish processing and then apply the patchset.\n    worker.onmessage = function onmessage(ev) {\n      var wrapRender = function wrapRender(cb) {\n        return function () {\n          elementMeta.hasWorkerRendered = true;\n          cb();\n        };\n      };\n      var invokeRender = wrapRender((0, _render.completeRender)(element, elementMeta));\n\n      // Wait until all promises have resolved, before finishing up the patch\n      // cycle.  Process the data immediately and wait until all transition\n      // callbacks have completed.\n      var promises = (0, _process2.default)(element, ev.data.patches);\n\n      // Operate synchronously unless opted into a Promise-chain.\n      if (promises.length) {\n        Promise.all(promises).then(invokeRender, function (ex) {\n          return console.log(ex);\n        });\n      } else {\n        invokeRender();\n      }\n    };\n\n    if (typeof newHTML !== 'string') {\n      transferObject.newTree = (0, _make2.default)(newHTML);\n\n      // Transfer this buffer to the worker, which will take over and process\n      // the markup.\n      worker.postMessage(transferObject);\n\n      return;\n    }\n\n    // Let the browser copy the HTML into the worker, converting to a\n    // transferable object is too expensive.\n    transferObject.newHTML = newHTML;\n\n    // Add properties to send to worker.\n    transferObject.isInner = options.inner;\n\n    // Transfer this buffer to the worker, which will take over and process the\n    // markup.\n    worker.postMessage(transferObject);\n  } else {\n    if (elementMeta.renderedViaWorker && elementMeta.oldTree) {\n      rebuildTree();\n    }\n\n    if (elementMeta.workerCache) {\n      elementMeta.workerCache.forEach(function (x) {\n        return (0, _memory.unprotectElement)(x, _make2.default);\n      });\n      delete elementMeta.workerCache;\n    }\n\n    // We're rendering in the UI thread.\n    elementMeta.isRendering = true;\n\n    // Whenever we render in the UI-thread, ensure that the Worker gets a\n    // refreshed copy of the `oldTree`.\n    elementMeta.updateWorkerTree = true;\n\n    var newTree = null;\n\n    if (typeof newHTML === 'string') {\n      newTree = (0, _parser.parseHTML)(newHTML, options.inner);\n    } else {\n      newTree = (0, _make2.default)(newHTML);\n    }\n\n    if (options.inner) {\n      var childNodes = Array.isArray(newTree) ? newTree : [newTree];\n\n      newTree = {\n        childNodes: childNodes,\n        attributes: elementMeta.oldTree.attributes,\n        uuid: elementMeta.oldTree.uuid,\n        nodeName: elementMeta.oldTree.nodeName,\n        nodeValue: elementMeta.oldTree.nodeValue\n      };\n    }\n\n    // Synchronize the tree.\n    var patches = (0, _sync2.default)(elementMeta.oldTree, newTree);\n    var invokeRender = (0, _render.completeRender)(element, elementMeta);\n\n    // Process the data immediately and wait until all transition callbacks\n    // have completed.\n    var promises = (0, _process2.default)(element, patches);\n\n    // Operate synchronously unless opted into a Promise-chain.\n    if (promises.length) {\n      Promise.all(promises).then(invokeRender, function (ex) {\n        return console.log(ex);\n      });\n    } else {\n      invokeRender();\n    }\n  }\n}\n\n},{\"../patches/process\":11,\"../util/memory\":15,\"../util/parser\":16,\"../util/pools\":17,\"../util/render\":18,\"../worker/create\":20,\"./make\":6,\"./sync\":9,\"./tree\":10}],8:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = releaseNode;\n\nvar _tree = _dereq_('./tree');\n\nvar _make = _dereq_('./make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nvar _memory = _dereq_('../util/memory');\n\nvar _pools = _dereq_('../util/pools');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Release's the allocated objects and recycles internal memory.\n *\n * @param element\n */\nfunction releaseNode(element) {\n  var elementMeta = _tree.TreeCache.get(element);\n\n  // Do not remove an element that is in process of rendering. User intentions\n  // come first, so if we are cleaning up an element being used by another part\n  // of the code, keep it alive.\n  if (elementMeta) {\n    // If there is a worker associated with this element, then kill it.\n    if (elementMeta.worker) {\n      elementMeta.worker.terminate();\n      delete elementMeta.worker;\n    }\n\n    // If there was a tree set up, recycle the memory allocated for it.\n    if (elementMeta.oldTree) {\n      (0, _memory.unprotectElement)(elementMeta.oldTree, _make2.default);\n    }\n\n    if (elementMeta.workerCache) {\n      elementMeta.workerCache.forEach(function (x) {\n        return (0, _memory.unprotectElement)(x, _make2.default);\n      });\n      delete elementMeta.workerCache;\n    }\n\n    // Remove this element's meta object from the cache.\n    _tree.TreeCache.delete(element);\n  }\n\n  (0, _memory.cleanMemory)(_make2.default);\n}\n\n},{\"../util/memory\":15,\"../util/pools\":17,\"./make\":6,\"./tree\":10}],9:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CHANGE_TEXT = exports.MODIFY_ATTRIBUTE = exports.MODIFY_ELEMENT = exports.REPLACE_ENTIRE_ELEMENT = exports.REMOVE_ENTIRE_ELEMENT = exports.REMOVE_ELEMENT_CHILDREN = undefined;\nexports.default = sync;\n\nvar _pools2 = _dereq_('../util/pools');\n\nvar pools = _pools2.pools;\n\nvar slice = Array.prototype.slice;\nvar filter = Array.prototype.filter;\n\n// Patch actions.\nvar REMOVE_ELEMENT_CHILDREN = exports.REMOVE_ELEMENT_CHILDREN = -2;\nvar REMOVE_ENTIRE_ELEMENT = exports.REMOVE_ENTIRE_ELEMENT = -1;\nvar REPLACE_ENTIRE_ELEMENT = exports.REPLACE_ENTIRE_ELEMENT = 0;\nvar MODIFY_ELEMENT = exports.MODIFY_ELEMENT = 1;\nvar MODIFY_ATTRIBUTE = exports.MODIFY_ATTRIBUTE = 2;\nvar CHANGE_TEXT = exports.CHANGE_TEXT = 3;\n\n/**\n * Synchronizes changes from the newTree into the oldTree.\n *\n * @param oldTree\n * @param newTree\n * @param patches - optional\n */\nfunction sync(oldTree, newTree, patches) {\n  patches = patches || [];\n\n  if (!Array.isArray(patches)) {\n    throw new Error('Missing Array to sync patches into');\n  }\n\n  if (!oldTree) {\n    throw new Error('Missing existing tree to sync');\n  }\n\n  var oldNodeValue = oldTree.nodeValue;\n  var oldChildNodes = oldTree.childNodes;\n  var oldChildNodesLength = oldChildNodes ? oldChildNodes.length : 0;\n  var oldElement = oldTree.uuid;\n  var oldNodeName = oldTree.nodeName;\n  var oldIsTextNode = oldNodeName === '#text';\n\n  if (!newTree) {\n    var removed = [oldTree].concat(oldChildNodes.splice(0, oldChildNodesLength));\n\n    patches.push({\n      __do__: REMOVE_ENTIRE_ELEMENT,\n      element: oldTree,\n      toRemove: removed\n    });\n\n    return patches;\n  }\n\n  var nodeValue = newTree.nodeValue;\n  var childNodes = newTree.childNodes;\n  var childNodesLength = childNodes ? childNodes.length : 0;\n  var newElement = newTree.uuid;\n  var nodeName = newTree.nodeName;\n  var newIsTextNode = nodeName === '#text';\n\n  // If the element we're replacing is totally different from the previous\n  // replace the entire element, don't bother investigating children.\n  if (oldTree.nodeName !== newTree.nodeName) {\n    patches.push({\n      __do__: REPLACE_ENTIRE_ELEMENT,\n      old: oldTree,\n      new: newTree\n    });\n\n    return patches;\n  }\n\n  // If the top level nodeValue has changed we should reflect it.\n  if (oldIsTextNode && newIsTextNode && oldNodeValue !== nodeValue) {\n    patches.push({\n      __do__: CHANGE_TEXT,\n      element: oldTree,\n      value: newTree.nodeValue\n    });\n\n    oldTree.nodeValue = newTree.nodeValue;\n\n    return;\n  }\n\n  // Most common additive elements.\n  if (childNodesLength > oldChildNodesLength) {\n    // Store elements in a DocumentFragment to increase performance and be\n    // generally simplier to work with.\n    var fragment = [];\n\n    for (var i = oldChildNodesLength; i < childNodesLength; i++) {\n      // Internally add to the tree.\n      oldChildNodes.push(childNodes[i]);\n\n      // Add to the document fragment.\n      fragment.push(childNodes[i]);\n    }\n\n    oldChildNodesLength = oldChildNodes.length;\n\n    // Assign the fragment to the patches to be injected.\n    patches.push({\n      __do__: MODIFY_ELEMENT,\n      element: oldTree,\n      fragment: fragment\n    });\n  }\n\n  // Remove these elements.\n  if (oldChildNodesLength > childNodesLength) {\n    // For now just splice out the end items.\n    var diff = oldChildNodesLength - childNodesLength;\n    var toRemove = oldChildNodes.splice(oldChildNodesLength - diff, diff);\n\n    oldChildNodesLength = oldChildNodes.length;\n\n    if (oldChildNodesLength === 0 && childNodesLength === 0) {\n      patches.push({\n        __do__: REMOVE_ELEMENT_CHILDREN,\n        element: oldTree,\n        toRemove: toRemove\n      });\n    } else {\n      for (var _i = 0; _i < toRemove.length; _i++) {\n        // Remove the element, this happens before the splice so that we\n        // still have access to the element.\n        patches.push({\n          __do__: MODIFY_ELEMENT,\n          old: toRemove[_i]\n        });\n      }\n    }\n  }\n\n  // Replace elements if they are different.\n  if (oldChildNodesLength >= childNodesLength) {\n    for (var _i2 = 0; _i2 < childNodesLength; _i2++) {\n      if (oldChildNodes[_i2].nodeName !== childNodes[_i2].nodeName) {\n        // Add to the patches.\n        patches.push({\n          __do__: MODIFY_ELEMENT,\n          old: oldChildNodes[_i2],\n          new: childNodes[_i2]\n        });\n\n        // Replace the internal tree's point of view of this element.\n        oldChildNodes[_i2] = childNodes[_i2];\n      } else {\n        sync(oldChildNodes[_i2], childNodes[_i2], patches);\n      }\n    }\n  }\n\n  // Synchronize attributes\n  var attributes = newTree.attributes;\n\n  if (attributes) {\n    var oldLength = oldTree.attributes.length;\n    var newLength = attributes.length;\n\n    // Start with the most common, additive.\n    if (newLength > oldLength) {\n      var toAdd = slice.call(attributes, oldLength);\n\n      for (var _i3 = 0; _i3 < toAdd.length; _i3++) {\n        var change = {\n          __do__: MODIFY_ATTRIBUTE,\n          element: oldTree,\n          name: toAdd[_i3].name,\n          value: toAdd[_i3].value\n        };\n\n        var attr = pools.attributeObject.get();\n        attr.name = toAdd[_i3].name;\n        attr.value = toAdd[_i3].value;\n\n        pools.attributeObject.protect(attr);\n\n        // Push the change object into into the virtual tree.\n        oldTree.attributes.push(attr);\n\n        // Add the change to the series of patches.\n        patches.push(change);\n      }\n    }\n\n    // Check for removals.\n    if (oldLength > newLength) {\n      var _toRemove = slice.call(oldTree.attributes, newLength);\n\n      for (var _i4 = 0; _i4 < _toRemove.length; _i4++) {\n        var _change = {\n          __do__: MODIFY_ATTRIBUTE,\n          element: oldTree,\n          name: _toRemove[_i4].name,\n          value: undefined\n        };\n\n        // Remove the attribute from the virtual node.\n        var _removed = oldTree.attributes.splice(_i4, 1);\n\n        for (var _i5 = 0; _i5 < _removed.length; _i5++) {\n          pools.attributeObject.unprotect(_removed[_i5]);\n        }\n\n        // Add the change to the series of patches.\n        patches.push(_change);\n      }\n    }\n\n    // Check for modifications.\n    var toModify = attributes;\n\n    for (var _i6 = 0; _i6 < toModify.length; _i6++) {\n      var oldAttrValue = oldTree.attributes[_i6] && oldTree.attributes[_i6].value;\n      var newAttrValue = attributes[_i6] && attributes[_i6].value;\n\n      // Only push in a change if the attribute or value changes.\n      if (oldAttrValue !== newAttrValue) {\n        var _change2 = {\n          __do__: MODIFY_ATTRIBUTE,\n          element: oldTree,\n          name: toModify[_i6].name,\n          value: toModify[_i6].value\n        };\n\n        // Replace the attribute in the virtual node.\n        var _attr = oldTree.attributes[_i6];\n        _attr.name = toModify[_i6].name;\n        _attr.value = toModify[_i6].value;\n\n        // Add the change to the series of patches.\n        patches.push(_change2);\n      }\n    }\n  }\n\n  return patches;\n}\n\n},{\"../util/pools\":17}],10:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n// Cache prebuilt trees and lookup by element.\nvar TreeCache = exports.TreeCache = new Map();\n\n},{}],11:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = process;\n\nvar _transitions = _dereq_('../transitions');\n\nvar transition = _interopRequireWildcard(_transitions);\n\nvar _pools = _dereq_('../util/pools');\n\nvar _get = _dereq_('../element/get');\n\nvar _get2 = _interopRequireDefault(_get);\n\nvar _custom = _dereq_('../element/custom');\n\nvar _make = _dereq_('../node/make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nvar _sync = _dereq_('../node/sync');\n\nvar sync = _interopRequireWildcard(_sync);\n\nvar _tree = _dereq_('../node/tree');\n\nvar _memory = _dereq_('../util/memory');\n\nvar _entities = _dereq_('../util/entities');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar blockTextElements = ['script', 'noscript', 'style', 'pre', 'template'];\n\n/**\n * Processes an array of patches.\n *\n * @param element - Element to process patchsets on.\n * @param e - Object that contains patches.\n */\nfunction process(element, patches) {\n  var elementMeta = _tree.TreeCache.get(element);\n  var promises = [];\n  var triggerTransition = transition.buildTrigger(promises);\n\n  // Trigger the attached transition state for this element and all childNodes.\n  var attached = function attached(descriptor, fragment, parentNode) {\n    (0, _memory.protectElement)(descriptor);\n\n    if (elementMeta.workerCache) {\n      elementMeta.workerCache.push(descriptor);\n    }\n\n    var el = (0, _get2.default)(descriptor).element;\n\n    // If the element added was a DOM text node or SVG text element, trigger\n    // the textChanged transition.\n    if (descriptor.nodeName === '#text') {\n      var textPromises = transition.makePromises('textChanged', [el], null, descriptor.nodeValue);\n\n      el.textContent = (0, _entities.decodeEntities)(descriptor.nodeValue);\n\n      if (parentNode) {\n        var nodeName = parentNode.nodeName.toLowerCase();\n\n        if (blockTextElements.indexOf(nodeName) > -1) {\n          parentNode.nodeValue = (0, _entities.decodeEntities)(descriptor.nodeValue);\n        }\n      }\n\n      triggerTransition('textChanged', textPromises, function (promises) {});\n    }\n\n    if (descriptor.attributes && descriptor.attributes.length) {\n      descriptor.attributes.forEach(function (attr) {\n        var attrChangePromises = transition.makePromises('attributeChanged', [el], attr.name, null, attr.value);\n\n        triggerTransition('attributeChanged', attrChangePromises, function (promises) {});\n      });\n    }\n\n    // Call all `childNodes` attached callbacks as well.\n    if (descriptor.childNodes && descriptor.childNodes.length) {\n      descriptor.childNodes.forEach(function (x) {\n        return attached(x, null, el);\n      });\n    }\n\n    // If a document fragment was specified, append the real element into it.\n    if (fragment) {\n      fragment.appendChild(el);\n    }\n\n    return el;\n  };\n\n  // Loop through all the patches and apply them.\n\n  var _loop = function _loop(i) {\n    var patch = patches[i];\n    var newEl = void 0,\n        oldEl = void 0,\n        el = void 0;\n\n    if (patch.element) {\n      var result = (0, _get2.default)(patch.element);\n      el = result.element;\n    }\n\n    if (patch.old) {\n      var _result = (0, _get2.default)(patch.old);\n      oldEl = _result.element;\n    }\n\n    if (patch.new) {\n      var _result2 = (0, _get2.default)(patch.new);\n      newEl = _result2.element;\n    }\n\n    // Empty the Node's contents. This is an optimization, since `innerHTML`\n    // will be faster than iterating over every element and manually removing.\n    if (patch.__do__ === sync.REMOVE_ELEMENT_CHILDREN) {\n      var childNodes = el.childNodes;\n      var detachPromises = transition.makePromises('detached', childNodes);\n\n      triggerTransition('detached', detachPromises, function (promises) {\n        patch.toRemove.forEach(function (x) {\n          return (0, _memory.unprotectElement)(x, _make2.default);\n        });\n        el.innerHTML = '';\n      });\n    }\n\n    // Remove the entire Node. Only does something if the Node has a parent\n    // element.\n    else if (patch.__do__ === sync.REMOVE_ENTIRE_ELEMENT) {\n        var _detachPromises = transition.makePromises('detached', [el]);\n\n        if (el.parentNode) {\n          triggerTransition('detached', _detachPromises, function (promises) {\n            el.parentNode.removeChild(el);\n            patch.toRemove.forEach(function (x) {\n              return (0, _memory.unprotectElement)(x, _make2.default);\n            });\n          });\n        } else {\n          patch.toRemove.forEach(function (x) {\n            return (0, _memory.unprotectElement)(x, _make2.default);\n          });\n        }\n      }\n\n      // Replace the entire Node.\n      else if (patch.__do__ === sync.REPLACE_ENTIRE_ELEMENT) {\n          (function () {\n            var allPromises = [];\n            var attachedPromises = transition.makePromises('attached', [newEl]);\n            var detachedPromises = transition.makePromises('detached', [oldEl]);\n            var replacedPromises = transition.makePromises('replaced', [oldEl], newEl);\n\n            // Add all the transition state promises into the main array, we'll use\n            // them all to decide when to alter the DOM.\n            triggerTransition('detached', detachedPromises, function (promises) {\n              allPromises.push.apply(allPromises, promises);\n            });\n\n            triggerTransition('attached', attachedPromises, function (promises) {\n              allPromises.push.apply(allPromises, promises);\n              attached(patch.new, null, newEl);\n            });\n\n            triggerTransition('replaced', replacedPromises, function (promises) {\n              allPromises.push.apply(allPromises, promises);\n            });\n\n            (0, _memory.unprotectElement)(patch.old, _make2.default);\n\n            // Reset the tree cache.\n            _tree.TreeCache.set(newEl, {\n              oldTree: patch.new,\n              element: newEl\n            });\n\n            // Once all the promises have completed, invoke the action, if no\n            // promises were added, this will be a synchronous operation.\n            if (allPromises.length) {\n              Promise.all(allPromises).then(function replaceEntireElement() {\n                if (!oldEl.parentNode) {\n                  (0, _memory.unprotectElement)(patch.new, _make2.default);\n\n                  throw new Error('Can\\'t replace without parent, is this the ' + 'document root?');\n                }\n\n                oldEl.parentNode.replaceChild(newEl, oldEl);\n              }, function (ex) {\n                return console.log(ex);\n              });\n            } else {\n              if (!oldEl.parentNode) {\n                (0, _memory.unprotectElement)(patch.new, _make2.default);\n\n                throw new Error('Can\\'t replace without parent, is this the ' + 'document root?');\n              }\n\n              oldEl.parentNode.replaceChild(newEl, oldEl);\n            }\n          })();\n        }\n\n        // Node manip.\n        else if (patch.__do__ === sync.MODIFY_ELEMENT) {\n            // Add.\n            if (el && patch.fragment && !oldEl) {\n              (function () {\n                var fragment = document.createDocumentFragment();\n\n                // Loop over every element to be added and process the descriptor\n                // into the real element and append into the DOM fragment.\n                toAttach = patch.fragment.map(function (el) {\n                  return attached(el, fragment, el);\n                });\n\n                // Turn elements into childNodes of the patch element.\n\n                el.appendChild(fragment);\n\n                // Trigger transitions.\n                var makeAttached = transition.makePromises('attached', toAttach);\n                triggerTransition('attached', makeAttached);\n              })();\n            }\n\n            // Remove.\n            else if (oldEl && !newEl) {\n                if (!oldEl.parentNode) {\n                  (0, _memory.unprotectElement)(patch.old, _make2.default);\n\n                  throw new Error('Can\\'t remove without parent, is this the ' + 'document root?');\n                }\n\n                var makeDetached = transition.makePromises('detached', [oldEl]);\n\n                triggerTransition('detached', makeDetached, function () {\n                  // And then empty out the entire contents.\n                  oldEl.innerHTML = '';\n\n                  if (oldEl.parentNode) {\n                    oldEl.parentNode.removeChild(oldEl);\n                  }\n\n                  (0, _memory.unprotectElement)(patch.old, _make2.default);\n                });\n              }\n\n              // Replace.\n              else if (oldEl && newEl) {\n                  (function () {\n                    if (!oldEl.parentNode) {\n                      (0, _memory.unprotectElement)(patch.old, _make2.default);\n                      (0, _memory.unprotectElement)(patch.new, _make2.default);\n\n                      throw new Error('Can\\'t replace without parent, is this the ' + 'document root?');\n                    }\n\n                    // Append the element first, before doing the replacement.\n                    if (oldEl.nextSibling) {\n                      oldEl.parentNode.insertBefore(newEl, oldEl.nextSibling);\n                    } else {\n                      oldEl.parentNode.appendChild(newEl);\n                    }\n\n                    // Removed state for transitions API.\n                    var allPromises = [];\n                    var attachPromises = transition.makePromises('attached', [newEl]);\n                    var detachPromises = transition.makePromises('detached', [oldEl]);\n                    var replacePromises = transition.makePromises('replaced', [oldEl], newEl);\n\n                    triggerTransition('detached', detachPromises, function (promises) {\n                      allPromises.push.apply(allPromises, promises);\n                    });\n\n                    triggerTransition('attached', attachPromises, function (promises) {\n                      allPromises.push.apply(allPromises, promises);\n                      attached(patch.new);\n                    });\n\n                    triggerTransition('replaced', replacePromises, function (promises) {\n                      allPromises.push.apply(allPromises, promises);\n                    });\n\n                    // Once all the promises have completed, invoke the action, if no\n                    // promises were added, this will be a synchronous operation.\n                    if (allPromises.length) {\n                      Promise.all(allPromises).then(function replaceElement() {\n                        oldEl.parentNode.replaceChild(newEl, oldEl);\n                        (0, _memory.unprotectElement)(patch.old, _make2.default);\n\n                        (0, _memory.protectElement)(patch.new);\n\n                        if (elementMeta.workerCache) {\n                          elementMeta.workerCache.push(patch.new);\n                        }\n                      }, function (ex) {\n                        return console.log(ex);\n                      });\n                    } else {\n                      if (!oldEl.parentNode) {\n                        (0, _memory.unprotectElement)(patch.old, _make2.default);\n                        (0, _memory.unprotectElement)(patch.new, _make2.default);\n\n                        throw new Error('Can\\'t replace without parent, is this the ' + 'document root?');\n                      }\n\n                      oldEl.parentNode.replaceChild(newEl, oldEl);\n                      (0, _memory.unprotectElement)(patch.old, _make2.default);\n                      (0, _memory.protectElement)(patch.new);\n\n                      if (elementMeta.workerCache) {\n                        elementMeta.workerCache.push(patch.new);\n                      }\n                    }\n                  })();\n                }\n          }\n\n          // Attribute manipulation.\n          else if (patch.__do__ === sync.MODIFY_ATTRIBUTE) {\n              var attrChangePromises = transition.makePromises('attributeChanged', [el], patch.name, el.getAttribute(patch.name), patch.value);\n\n              triggerTransition('attributeChanged', attrChangePromises, function (promises) {\n                // Remove.\n                if (patch.value === undefined) {\n                  el.removeAttribute(patch.name);\n\n                  if (patch.name === 'checked') {\n                    el.checked = false;\n                  }\n                }\n                // Change.\n                else {\n                    el.setAttribute(patch.name, patch.value);\n\n                    // If an `is` attribute was set, we should upgrade it.\n                    (0, _custom.upgrade)(patch.element.nodeName, el, patch.element);\n\n                    // Support live updating of the value attribute.\n                    if (patch.name === 'value' || patch.name === 'checked') {\n                      el[patch.name] = patch.value;\n                    }\n                  }\n              });\n            }\n\n            // Text node manipulation.\n            else if (patch.__do__ === sync.CHANGE_TEXT) {\n                var textChangePromises = transition.makePromises('textChanged', [el], el.nodeValue, patch.value);\n\n                triggerTransition('textChanged', textChangePromises, function (promises) {\n                  patch.element.nodeValue = (0, _entities.decodeEntities)(patch.value);\n                  el.nodeValue = patch.element.nodeValue;\n\n                  if (el.parentNode) {\n                    var nodeName = el.parentNode.nodeName.toLowerCase();\n\n                    if (blockTextElements.indexOf(nodeName) > -1) {\n                      el.parentNode.nodeValue = patch.element.nodeValue;\n                    }\n                  }\n                });\n              }\n  };\n\n  for (var i = 0; i < patches.length; i++) {\n    var toAttach;\n\n    _loop(i);\n  }\n\n  // Return the Promises that were allocated so that rendering can be blocked\n  // until they resolve.\n  return promises.filter(Boolean);\n}\n\n},{\"../element/custom\":1,\"../element/get\":2,\"../node/make\":6,\"../node/sync\":9,\"../node/tree\":10,\"../transitions\":13,\"../util/entities\":14,\"../util/memory\":15,\"../util/pools\":17}],12:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n// List of SVG elements.\nvar elements = exports.elements = ['altGlyph', 'altGlyphDef', 'altGlyphItem', 'animate', 'animateColor', 'animateMotion', 'animateTransform', 'circle', 'clipPath', 'color-profile', 'cursor', 'defs', 'desc', 'ellipse', 'feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence', 'filter', 'font', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignObject', 'g', 'glyph', 'glyphRef', 'hkern', 'image', 'line', 'linearGradient', 'marker', 'mask', 'metadata', 'missing-glyph', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialGradient', 'rect', 'set', 'stop', 'svg', 'switch', 'symbol', 'text', 'textPath', 'tref', 'tspan', 'use', 'view', 'vkern'];\n\n// Namespace.\nvar namespace = exports.namespace = 'http://www.w3.org/2000/svg';\n\n},{}],13:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.states = undefined;\nexports.buildTrigger = buildTrigger;\nexports.makePromises = makePromises;\n\nvar _custom = _dereq_('./element/custom');\n\nvar _make = _dereq_('./node/make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar slice = Array.prototype.slice;\nvar forEach = Array.prototype.forEach;\nvar concat = Array.prototype.concat;\nvar empty = { prototype: {} };\n\n/**\n * Contains arrays to store transition callbacks.\n *\n * attached\n * --------\n *\n * For when elements come into the DOM. The callback triggers immediately after\n * the element enters the DOM. It is called with the element as the only\n * argument.\n *\n * detached\n * --------\n *\n * For when elements are removed from the DOM. The callback triggers just\n * before the element leaves the DOM. It is called with the element as the only\n * argument.\n *\n * replaced\n * --------\n *\n * For when elements are replaced in the DOM. The callback triggers after the\n * new element enters the DOM, and before the old element leaves. It is called\n * with old and new elements as arguments, in that order.\n *\n * attributeChanged\n * ----------------\n *\n * Triggered when an element's attribute has changed. The callback triggers\n * after the attribute has changed in the DOM. It is called with the element,\n * the attribute name, old value, and current value.\n *\n * textChanged\n * -----------\n *\n * Triggered when an element's `textContent` chnages. The callback triggers\n * after the textContent has changed in the DOM. It is called with the element,\n * the old value, and current value.\n */\nvar states = exports.states = {\n  attached: [],\n  detached: [],\n  replaced: [],\n  attributeChanged: [],\n  textChanged: []\n};\n\n// Define the custom signatures necessary for the loop to fill in the \"magic\"\n// methods that process the transitions consistently.\nvar fnSignatures = {\n  attached: {\n    mapFn: function mapFn(el) {\n      return function (cb) {\n        return cb(el);\n      };\n    },\n    customElementsFn: function customElementsFn(el) {\n      return function (cb) {\n        return cb.call(el);\n      };\n    }\n  },\n\n  detached: {\n    mapFn: function mapFn(el) {\n      return function (cb) {\n        return cb(el);\n      };\n    },\n    customElementsFn: function customElementsFn(el) {\n      return function (cb) {\n        return cb.call(el);\n      };\n    }\n  },\n\n  replaced: {\n    mapFn: function mapFn(oldEl, newEl) {\n      return function (cb) {\n        return cb(oldEl, newEl);\n      };\n    }\n  },\n\n  attributeChanged: {\n    mapFn: function mapFn(el, name, oldVal, newVal) {\n      return function (cb) {\n        return cb(el, name, oldVal, newVal);\n      };\n    },\n    customElementsFn: function customElementsFn(el, name, oldVal, newVal) {\n      return function (cb) {\n        return cb.call(el, name, oldVal, newVal);\n      };\n    }\n  },\n\n  textChanged: {\n    mapFn: function mapFn(el, oldVal, newVal) {\n      return function (cb) {\n        return cb(el, oldVal, newVal);\n      };\n    },\n    customElementsFn: function customElementsFn(el, oldVal, newVal) {\n      return function (cb) {\n        return cb.call(el, oldVal, newVal);\n      };\n    }\n  }\n};\n\nvar make = {};\n\n// Dynamically fill in the custom methods instead of manually constructing\n// them.\nObject.keys(states).forEach(function iterateStates(stateName) {\n  var mapFn = fnSignatures[stateName].mapFn;\n\n  /**\n   * Make's the transition promises.\n   *\n   * @param elements\n   * @param args\n   * @param promises\n   */\n  make[stateName] = function makeTransitionPromises(elements, args, promises) {\n    forEach.call(elements, function (element) {\n      // Never pass text nodes to a state callback unless it is textChanged.\n      if (stateName !== 'textChanged' && element.nodeType !== 1) {\n        return;\n      }\n\n      // Call the map function with each element.\n      var newPromises = states[stateName].map(mapFn.apply(null, [element].concat(args))).filter(Boolean);\n\n      // Merge these Promises into the main cache.\n      promises.push.apply(promises, newPromises);\n\n      // Recursively call into the children if attached or detached.\n      if (stateName === 'attached' || stateName === 'detached') {\n        make[stateName](element.childNodes, args, promises);\n      }\n    });\n\n    return promises;\n  };\n});\n\n/**\n * Builds a reusable trigger mechanism for the element transitions.\n *\n * @param stateName\n * @param nodes\n * @param callback\n * @return\n */\nfunction buildTrigger(allPromises) {\n  var addPromises = allPromises.push.apply.bind(allPromises.push, allPromises);\n\n  // This becomes `triggerTransition` in process.js.\n  return function (stateName, makePromisesCallback, callback) {\n    if (states[stateName] && states[stateName].length) {\n      // Calls into each custom hook to bind Promises into the local array,\n      // these will then get merged into the main `allPromises` array.\n      var promises = makePromisesCallback([]);\n\n      // Add these promises into the global cache.\n      addPromises(promises);\n\n      if (!promises.length && callback) {\n        callback(promises);\n      } else {\n        Promise.all(promises).then(callback, function handleRejection(ex) {\n          console.log(ex);\n        });\n      }\n    } else if (callback) {\n      callback();\n    }\n  };\n}\n\n/**\n * Triggers the lifecycle events on an HTMLElement.\n *\n * @param stateName\n * @param elements\n * @return\n */\nfunction triggerLifecycleEvent(stateName, args, elements) {\n  // Trigger custom element\n  var customElementFn = fnSignatures[stateName].customElementsFn;\n\n  for (var i = 0; i < elements.length; i++) {\n    var element = elements[i];\n    var isTextNode = element.nodeType === 3;\n    var nodeName = element.nodeName.toLowerCase();\n    var descriptor = (0, _make2.default)(element);\n\n    // Value of the `is` attribute, if it exists.\n    var isAttr = null;\n\n    // Check for the `is` attribute. It has a known bug where it cannot be\n    // applied dynamically.\n    if (!_custom.components[nodeName] && Array.isArray(descriptor.attributes)) {\n      descriptor.attributes.some(function (attr, idx) {\n        if (attr.name === 'is') {\n          isAttr = attr.value;\n          return true;\n        }\n      });\n    }\n\n    // Hack around the `is` attribute being unable to be set dynamically.\n    if (isAttr && _custom.components[isAttr]) {\n      nodeName = isAttr;\n    }\n\n    var customElement = _custom.components[nodeName] || empty;\n    var customElementMethodName = stateName + 'Callback';\n\n    // Call the associated CustomElement's lifecycle callback, if it exists.\n    if (customElement.prototype[customElementMethodName]) {\n      customElementFn.apply(null, args)(customElement.prototype[customElementMethodName].bind(element));\n    }\n  }\n}\n\n/**\n * Make a reusable function for easy transition calling.\n *\n * @param stateName\n * @param elements\n * @return\n */\nfunction makePromises(stateName) {\n  for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  // Ensure elements is always an array.\n  var elements = slice.call(args[0]);\n\n  // Triggers the custom element callback.\n  triggerLifecycleEvent(stateName, args.slice(1), elements);\n\n  // Accepts the local Array of promises to use.\n  return function (promises) {\n    return make[stateName](elements, args.slice(1), promises);\n  };\n}\n\n},{\"./element/custom\":1,\"./node/make\":6}],14:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.decodeEntities = decodeEntities;\nvar element = document.createElement('div');\n\n/**\n * Decodes HTML strings.\n *\n * @see http://stackoverflow.com/a/5796718\n * @param stringing\n * @return unescaped HTML\n */\nfunction decodeEntities(string) {\n  element.innerHTML = string;\n\n  return element.textContent;\n}\n\n},{}],15:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.protectElement = protectElement;\nexports.unprotectElement = unprotectElement;\nexports.cleanMemory = cleanMemory;\n\nvar _pools2 = _dereq_('../util/pools');\n\nvar _make = _dereq_('../node/make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar pools = _pools2.pools;\nvar makeNode = _make2.default;\n\n/**\n * Ensures that an element is not recycled during a render cycle.\n *\n * @param element\n * @return element\n */\nfunction protectElement(element) {\n  var elementObject = pools.elementObject;\n  var attributeObject = pools.attributeObject;\n\n  elementObject.protect(element);\n\n  element.attributes.forEach(attributeObject.protect, attributeObject);\n\n  if (element.childNodes) {\n    element.childNodes.forEach(protectElement);\n  }\n\n  return element;\n}\n\n/**\n * Allows an element to be recycled during a render cycle.\n *\n * @param element\n * @return\n */\nfunction unprotectElement(element, makeNode) {\n  var elementObject = pools.elementObject;\n  var attributeObject = pools.attributeObject;\n\n  elementObject.unprotect(element);\n  elementObject.cache.uuid.delete(element.uuid);\n\n  element.attributes.forEach(attributeObject.unprotect, attributeObject);\n\n  if (element.childNodes) {\n    element.childNodes.forEach(function (node) {\n      return unprotectElement(node, makeNode);\n    });\n  }\n\n  if (makeNode && makeNode.nodes) {\n    delete makeNode.nodes[element.uuid];\n  }\n\n  return element;\n}\n\n/**\n * Recycles all unprotected allocations.\n */\nfunction cleanMemory(makeNode) {\n  var elementObject = pools.elementObject;\n  var attributeObject = pools.attributeObject;\n\n  // Clean out unused elements.\n  if (makeNode && makeNode.nodes) {\n    for (var uuid in makeNode.nodes) {\n      if (!elementObject.cache.uuid.has(uuid)) {\n        delete makeNode.nodes[uuid];\n      }\n    }\n  }\n\n  // Empty all element allocations.\n  elementObject.cache.allocated.forEach(function (v) {\n    elementObject.cache.free.push(v);\n  });\n\n  elementObject.cache.allocated.clear();\n\n  // Empty all attribute allocations.\n  attributeObject.cache.allocated.forEach(function (v) {\n    attributeObject.cache.free.push(v);\n  });\n\n  attributeObject.cache.allocated.clear();\n}\n\n},{\"../node/make\":6,\"../util/pools\":17}],16:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.parseHTML = parseHTML;\nexports.makeParser = makeParser;\n\nvar _pools2 = _dereq_('./pools');\n\nvar pools = _pools2.pools; // Code based off of:\n// https://github.com/ashi009/node-fast-html-parser\n\nvar parser = makeParser();\nvar slice = Array.prototype.slice;\n\n/**\n * parseHTML\n *\n * @param newHTML\n * @return\n */\nfunction parseHTML(newHTML, isInner) {\n  var documentElement = parser.parse(newHTML);\n  var nodes = documentElement.childNodes;\n\n  return isInner ? nodes : nodes[0];\n}\n\n/**\n * makeParser\n *\n * @return\n */\nfunction makeParser() {\n  var kMarkupPattern = /<!--[^]*?(?=-->)-->|<(\\/?)([a-z\\-][a-z0-9\\-]*)\\s*([^>]*?)(\\/?)>/ig;\n\n  var kAttributePattern = /\\b(id|class)\\s*(=\\s*(\"([^\"]+)\"|'([^']+)'|(\\S+)))?/ig;\n\n  var reAttrPattern = /\\b([a-z][a-z0-9\\-]*)\\s*(=\\s*(\"([^\"]+)\"|'([^']+)'|(\\S+)))?/ig;\n\n  var kSelfClosingElements = {\n    meta: true,\n    img: true,\n    link: true,\n    input: true,\n    area: true,\n    br: true,\n    hr: true\n  };\n\n  var kElementsClosedByOpening = {\n    li: {\n      li: true\n    },\n\n    p: {\n      p: true, div: true\n    },\n\n    td: {\n      td: true, th: true\n    },\n\n    th: {\n      td: true, th: true\n    }\n  };\n\n  var kElementsClosedByClosing = {\n    li: {\n      ul: true, ol: true\n    },\n\n    a: {\n      div: true\n    },\n\n    b: {\n      div: true\n    },\n\n    i: {\n      div: true\n    },\n\n    p: {\n      div: true\n    },\n\n    td: {\n      tr: true, table: true\n    },\n\n    th: {\n      tr: true, table: true\n    }\n  };\n\n  var kBlockTextElements = {\n    script: true,\n    noscript: true,\n    style: true,\n    template: true\n  };\n\n  var escapeMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#x27;',\n    '`': '&#x60;'\n  };\n\n  /**\n   * TextNode to contain a text element in DOM tree.\n   * @param {string} value [description]\n   */\n  function TextNode(value) {\n    var instance = pools.elementObject.get();\n\n    instance.nodeName = '#text';\n    instance.nodeValue = value;\n    instance.nodeType = 3;\n    instance.childNodes.length = 0;\n    instance.attributes.length = 0;\n\n    return instance;\n  }\n\n  /**\n   * HTMLElement, which contains a set of children.\n   *\n   * Note: this is a minimalist implementation, no complete tree structure\n   * provided (no parentNode, nextSibling, previousSibling etc).\n   *\n   * @param {string} name     nodeName\n   * @param {Object} keyAttrs id and class attribute\n   * @param {Object} rawAttrs attributes in string\n   */\n  function HTMLElement(name, keyAttrs, rawAttrs) {\n    var instance = pools.elementObject.get();\n\n    instance.nodeName = name;\n    instance.nodeValue = '';\n    instance.nodeType = 1;\n    instance.childNodes.length = 0;\n    instance.attributes.length = 0;\n\n    if (rawAttrs) {\n      for (var match; match = reAttrPattern.exec(rawAttrs);) {\n        var attr = pools.attributeObject.get();\n\n        attr.name = match[1];\n        attr.value = match[6] || match[5] || match[4] || match[1];\n\n        // Look for empty attributes.\n        if (match[6] === '\"\"') {\n          attr.value = '';\n        }\n\n        instance.attributes.push(attr);\n      }\n    }\n\n    return instance;\n  }\n\n  /**\n   * Parses HTML and returns a root element\n   */\n  var htmlParser = {\n    /**\n     * Parse a chuck of HTML source.\n     * @param  {string} data      html\n     * @return {HTMLElement}      root element\n     */\n    parse: function parse(data) {\n      var rootObject = {};\n      var root = HTMLElement(null, rootObject);\n      var currentParent = root;\n      var stack = [root];\n      var lastTextPos = -1;\n\n      if (data.indexOf('<') === -1 && data) {\n        currentParent.childNodes.push(TextNode(data));\n\n        return root;\n      }\n\n      for (var match, text; match = kMarkupPattern.exec(data);) {\n        if (lastTextPos > -1) {\n          if (lastTextPos + match[0].length < kMarkupPattern.lastIndex) {\n            // if has content\n            text = data.slice(lastTextPos, kMarkupPattern.lastIndex - match[0].length);\n\n            currentParent.childNodes.push(TextNode(text));\n          }\n        }\n\n        lastTextPos = kMarkupPattern.lastIndex;\n\n        // This is a comment.\n        if (match[0][1] === '!') {\n          continue;\n        }\n\n        if (!match[1]) {\n          // not </ tags\n          var attrs = {};\n\n          for (var attMatch; attMatch = kAttributePattern.exec(match[3]);) {\n            attrs[attMatch[1]] = attMatch[3] || attMatch[4] || attMatch[5];\n          }\n\n          if (!match[4] && kElementsClosedByOpening[currentParent.nodeName]) {\n            if (kElementsClosedByOpening[currentParent.nodeName][match[2]]) {\n              stack.pop();\n              currentParent = stack[stack.length - 1];\n            }\n          }\n\n          currentParent = currentParent.childNodes[currentParent.childNodes.push(HTMLElement(match[2], attrs, match[3])) - 1];\n\n          stack.push(currentParent);\n\n          if (kBlockTextElements[match[2]]) {\n            // A little test to find next </script> or </style> ...\n            var closeMarkup = '</' + match[2] + '>';\n            var index = data.indexOf(closeMarkup, kMarkupPattern.lastIndex);\n            var length = match[2].length;\n\n            if (index === -1) {\n              lastTextPos = kMarkupPattern.lastIndex = data.length + 1;\n            } else {\n              lastTextPos = kMarkupPattern.lastIndex = index + closeMarkup.length;\n              match[1] = true;\n            }\n\n            var newText = data.slice(match.index + match[0].length, index);\n\n            if (newText.trim()) {\n              newText = slice.call(newText).map(function (ch) {\n                return escapeMap[ch] || ch;\n              }).join('');\n\n              currentParent.childNodes.push(TextNode(newText));\n            }\n          }\n        }\n        if (match[1] || match[4] || kSelfClosingElements[match[2]]) {\n          // </ or /> or <br> etc.\n          while (currentParent) {\n            if (currentParent.nodeName == match[2]) {\n              stack.pop();\n              currentParent = stack[stack.length - 1];\n\n              break;\n            } else {\n              // Trying to close current tag, and move on\n              if (kElementsClosedByClosing[currentParent.nodeName]) {\n                if (kElementsClosedByClosing[currentParent.nodeName][match[2]]) {\n                  stack.pop();\n                  currentParent = stack[stack.length - 1];\n\n                  continue;\n                }\n              }\n\n              // Use aggressive strategy to handle unmatching markups.\n              break;\n            }\n          }\n        }\n      }\n\n      // This is an entire document, so only allow the HTML children to be\n      // body or head.\n      if (root.childNodes.length && root.childNodes[0].nodeName === 'html') {\n        (function () {\n          // Store elements from before body end and after body end.\n          var head = { before: [], after: [] };\n          var body = { after: [] };\n          var beforeHead = true;\n          var beforeBody = true;\n          var HTML = root.childNodes[0];\n\n          // Iterate the children and store elements in the proper array for\n          // later concat, replace the current childNodes with this new array.\n          HTML.childNodes = HTML.childNodes.filter(function (el) {\n            // If either body or head, allow as a valid element.\n            if (el.nodeName === 'body' || el.nodeName === 'head') {\n              if (el.nodeName === 'head') {\n                beforeHead = false;\n              }\n\n              if (el.nodeName === 'body') {\n                beforeBody = false;\n              }\n\n              return true;\n            }\n            // Not a valid nested HTML tag element, move to respective container.\n            else if (el.nodeType === 1) {\n                if (beforeHead && beforeBody) {\n                  head.before.push(el);\n                } else if (!beforeHead && beforeBody) {\n                  head.after.push(el);\n                } else if (!beforeBody) {\n                  body.after.push(el);\n                }\n              }\n          });\n\n          // Ensure the first element is the HEAD tag.\n          if (!HTML.childNodes[0] || HTML.childNodes[0].nodeName !== 'head') {\n            var headInstance = pools.elementObject.get();\n            headInstance.nodeName = 'head';\n            headInstance.childNodes.length = 0;\n            headInstance.attributes.length = 0;\n\n            var existing = headInstance.childNodes;\n            existing.unshift.apply(existing, head.before);\n            existing.push.apply(existing, head.after);\n\n            HTML.childNodes.unshift(headInstance);\n          } else {\n            var _existing = HTML.childNodes[0].childNodes;\n            _existing.unshift.apply(_existing, head.before);\n            _existing.push.apply(_existing, head.after);\n          }\n\n          // Ensure the second element is the body tag.\n          if (!HTML.childNodes[1] || HTML.childNodes[1].nodeName !== 'body') {\n            var bodyInstance = pools.elementObject.get();\n            bodyInstance.nodeName = 'body';\n            bodyInstance.childNodes.length = 0;\n            bodyInstance.attributes.length = 0;\n\n            var _existing2 = bodyInstance.childNodes;\n            _existing2.push.apply(_existing2, body.after);\n\n            HTML.childNodes.push(bodyInstance);\n          } else {\n            var _existing3 = HTML.childNodes[1].childNodes;\n            _existing3.push.apply(_existing3, body.after);\n          }\n        })();\n      }\n\n      return root;\n    }\n  };\n\n  return htmlParser;\n}\n\n},{\"./pools\":17}],17:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.count = exports.pools = undefined;\nexports.createPool = createPool;\nexports.initializePools = initializePools;\n\nvar _uuid2 = _dereq_('./uuid');\n\nvar _uuid3 = _interopRequireDefault(_uuid2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar uuid = _uuid3.default;\n\nvar pools = exports.pools = {};\nvar count = exports.count = 10000;\n\n/**\n * Creates a pool to query new or reused values from.\n *\n * @param name\n * @param opts\n * @return {Object} pool\n */\nfunction createPool(name, opts) {\n  var size = opts.size;\n  var fill = opts.fill;\n\n  var cache = {\n    free: [],\n    allocated: new Set(),\n    protected: new Set(),\n    uuid: new Set()\n  };\n\n  // Prime the cache with n objects.\n  for (var i = 0; i < size; i++) {\n    cache.free.push(fill());\n  }\n\n  return {\n    cache: cache,\n\n    get: function get() {\n      var value = cache.free.pop() || fill();\n      cache.allocated.add(value);\n      return value;\n    },\n    protect: function protect(value) {\n      cache.allocated.delete(value);\n      cache.protected.add(value);\n\n      if (name === 'elementObject') {\n        cache.uuid.add(value.uuid);\n      }\n    },\n    unprotect: function unprotect(value) {\n      if (cache.protected.has(value)) {\n        cache.protected.delete(value);\n        cache.free.push(value);\n      }\n    }\n  };\n}\n\nfunction initializePools(COUNT) {\n  pools.attributeObject = createPool('attributeObject', {\n    size: COUNT,\n\n    fill: function fill() {\n      return { name: '', value: '' };\n    }\n  });\n\n  pools.elementObject = createPool('elementObject', {\n    size: COUNT,\n\n    fill: function fill() {\n      return {\n        nodeName: '',\n        nodeValue: '',\n        uuid: uuid(),\n        childNodes: [],\n        attributes: []\n      };\n    }\n  });\n}\n\n// Create ${COUNT} items of each type.\ninitializePools(count);\n\n},{\"./uuid\":19}],18:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.completeRender = completeRender;\n\nvar _customEvent = _dereq_('custom-event');\n\nvar _customEvent2 = _interopRequireDefault(_customEvent);\n\nvar _patch = _dereq_('../node/patch');\n\nvar _patch2 = _interopRequireDefault(_patch);\n\nvar _make = _dereq_('../node/make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nvar _tree = _dereq_('../node/tree');\n\nvar _memory = _dereq_('../util/memory');\n\nvar _pools = _dereq_('../util/pools');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction renderNext(elementMeta) {\n  var nextRender = elementMeta.renderBuffer;\n  elementMeta.renderBuffer = undefined;\n\n  // Noticing some weird performance implications with this concept.\n  (0, _patch2.default)(nextRender.element, nextRender.newHTML, nextRender.options);\n}\n\n/**\n * When the UI or Worker thread completes, clean up memory and schedule the\n * next render if necessary.\n *\n * @param element\n * @param elementMeta\n */\nfunction completeRender(element, elementMeta) {\n  return function invokeRender() {\n    elementMeta.previousMarkup = elementMeta.options.inner ? element.innerHTML : element.outerHTML;\n    elementMeta._textContent = element.textContent;\n\n    (0, _memory.cleanMemory)(_make2.default);\n\n    elementMeta.isRendering = false;\n\n    // Boolean to stop operations in the TreeCache loop below.\n    var stopLooping = false;\n\n    // This is designed to handle use cases where renders are being hammered\n    // or when transitions are used with Promises.\n    if (elementMeta.renderBuffer) {\n      renderNext(elementMeta);\n    } else {\n      _tree.TreeCache.forEach(function iterateTreeCache(elementMeta) {\n        if (!stopLooping && elementMeta.renderBuffer) {\n          renderNext(elementMeta);\n          stopLooping = true;\n        }\n      });\n    }\n\n    // Dispatch an event on the element once rendering has completed.\n    element.dispatchEvent(new _customEvent2.default('renderComplete'));\n  };\n}\n\n},{\"../node/make\":6,\"../node/patch\":7,\"../node/tree\":10,\"../util/memory\":15,\"../util/pools\":17,\"custom-event\":22}],19:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = uuid;\n/**\n * Generates a uuid.\n *\n * @see http://stackoverflow.com/a/2117523/282175\n * @return {string} uuid\n */\nfunction uuid() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0;\n    var v = c == 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\n},{}],20:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.hasWorker = undefined;\nexports.create = create;\n\nvar _uuid = _dereq_('../util/uuid');\n\nvar _uuid2 = _interopRequireDefault(_uuid);\n\nvar _pools = _dereq_('../util/pools');\n\nvar _parser = _dereq_('../util/parser');\n\nvar _memory = _dereq_('../util/memory');\n\nvar _sync = _dereq_('../node/sync');\n\nvar _sync2 = _interopRequireDefault(_sync);\n\nvar _make = _dereq_('../node/make');\n\nvar _make2 = _interopRequireDefault(_make);\n\nvar _source = _dereq_('./source');\n\nvar _source2 = _interopRequireDefault(_source);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Tests if the browser has support for the `Worker` API.\nvar hasWorker = exports.hasWorker = typeof Worker === 'function';\n\n// Find all the coverage statements and expressions.\nvar COV_EXP = /__cov_([^\\+\\+]*)\\+\\+/gi;\n\n/**\n * Awful hack to remove `__cov` lines from the source before sending over to\n * the worker. Only useful while testing.\n */\nfunction filterOutCoverage(string) {\n  return string.replace(COV_EXP, 'null');\n}\n\n/**\n * Creates a new Web Worker per element that will be diffed. Allows multiple\n * concurrent diffing operations to occur simultaneously, leveraging the\n * multi-core nature of desktop and mobile devices.\n *\n * Attach any functions that could be used by the Worker inside the Blob below.\n * All functions are named so they can be accessed globally. Since we're\n * directly injecting the methods into the ES6 template string,\n * `Function.prototype.toString` will be invoked returning a representation of\n * the function's source. This comes at a cost since Babel rewrites variable\n * names when you `import` a module. This is why you'll see underscored\n * properties being imported and then reassigned to non-underscored names in\n * modules that are reused here. Isparta injects coverage function calls that\n * will error out in the Worker, which is why we strip them out.\n *\n * @return {Object} A Worker instance.\n */\nfunction create() {\n  var worker = null;\n  var workerBlob = null;\n  var workerSource = filterOutCoverage('\\n    // Reusable Array methods.\\n    var slice = Array.prototype.slice;\\n    var filter = Array.prototype.filter;\\n\\n    // Add a namespace to attach pool methods to.\\n    var pools = {};\\n    var nodes = 0;\\n    var REMOVE_ELEMENT_CHILDREN = -2;\\n    var REMOVE_ENTIRE_ELEMENT = -1;\\n    var MODIFY_ELEMENT = 1;\\n    var MODIFY_ATTRIBUTE = 2;\\n    var CHANGE_TEXT = 3;\\n\\n    // Inject the uuid code.\\n    ' + _uuid2.default + ';\\n\\n    // Add in pool manipulation methods.\\n    ' + _pools.createPool + ';\\n    ' + _pools.initializePools + ';\\n\\n    initializePools(' + _pools.count + ');\\n\\n    // Add the ability to protect elements from free\\'d memory.\\n    ' + _memory.protectElement + ';\\n    ' + _memory.unprotectElement + ';\\n    ' + _memory.cleanMemory + ';\\n\\n    // Add in Node manipulation.\\n    var syncNode = ' + _sync2.default + ';\\n    var makeNode = ' + _make2.default + ';\\n\\n    // Add in the ability to parseHTML.\\n    ' + _parser.parseHTML + ';\\n\\n    var makeParser = ' + _parser.makeParser + ';\\n    var parser = makeParser();\\n\\n    // Add in the worker source.\\n    ' + _source2.default + ';\\n\\n    // Metaprogramming up this worker call.\\n    startup(self);\\n  ');\n\n  // Set up a WebWorker if available.\n  if (hasWorker) {\n    // Construct the worker reusing code already organized into modules.  Keep\n    // this code ES5 since we do not get time to pre-process it as ES6.\n    workerBlob = new Blob([workerSource], { type: 'application/javascript' });\n\n    // Construct the worker and start it up.\n    try {\n      worker = new Worker(URL.createObjectURL(workerBlob));\n    } catch (ex) {\n      if (console && console.info) {\n        console.info('Failed to create diffhtml worker', ex);\n      }\n\n      // If we cannot create a Worker, then disable trying again, all work\n      // will happen on the main UI thread.\n      exports.hasWorker = hasWorker = false;\n    }\n  }\n\n  return worker;\n}\n\n},{\"../node/make\":6,\"../node/sync\":9,\"../util/memory\":15,\"../util/parser\":16,\"../util/pools\":17,\"../util/uuid\":19,\"./source\":21}],21:[function(_dereq_,module,exports){\n'use strict';\n\n// These are globally defined to avoid issues with JSHint thinking that we're\n// referencing unknown identifiers.\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = startup;\nvar parseHTML;\nvar syncNode;\nvar pools;\nvar unprotectElement;\nvar protectElement;\nvar cleanMemory;\n\n/**\n * This is the Web Worker source code. All globals here are defined in the\n * worker/create module. This allows code sharing and less duplication since\n * most of the logic is identical to the UI thread.\n *\n * @param worker - A worker instance\n */\nfunction startup(worker) {\n  var patches = [];\n  var oldTree = null;\n\n  /**\n   * Triggered whenever a `postMessage` call is made on the Worker instance\n   * from the UI thread. Signals that some work needs to occur. Will post back\n   * to the main thread with patch and node transform results.\n   *\n   * @param e - The normalized event object.\n   */\n  worker.onmessage = function onmessage(e) {\n    var data = e.data;\n    var isInner = data.isInner;\n    var newTree = null;\n\n    // If an `oldTree` was provided by the UI thread, use that in place of the\n    // current `oldTree`.\n    if (data.oldTree) {\n      if (oldTree) {\n        unprotectElement(oldTree);\n        cleanMemory();\n      }\n\n      oldTree = data.oldTree;\n    }\n\n    // If the `newTree` was provided to the worker, use that instead of trying\n    // to create one from HTML source.\n    if (data.newTree) {\n      newTree = data.newTree;\n    }\n\n    // If no `newTree` was provided, we'll have to try and create one from the\n    // HTML source provided.\n    else if (typeof data.newHTML === 'string') {\n        // Calculate a new tree.\n        newTree = parseHTML(data.newHTML, isInner);\n\n        // If the operation is for `innerHTML` then we'll retain the previous\n        // tree's attributes, nodeName, and nodeValue, and only adjust the\n        // childNodes.\n        if (isInner) {\n          var childNodes = newTree;\n\n          newTree = {\n            childNodes: childNodes,\n            attributes: oldTree.attributes,\n            uuid: oldTree.uuid,\n            nodeName: oldTree.nodeName,\n            nodeValue: oldTree.nodeValue\n          };\n        }\n      }\n\n    // Synchronize the old virtual tree with the new virtual tree.  This will\n    // produce a series of patches that will be executed to update the DOM.\n    syncNode(oldTree, newTree, patches);\n\n    // Protect the current `oldTree` so that Nodes will not be accidentally\n    // recycled in the cleanup process.\n    protectElement(oldTree);\n\n    // Send the patches back to the userland.\n    worker.postMessage({\n      // All the patches to apply to the DOM.\n      patches: patches\n    });\n\n    // Recycle allocated objects back into the pool.\n    cleanMemory();\n\n    // Wipe out the patches in memory.\n    patches.length = 0;\n  };\n}\n\n},{}],22:[function(_dereq_,module,exports){\n(function (global){\n\nvar NativeCustomEvent = global.CustomEvent;\n\nfunction useNative () {\n  try {\n    var p = new NativeCustomEvent('cat', { detail: { foo: 'bar' } });\n    return  'cat' === p.type && 'bar' === p.detail.foo;\n  } catch (e) {\n  }\n  return false;\n}\n\n/**\n * Cross-browser `CustomEvent` constructor.\n *\n * https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent.CustomEvent\n *\n * @public\n */\n\nmodule.exports = useNative() ? NativeCustomEvent :\n\n// IE >= 9\n'function' === typeof document.createEvent ? function CustomEvent (type, params) {\n  var e = document.createEvent('CustomEvent');\n  if (params) {\n    e.initCustomEvent(type, params.bubbles, params.cancelable, params.detail);\n  } else {\n    e.initCustomEvent(type, false, false, void 0);\n  }\n  return e;\n} :\n\n// IE <= 8\nfunction CustomEvent (type, params) {\n  var e = document.createEventObject();\n  e.type = type;\n  if (params) {\n    e.bubbles = Boolean(params.bubbles);\n    e.cancelable = Boolean(params.cancelable);\n    e.detail = params.detail;\n  } else {\n    e.bubbles = false;\n    e.cancelable = false;\n    e.detail = void 0;\n  }\n  return e;\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}]},{},[5])(5)\n});\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9kaWZmaHRtbC9kaXN0L2RpZmZodG1sLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oZil7aWYodHlwZW9mIGV4cG9ydHM9PT1cIm9iamVjdFwiJiZ0eXBlb2YgbW9kdWxlIT09XCJ1bmRlZmluZWRcIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PVwiZnVuY3Rpb25cIiYmZGVmaW5lLmFtZCl7ZGVmaW5lKFtdLGYpfWVsc2V7dmFyIGc7aWYodHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCIpe2c9d2luZG93fWVsc2UgaWYodHlwZW9mIGdsb2JhbCE9PVwidW5kZWZpbmVkXCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiKXtnPXNlbGZ9ZWxzZXtnPXRoaXN9Zy5kaWZmID0gZigpfX0pKGZ1bmN0aW9uKCl7dmFyIGRlZmluZSxtb2R1bGUsZXhwb3J0cztyZXR1cm4gKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy51cGdyYWRlID0gdXBncmFkZTtcbi8qKlxuICogU3RvcmUgYWxsIEN1c3RvbSBFbGVtZW50IGRlZmluaXRpb25zIGluIHRoaXMgb2JqZWN0LiBUaGUgdGFnTmFtZSBpcyB0aGUga2V5LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xudmFyIGNvbXBvbmVudHMgPSBleHBvcnRzLmNvbXBvbmVudHMgPSB7fTtcblxuLyoqXG4gKiBFbnN1cmVzIHRoZSBlbGVtZW50IGluc3RhbmNlIG1hdGNoZXMgdGhlIEN1c3RvbUVsZW1lbnQncyBwcm90b3R5cGUuXG4gKlxuICogQHBhcmFtIG5vZGVOYW1lIC0gVGhlIEhUTUwgbm9kZU5hbWUgdG8gdXNlIGZvciB0aGUgQ3VzdG9tIEVsZW1lbnRcbiAqIEBwYXJhbSBlbGVtZW50IC0gVGhlIGVsZW1lbnQgdG8gdXBncmFkZVxuICogQHBhcmFtIGRlc2NyaXB0b3IgLSBUaGUgdmlydHVhbCBub2RlIGJhY2tpbmcgdGhlIGVsZW1lbnRcbiAqIEByZXR1cm4ge0Jvb2xlYW59IHN1Y2Nlc3NmdWxseSB1cGdyYWRlZFxuICovXG5mdW5jdGlvbiB1cGdyYWRlKG5vZGVOYW1lLCBlbGVtZW50LCBkZXNjcmlwdG9yKSB7XG4gIC8vIFZhbHVlIG9mIHRoZSBgaXNgIGF0dHJpYnV0ZSwgaWYgaXQgZXhpc3RzLlxuICB2YXIgaXNBdHRyID0gbnVsbDtcblxuICAvLyBDaGVjayBmb3IgdGhlIGBpc2AgYXR0cmlidXRlLiBJdCBoYXMgYSBrbm93biBidWcgd2hlcmUgaXQgY2Fubm90IGJlXG4gIC8vIGFwcGxpZWQgZHluYW1pY2FsbHkuXG4gIGlmICghY29tcG9uZW50c1tub2RlTmFtZV0gJiYgQXJyYXkuaXNBcnJheShkZXNjcmlwdG9yLmF0dHJpYnV0ZXMpKSB7XG4gICAgZGVzY3JpcHRvci5hdHRyaWJ1dGVzLnNvbWUoZnVuY3Rpb24gKGF0dHIsIGlkeCkge1xuICAgICAgaWYgKGF0dHIubmFtZSA9PT0gJ2lzJykge1xuICAgICAgICBpc0F0dHIgPSBhdHRyLnZhbHVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8vIEhhY2sgYXJvdW5kIHRoZSBgaXNgIGF0dHJpYnV0ZSBiZWluZyB1bmFibGUgdG8gYmUgc2V0IGR5bmFtaWNhbGx5LlxuICBpZiAoaXNBdHRyICYmIGNvbXBvbmVudHNbaXNBdHRyXSkge1xuICAgIG5vZGVOYW1lID0gaXNBdHRyO1xuICB9XG5cbiAgdmFyIEN1c3RvbUVsZW1lbnQgPSBjb21wb25lbnRzW25vZGVOYW1lXTtcblxuICBpZiAoIUN1c3RvbUVsZW1lbnQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoQ3VzdG9tRWxlbWVudC5leHRlbmRzICYmIEN1c3RvbUVsZW1lbnQuZXh0ZW5kcyAhPT0gZGVzY3JpcHRvci5ub2RlTmFtZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIElmIG5vIEN1c3RvbSBFbGVtZW50IHdhcyByZWdpc3RlcmVkLCBiYWlsIGVhcmx5LiBEb24ndCBuZWVkIHRvIHVwZ3JhZGVcbiAgLy8gaWYgdGhlIGVsZW1lbnQgd2FzIGFscmVhZHkgcHJvY2Vzc2VkLi5cbiAgaWYgKHR5cGVvZiBDdXN0b21FbGVtZW50ID09PSAnZnVuY3Rpb24nICYmIGVsZW1lbnQgaW5zdGFuY2VvZiBDdXN0b21FbGVtZW50KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gQ29weSB0aGUgcHJvdG90eXBlIGludG8gdGhlIEVsZW1lbnQuXG4gIGVsZW1lbnQuX19wcm90b19fID0gT2JqZWN0LmNyZWF0ZShDdXN0b21FbGVtZW50LnByb3RvdHlwZSk7XG5cbiAgLy8gQ3VzdG9tIGVsZW1lbnRzIGhhdmUgYSBjcmVhdGVkQ2FsbGJhY2sgbWV0aG9kIHRoYXQgc2hvdWxkIGJlIGNhbGxlZC5cbiAgaWYgKEN1c3RvbUVsZW1lbnQucHJvdG90eXBlLmNyZWF0ZWRDYWxsYmFjaykge1xuICAgIEN1c3RvbUVsZW1lbnQucHJvdG90eXBlLmNyZWF0ZWRDYWxsYmFjay5jYWxsKGVsZW1lbnQpO1xuICB9XG5cbiAgLy8gSXMgdGhlIGVsZW1lbnQgZXhpc3RpbmcgaW4gdGhlIERPTT9cbiAgdmFyIGluRE9NID0gZWxlbWVudC5vd25lckRvY3VtZW50LmNvbnRhaW5zKGVsZW1lbnQpO1xuXG4gIC8vIElmIHRoZSBOb2RlIGlzIGluIHRoZSBET00sIHRyaWdnZXIgYXR0YWNoZWQgY2FsbGJhY2suXG4gIGlmIChpbkRPTSAmJiBDdXN0b21FbGVtZW50LnByb3RvdHlwZS5hdHRhY2hlZENhbGxiYWNrKSB7XG4gICAgZWxlbWVudC5hdHRhY2hlZENhbGxiYWNrKCk7XG4gIH1cblxuICAvLyBUaGUgdXBncmFkZSB3YXMgc3VjY2Vzc2Z1bC5cbiAgcmV0dXJuIHRydWU7XG59XG5cbn0se31dLDI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gZ2V0O1xuXG52YXIgX21ha2UgPSBfZGVyZXFfKCcuLi9ub2RlL21ha2UnKTtcblxudmFyIF9tYWtlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21ha2UpO1xuXG52YXIgX21ha2UzID0gX2RlcmVxXygnLi4vZWxlbWVudC9tYWtlJyk7XG5cbnZhciBfbWFrZTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tYWtlMyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8qKlxuICogVGFrZXMgaW4gYW4gZWxlbWVudCBkZXNjcmlwdG9yIGFuZCByZXNvbHZlIGl0IHRvIGEgdXVpZCBhbmQgRE9NIE5vZGUuXG4gKlxuICogQHBhcmFtIGRlc2NyaXB0b3IgLSBFbGVtZW50IGRlc2NyaXB0b3JcbiAqIEByZXR1cm4ge09iamVjdH0gY29udGFpbmluZyB0aGUgdXVpZCBhbmQgRE9NIG5vZGVcbiAqL1xuZnVuY3Rpb24gZ2V0KGRlc2NyaXB0b3IpIHtcbiAgdmFyIHV1aWQgPSBkZXNjcmlwdG9yLnV1aWQ7XG4gIHZhciBlbGVtZW50ID0gKDAsIF9tYWtlNC5kZWZhdWx0KShkZXNjcmlwdG9yKTtcblxuICByZXR1cm4geyB1dWlkOiB1dWlkLCBlbGVtZW50OiBlbGVtZW50IH07XG59XG5cbn0se1wiLi4vZWxlbWVudC9tYWtlXCI6MyxcIi4uL25vZGUvbWFrZVwiOjZ9XSwzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IG1ha2U7XG5cbnZhciBfc3ZnID0gX2RlcmVxXygnLi4vc3ZnJyk7XG5cbnZhciBzdmcgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfc3ZnKTtcblxudmFyIF9tYWtlID0gX2RlcmVxXygnLi4vbm9kZS9tYWtlJyk7XG5cbnZhciBfbWFrZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tYWtlKTtcblxudmFyIF9jdXN0b20gPSBfZGVyZXFfKCcuL2N1c3RvbScpO1xuXG52YXIgX2VudGl0aWVzID0gX2RlcmVxXygnLi4vdXRpbC9lbnRpdGllcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfVxuXG4vKipcbiAqIFRha2VzIGluIGEgdmlydHVhbCBkZXNjcmlwdG9yIGFuZCBjcmVhdGVzIGFuIEhUTUwgZWxlbWVudC4gU2V0cyB0aGUgZWxlbWVudFxuICogaW50byB0aGUgY2FjaGUuXG4gKlxuICogQHBhcmFtIGRlc2NyaXB0b3IgLSBFbGVtZW50IGRlc2NyaXB0b3JcbiAqIEByZXR1cm4ge0VsZW1lbnR9IC0gVGhlIG5ld2x5IGNyZWF0ZWQgRE9NIE5vZGVcbiAqL1xuZnVuY3Rpb24gbWFrZShkZXNjcmlwdG9yKSB7XG4gIHZhciBlbGVtZW50ID0gbnVsbDtcbiAgdmFyIGlzU3ZnID0gZmFsc2U7XG4gIC8vIEdldCB0aGUgQ3VzdG9tIEVsZW1lbnQgY29uc3RydWN0b3IgZm9yIGEgZ2l2ZW4gZWxlbWVudC5cbiAgdmFyIG5vZGVOYW1lID0gZGVzY3JpcHRvci5ub2RlTmFtZTtcbiAgdmFyIEN1c3RvbUVsZW1lbnQgPSBfY3VzdG9tLmNvbXBvbmVudHNbbm9kZU5hbWVdO1xuXG4gIC8vIElmIHRoZSBlbGVtZW50IGRlc2NyaXB0b3Igd2FzIGFscmVhZHkgY3JlYXRlZCwgcmV1c2UgdGhlIGV4aXN0aW5nIGVsZW1lbnQuXG4gIGlmIChfbWFrZTIuZGVmYXVsdC5ub2Rlc1tkZXNjcmlwdG9yLnV1aWRdKSB7XG4gICAgcmV0dXJuIF9tYWtlMi5kZWZhdWx0Lm5vZGVzW2Rlc2NyaXB0b3IudXVpZF07XG4gIH1cblxuICBpZiAoZGVzY3JpcHRvci5ub2RlTmFtZSA9PT0gJyN0ZXh0Jykge1xuICAgIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkZXNjcmlwdG9yLm5vZGVWYWx1ZSk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKHN2Zy5lbGVtZW50cy5pbmRleE9mKGRlc2NyaXB0b3Iubm9kZU5hbWUpID4gLTEpIHtcbiAgICAgIGlzU3ZnID0gdHJ1ZTtcbiAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnLm5hbWVzcGFjZSwgZGVzY3JpcHRvci5ub2RlTmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRlc2NyaXB0b3Iubm9kZU5hbWUpO1xuICAgIH1cblxuICAgIC8vIENvcHkgYWxsIHRoZSBhdHRyaWJ1dGVzIGZyb20gdGhlIGRlc2NyaXB0b3IgaW50byB0aGUgbmV3bHkgY3JlYXRlZCBET01cbiAgICAvLyBOb2RlLlxuICAgIGlmIChkZXNjcmlwdG9yLmF0dHJpYnV0ZXMgJiYgZGVzY3JpcHRvci5hdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZXNjcmlwdG9yLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGRlc2NyaXB0b3IuYXR0cmlidXRlc1tpXTtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlLm5hbWUsIGF0dHJpYnV0ZS52YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQXBwZW5kIGFsbCB0aGUgY2hpbGRyZW4gaW50byB0aGUgZWxlbWVudCwgbWFraW5nIHN1cmUgdG8gcnVuIHRoZW1cbiAgICAvLyB0aHJvdWdoIHRoaXMgYG1ha2VgIGZ1bmN0aW9uIGFzIHdlbGwuXG4gICAgaWYgKGRlc2NyaXB0b3IuY2hpbGROb2RlcyAmJiBkZXNjcmlwdG9yLmNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgZGVzY3JpcHRvci5jaGlsZE5vZGVzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKG1ha2UoZGVzY3JpcHRvci5jaGlsZE5vZGVzW19pXSkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIFVwZ3JhZGUgdGhlIGVsZW1lbnQgYWZ0ZXIgY3JlYXRpbmcgaXQsIGlmIG5lY2Vzc2FyeS5cbiAgKDAsIF9jdXN0b20udXBncmFkZSkobm9kZU5hbWUsIGVsZW1lbnQsIGRlc2NyaXB0b3IpO1xuXG4gIC8vIEN1c3RvbSBlbGVtZW50cyBoYXZlIGEgY3JlYXRlZENhbGxiYWNrIG1ldGhvZCB0aGF0IHNob3VsZCBiZSBjYWxsZWQuXG4gIGlmIChDdXN0b21FbGVtZW50ICYmIEN1c3RvbUVsZW1lbnQucHJvdG90eXBlLmNyZWF0ZWRDYWxsYmFjaykge1xuICAgIEN1c3RvbUVsZW1lbnQucHJvdG90eXBlLmNyZWF0ZWRDYWxsYmFjay5jYWxsKGVsZW1lbnQpO1xuICB9XG5cbiAgLy8gQWRkIHRvIHRoZSBub2RlcyBjYWNoZSB1c2luZyB0aGUgZGVzaWduYXRlZCB1dWlkIGFzIHRoZSBsb29rdXAga2V5LlxuICBfbWFrZTIuZGVmYXVsdC5ub2Rlc1tkZXNjcmlwdG9yLnV1aWRdID0gZWxlbWVudDtcblxuICByZXR1cm4gZWxlbWVudDtcbn1cblxufSx7XCIuLi9ub2RlL21ha2VcIjo2LFwiLi4vc3ZnXCI6MTIsXCIuLi91dGlsL2VudGl0aWVzXCI6MTQsXCIuL2N1c3RvbVwiOjF9XSw0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG52YXIgbWlzc2luZ1N0YWNrVHJhY2UgPSAnQnJvd3NlciBkb2VzblxcJ3Qgc3VwcG9ydCBlcnJvciBzdGFjayB0cmFjZXMuJztcblxuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGVycm9yIHdpdGggdHJhbnNpdGlvbnMuXG4gKi9cblxudmFyIFRyYW5zaXRpb25TdGF0ZUVycm9yID0gZXhwb3J0cy5UcmFuc2l0aW9uU3RhdGVFcnJvciA9IGZ1bmN0aW9uIChfRXJyb3IpIHtcbiAgX2luaGVyaXRzKFRyYW5zaXRpb25TdGF0ZUVycm9yLCBfRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIFRyYW5zaXRpb25TdGF0ZUVycm9yKG1lc3NhZ2UpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHJhbnNpdGlvblN0YXRlRXJyb3IpO1xuXG4gICAgdmFyIGVycm9yID0gKF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKFRyYW5zaXRpb25TdGF0ZUVycm9yKS5jYWxsKHRoaXMpKSwgX3RoaXMpO1xuXG4gICAgX3RoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgX3RoaXMuc3RhY2sgPSBlcnJvci5zdGFjayB8fCBtaXNzaW5nU3RhY2tUcmFjZTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gVHJhbnNpdGlvblN0YXRlRXJyb3I7XG59KEVycm9yKTtcblxuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGVycm9yIHdpdGggcmVnaXN0ZXJpbmcgYW4gZWxlbWVudC5cbiAqL1xuXG5cbnZhciBET01FeGNlcHRpb24gPSBleHBvcnRzLkRPTUV4Y2VwdGlvbiA9IGZ1bmN0aW9uIChfRXJyb3IyKSB7XG4gIF9pbmhlcml0cyhET01FeGNlcHRpb24sIF9FcnJvcjIpO1xuXG4gIGZ1bmN0aW9uIERPTUV4Y2VwdGlvbihtZXNzYWdlKSB7XG4gICAgdmFyIF90aGlzMjtcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBET01FeGNlcHRpb24pO1xuXG4gICAgdmFyIGVycm9yID0gKF90aGlzMiA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIE9iamVjdC5nZXRQcm90b3R5cGVPZihET01FeGNlcHRpb24pLmNhbGwodGhpcykpLCBfdGhpczIpO1xuXG4gICAgX3RoaXMyLm1lc3NhZ2UgPSAnVW5jYXVnaHQgRE9NRXhjZXB0aW9uOiAnICsgbWVzc2FnZTtcbiAgICBfdGhpczIuc3RhY2sgPSBlcnJvci5zdGFjayB8fCBtaXNzaW5nU3RhY2tUcmFjZTtcbiAgICByZXR1cm4gX3RoaXMyO1xuICB9XG5cbiAgcmV0dXJuIERPTUV4Y2VwdGlvbjtcbn0oRXJyb3IpO1xuXG59LHt9XSw1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuRE9NRXhjZXB0aW9uID0gZXhwb3J0cy5UcmFuc2l0aW9uU3RhdGVFcnJvciA9IHVuZGVmaW5lZDtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciBfZXJyb3JzID0gX2RlcmVxXygnLi9lcnJvcnMnKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdUcmFuc2l0aW9uU3RhdGVFcnJvcicsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF9lcnJvcnMuVHJhbnNpdGlvblN0YXRlRXJyb3I7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdET01FeGNlcHRpb24nLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgIHJldHVybiBfZXJyb3JzLkRPTUV4Y2VwdGlvbjtcbiAgfVxufSk7XG5leHBvcnRzLm91dGVySFRNTCA9IG91dGVySFRNTDtcbmV4cG9ydHMuaW5uZXJIVE1MID0gaW5uZXJIVE1MO1xuZXhwb3J0cy5lbGVtZW50ID0gZWxlbWVudDtcbmV4cG9ydHMucmVsZWFzZSA9IHJlbGVhc2U7XG5leHBvcnRzLnJlZ2lzdGVyRWxlbWVudCA9IHJlZ2lzdGVyRWxlbWVudDtcbmV4cG9ydHMuYWRkVHJhbnNpdGlvblN0YXRlID0gYWRkVHJhbnNpdGlvblN0YXRlO1xuZXhwb3J0cy5yZW1vdmVUcmFuc2l0aW9uU3RhdGUgPSByZW1vdmVUcmFuc2l0aW9uU3RhdGU7XG5leHBvcnRzLmVuYWJsZVByb2xseWZpbGwgPSBlbmFibGVQcm9sbHlmaWxsO1xuXG52YXIgX3BhdGNoID0gX2RlcmVxXygnLi9ub2RlL3BhdGNoJyk7XG5cbnZhciBfcGF0Y2gyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGF0Y2gpO1xuXG52YXIgX3JlbGVhc2UgPSBfZGVyZXFfKCcuL25vZGUvcmVsZWFzZScpO1xuXG52YXIgX3JlbGVhc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVsZWFzZSk7XG5cbnZhciBfbWFrZSA9IF9kZXJlcV8oJy4vbm9kZS9tYWtlJyk7XG5cbnZhciBfbWFrZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tYWtlKTtcblxudmFyIF90cmVlID0gX2RlcmVxXygnLi9ub2RlL3RyZWUnKTtcblxudmFyIF90cmFuc2l0aW9ucyA9IF9kZXJlcV8oJy4vdHJhbnNpdGlvbnMnKTtcblxudmFyIF9jdXN0b20gPSBfZGVyZXFfKCcuL2VsZW1lbnQvY3VzdG9tJyk7XG5cbnZhciBfbWVtb3J5ID0gX2RlcmVxXygnLi91dGlsL21lbW9yeScpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vKipcbiAqIFVzZWQgdG8gZGlmZiB0aGUgb3V0ZXJIVE1MIGNvbnRlbnRzIG9mIHRoZSBwYXNzZWQgZWxlbWVudCB3aXRoIHRoZSBtYXJrdXBcbiAqIGNvbnRlbnRzLiAgVmVyeSB1c2VmdWwgZm9yIGFwcGx5aW5nIGEgZ2xvYmFsIGRpZmYgb24gdGhlXG4gKiBgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50YC5cbiAqXG4gKiBAcGFyYW0gZWxlbWVudFxuICogQHBhcmFtIG1hcmt1cD0nJ1xuICogQHBhcmFtIG9wdGlvbnM9e31cbiAqL1xuZnVuY3Rpb24gb3V0ZXJIVE1MKGVsZW1lbnQpIHtcbiAgdmFyIG1hcmt1cCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/ICcnIDogYXJndW1lbnRzWzFdO1xuICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzJdO1xuXG4gIG9wdGlvbnMuaW5uZXIgPSBmYWxzZTtcbiAgKDAsIF9wYXRjaDIuZGVmYXVsdCkoZWxlbWVudCwgbWFya3VwLCBvcHRpb25zKTtcbn1cblxuLyoqXG4gKiBVc2VkIHRvIGRpZmYgdGhlIGlubmVySFRNTCBjb250ZW50cyBvZiB0aGUgcGFzc2VkIGVsZW1lbnQgd2l0aCB0aGUgbWFya3VwXG4gKiBjb250ZW50cy4gIFRoaXMgaXMgdXNlZnVsIHdpdGggbGlicmFyaWVzIGxpa2UgQmFja2JvbmUgdGhhdCByZW5kZXIgVmlld3NcbiAqIGludG8gZWxlbWVudCBjb250YWluZXIuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRcbiAqIEBwYXJhbSBtYXJrdXA9JydcbiAqIEBwYXJhbSBvcHRpb25zPXt9XG4gKi9cbmZ1bmN0aW9uIGlubmVySFRNTChlbGVtZW50KSB7XG4gIHZhciBtYXJrdXAgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyAnJyA6IGFyZ3VtZW50c1sxXTtcbiAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1syXTtcblxuICBvcHRpb25zLmlubmVyID0gdHJ1ZTtcbiAgKDAsIF9wYXRjaDIuZGVmYXVsdCkoZWxlbWVudCwgbWFya3VwLCBvcHRpb25zKTtcbn1cblxuLyoqXG4gKiBVc2VkIHRvIGRpZmYgdHdvIGVsZW1lbnRzLiAgVGhlIGBpbm5lcmAgQm9vbGVhbiBwcm9wZXJ0eSBjYW4gYmUgc3BlY2lmaWVkIGluXG4gKiB0aGUgb3B0aW9ucyB0byBzZXQgaW5uZXJIVE1MXFxvdXRlckhUTUwgYmVoYXZpb3IuICBCeSBkZWZhdWx0IGl0IGlzXG4gKiBvdXRlckhUTUwuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRcbiAqIEBwYXJhbSBuZXdFbGVtZW50XG4gKiBAcGFyYW0gb3B0aW9ucz17fVxuICovXG5mdW5jdGlvbiBlbGVtZW50KGVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcbiAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1syXTtcblxuICAoMCwgX3BhdGNoMi5kZWZhdWx0KShlbGVtZW50LCBuZXdFbGVtZW50LCBvcHRpb25zKTtcbn1cblxuLyoqXG4gKiBSZWxlYXNlcyB0aGUgd29ya2VyIGFuZCBtZW1vcnkgYWxsb2NhdGVkIHRvIHRoaXMgZWxlbWVudC4gVXNlZnVsIGZvclxuICogY2xlYW5pbmcgdXAgY29tcG9uZW50cyB3aGVuIHJlbW92ZWQgaW4gdGVzdHMgYW5kIGFwcGxpY2F0aW9ucy5cbiAqXG4gKiBAcGFyYW0gZWxlbWVudFxuICovXG5mdW5jdGlvbiByZWxlYXNlKGVsZW1lbnQpIHtcbiAgKDAsIF9yZWxlYXNlMi5kZWZhdWx0KShlbGVtZW50KTtcbn1cblxuLy8gU3RvcmUgYSByZWZlcmVuY2UgdG8gdGhlIHJlYWwgYHJlZ2lzdGVyRWxlbWVudGAgbWV0aG9kIGlmIGl0IGV4aXN0cy5cbnZhciByZWFsUmVnaXN0ZXJFbGVtZW50ID0gZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50O1xuXG4vKipcbiAqIFJlZ2lzdGVyJ3MgYSBjb25zdHJ1Y3RvciB3aXRoIGFuIGVsZW1lbnQgdG8gcHJvdmlkZSBsaWZlY3ljbGUgZXZlbnRzLlxuICpcbiAqIEBwYXJhbSB0YWdOYW1lXG4gKiBAcGFyYW0gY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gcmVnaXN0ZXJFbGVtZW50KHRhZ05hbWUsIGNvbnN0cnVjdG9yKSB7XG4gIC8vIFVwZ3JhZGUgc2ltcGxlIG9iamVjdHMgdG8gaW5oZXJpdCBmcm9tIEhUTUxFbGVtZW50IGFuZCBiZSB1c2FibGUgaW4gYSByZWFsXG4gIC8vIGltcGxlbWVudGF0aW9uLlxuICB2YXIgbm9ybWFsaXplZCA9IHR5cGVvZiBjb25zdHJ1Y3RvciA9PT0gJ2Z1bmN0aW9uJyA/IGNvbnN0cnVjdG9yIDogbnVsbDtcblxuICAvLyBJZiB0aGlzIGlzIG5vdCBhIHZhbGlkIGNvbnN0cnVjdG9yLCBjcmVhdGUgb25lLlxuICBpZiAobm9ybWFsaXplZCA9PT0gbnVsbCkge1xuICAgIG5vcm1hbGl6ZWQgPSBmdW5jdGlvbiBIVE1MRWxlbWVudCgpIHt9O1xuICAgIG5vcm1hbGl6ZWQuX19wcm90b19fID0gY29uc3RydWN0b3I7XG4gICAgbm9ybWFsaXplZC5wcm90b3R5cGUgPSBjb25zdHJ1Y3Rvci5wcm90b3R5cGUgfHwgY29uc3RydWN0b3I7XG4gICAgbm9ybWFsaXplZC5wcm90b3R5cGUuX19wcm90b19fID0gSFRNTEVsZW1lbnQucHJvdG90eXBlO1xuICB9XG5cbiAgLy8gSWYgdGhlIG5hdGl2ZSB3ZWIgY29tcG9uZW50IHNwZWNpZmljYXRpb24gaXMgbG9hZGVkLCB1c2UgdGhhdCBpbnN0ZWFkLlxuICBpZiAocmVhbFJlZ2lzdGVyRWxlbWVudCkge1xuICAgIC8vIFN0aWxsIHN0b3JlIHRoZSByZWZlcmVuY2UgaW50ZXJuYWxseSwgc2luY2Ugd2UgdXNlIGl0IHRvIGNpcmN1bXZlbnQgdGhlXG4gICAgLy8gYGlzYCBhdHRyaWJ1dGUgYnVnLlxuICAgIF9jdXN0b20uY29tcG9uZW50c1t0YWdOYW1lXSA9IG5vcm1hbGl6ZWQ7XG4gICAgcmV0dXJuIHJlYWxSZWdpc3RlckVsZW1lbnQuY2FsbChkb2N1bWVudCwgdGFnTmFtZSwgbm9ybWFsaXplZCk7XG4gIH1cblxuICAvLyBJZiB0aGUgZWxlbWVudCBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQsIHJhaXNlIGFuIGVycm9yLlxuICBpZiAodGFnTmFtZSBpbiBfY3VzdG9tLmNvbXBvbmVudHMpIHtcbiAgICB0aHJvdyBuZXcgX2Vycm9ycy5ET01FeGNlcHRpb24oJ1xcbiAgICAgIEZhaWxlZCB0byBleGVjdXRlIFxcJ3JlZ2lzdGVyRWxlbWVudFxcJyBvbiBcXCdEb2N1bWVudFxcJzogUmVnaXN0cmF0aW9uIGZhaWxlZFxcbiAgICAgIGZvciB0eXBlIFxcJycgKyB0YWdOYW1lICsgJ1xcJy4gQSB0eXBlIHdpdGggdGhhdCBuYW1lIGlzIGFscmVhZHkgcmVnaXN0ZXJlZC5cXG4gICAgJyk7XG4gIH1cblxuICAvLyBBc3NpZ24gdGhlIGN1c3RvbSBlbGVtZW50IHJlZmVyZW5jZSB0byB0aGUgY29uc3RydWN0b3IuXG4gIF9jdXN0b20uY29tcG9uZW50c1t0YWdOYW1lXSA9IG5vcm1hbGl6ZWQ7XG59XG5cbi8qKlxuICogQWRkcyBhIGdsb2JhbCB0cmFuc2l0aW9uIGxpc3RlbmVyLiAgV2l0aCBtYW55IGVsZW1lbnRzIHRoaXMgY291bGQgYmUgYW5cbiAqIGV4cGVuc2l2ZSBvcGVyYXRpb24sIHNvIHRyeSB0byBsaW1pdCB0aGUgYW1vdW50IG9mIGxpc3RlbmVycyBhZGRlZCBpZiB5b3UncmVcbiAqIGNvbmNlcm5lZCBhYm91dCBwZXJmb3JtYW5jZS5cbiAqXG4gKiBTaW5jZSB0aGUgY2FsbGJhY2sgdHJpZ2dlcnMgd2l0aCB2YXJpb3VzIGVsZW1lbnRzLCBtb3N0IG9mIHdoaWNoIHlvdVxuICogcHJvYmFibHkgZG9uJ3QgY2FyZSBhYm91dCwgeW91J2xsIHdhbnQgdG8gZmlsdGVyLiAgQSBnb29kIHdheSBvZiBmaWx0ZXJpbmdcbiAqIGlzIHRvIHVzZSB0aGUgRE9NIGBtYXRjaGVzYCBtZXRob2QuICBJdCdzIGZhaXJseSB3ZWxsIHN1cHBvcnRlZFxuICogKGh0dHA6Ly9jYW5pdXNlLmNvbS8jZmVhdD1tYXRjaGVzc2VsZWN0b3IpIGFuZCBtYXkgc3VpdCBtYW55IHByb2plY3RzLiAgSWZcbiAqIHlvdSBuZWVkIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LCBjb25zaWRlciB1c2luZyBqUXVlcnkncyBgaXNgLlxuICpcbiAqIFlvdSBjYW4gZG8gZnVuLCBoaWdobHkgc3BlY2lmaWMsIGZpbHRlcnM6XG4gKlxuICogYWRkVHJhbnNpdGlvblN0YXRlKCdhdHRhY2hlZCcsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAqICAgLy8gRmFkZSBpbiB0aGUgbWFpbiBjb250YWluZXIgYWZ0ZXIgaXQncyBhZGRlZC5cbiAqICAgaWYgKGVsZW1lbnQubWF0Y2hlcygnYm9keSBtYWluLmNvbnRhaW5lcicpKSB7XG4gKiAgICAgJChlbGVtZW50KS5zdG9wKHRydWUsIHRydWUpLmZhZGVJbigpO1xuICogICB9XG4gKiB9KTtcbiAqXG4gKiBAcGFyYW0gc3RhdGUgLSBTdHJpbmcgbmFtZSB0aGF0IG1hdGNoZXMgd2hhdCdzIGF2YWlsYWJsZSBpbiB0aGVcbiAqIGRvY3VtZW50YXRpb24gYWJvdmUuXG4gKiBAcGFyYW0gY2FsbGJhY2sgLSBGdW5jdGlvbiB0byByZWNlaXZlIHRoZSBtYXRjaGluZyBlbGVtZW50cy5cbiAqL1xuZnVuY3Rpb24gYWRkVHJhbnNpdGlvblN0YXRlKHN0YXRlLCBjYWxsYmFjaykge1xuICBpZiAoIXN0YXRlKSB7XG4gICAgdGhyb3cgbmV3IF9lcnJvcnMuVHJhbnNpdGlvblN0YXRlRXJyb3IoJ01pc3NpbmcgdHJhbnNpdGlvbiBzdGF0ZSBuYW1lJyk7XG4gIH1cblxuICBpZiAoIWNhbGxiYWNrKSB7XG4gICAgdGhyb3cgbmV3IF9lcnJvcnMuVHJhbnNpdGlvblN0YXRlRXJyb3IoJ01pc3NpbmcgdHJhbnNpdGlvbiBzdGF0ZSBjYWxsYmFjaycpO1xuICB9XG5cbiAgLy8gTm90IGEgdmFsaWQgc3RhdGUgbmFtZS5cbiAgaWYgKE9iamVjdC5rZXlzKF90cmFuc2l0aW9ucy5zdGF0ZXMpLmluZGV4T2Yoc3RhdGUpID09PSAtMSkge1xuICAgIHRocm93IG5ldyBfZXJyb3JzLlRyYW5zaXRpb25TdGF0ZUVycm9yKCdJbnZhbGlkIHN0YXRlIG5hbWU6ICcgKyBzdGF0ZSk7XG4gIH1cblxuICBfdHJhbnNpdGlvbnMuc3RhdGVzW3N0YXRlXS5wdXNoKGNhbGxiYWNrKTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIGEgZ2xvYmFsIHRyYW5zaXRpb24gbGlzdGVuZXIuXG4gKlxuICogV2hlbiBpbnZva2VkIHdpdGggbm8gYXJndW1lbnRzLCB0aGlzIG1ldGhvZCB3aWxsIHJlbW92ZSBhbGwgdHJhbnNpdGlvblxuICogY2FsbGJhY2tzLiAgV2hlbiBpbnZva2VkIHdpdGggdGhlIG5hbWUgYXJndW1lbnQgaXQgd2lsbCByZW1vdmUgYWxsXG4gKiB0cmFuc2l0aW9uIHN0YXRlIGNhbGxiYWNrcyBtYXRjaGluZyB0aGUgbmFtZSwgYW5kIHNvIG9uIGZvciB0aGUgY2FsbGJhY2suXG4gKlxuICogQHBhcmFtIHN0YXRlIC0gU3RyaW5nIG5hbWUgdGhhdCBtYXRjaGVzIHdoYXQncyBhdmFpbGFibGUgaW4gdGhlXG4gKiBkb2N1bWVudGF0aW9uIGFib3ZlLlxuICogQHBhcmFtIGNhbGxiYWNrIC0gRnVuY3Rpb24gdG8gcmVjZWl2ZSB0aGUgbWF0Y2hpbmcgZWxlbWVudHMuXG4gKi9cbmZ1bmN0aW9uIHJlbW92ZVRyYW5zaXRpb25TdGF0ZShzdGF0ZSwgY2FsbGJhY2spIHtcbiAgaWYgKCFjYWxsYmFjayAmJiBzdGF0ZSkge1xuICAgIF90cmFuc2l0aW9ucy5zdGF0ZXNbc3RhdGVdLmxlbmd0aCA9IDA7XG4gIH0gZWxzZSBpZiAoc3RhdGUgJiYgY2FsbGJhY2spIHtcbiAgICAvLyBOb3QgYSB2YWxpZCBzdGF0ZSBuYW1lLlxuICAgIGlmIChPYmplY3Qua2V5cyhfdHJhbnNpdGlvbnMuc3RhdGVzKS5pbmRleE9mKHN0YXRlKSA9PT0gLTEpIHtcbiAgICAgIHRocm93IG5ldyBfZXJyb3JzLlRyYW5zaXRpb25TdGF0ZUVycm9yKCdJbnZhbGlkIHN0YXRlIG5hbWUgJyArIHN0YXRlKTtcbiAgICB9XG5cbiAgICB2YXIgaW5kZXggPSBfdHJhbnNpdGlvbnMuc3RhdGVzW3N0YXRlXS5pbmRleE9mKGNhbGxiYWNrKTtcbiAgICBfdHJhbnNpdGlvbnMuc3RhdGVzW3N0YXRlXS5zcGxpY2UoaW5kZXgsIDEpO1xuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIF9zdGF0ZSBpbiBfdHJhbnNpdGlvbnMuc3RhdGVzKSB7XG4gICAgICBfdHJhbnNpdGlvbnMuc3RhdGVzW19zdGF0ZV0ubGVuZ3RoID0gMDtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBCeSBjYWxsaW5nIHRoaXMgZnVuY3Rpb24geW91ciBicm93c2VyIGVudmlyb25tZW50IGlzIGVuaGFuY2VkIGdsb2JhbGx5LiBUaGlzXG4gKiBwcm9qZWN0IHdvdWxkIGxvdmUgdG8gaGl0IHRoZSBzdGFuZGFyZHMgdHJhY2sgYW5kIGFsbG93IGFsbCBkZXZlbG9wZXJzIHRvXG4gKiBiZW5lZml0IGZyb20gdGhlIHBlcmZvcm1hbmNlIGdhaW5zIG9mIERPTSBkaWZmaW5nLlxuICovXG5mdW5jdGlvbiBlbmFibGVQcm9sbHlmaWxsKCkge1xuICAvLyBFeHBvc2VzIHRoZSBgVHJhbnNpdGlvblN0YXRlRXJyb3JgIGNvbnN0cnVjdG9yIGdsb2JhbGx5IHNvIHRoYXQgZGV2ZWxvcGVyc1xuICAvLyBjYW4gaW5zdGFuY2VvZiBjaGVjayBleGNlcHRpb24gZXJyb3JzLlxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnVHJhbnNpdGlvblN0YXRlRXJyb3InLCB7XG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuXG4gICAgdmFsdWU6IF9lcnJvcnMuVHJhbnNpdGlvblN0YXRlRXJyb3JcbiAgfSk7XG5cbiAgLy8gQWxsb3dzIGEgZGV2ZWxvcGVyIHRvIGFkZCB0cmFuc2l0aW9uIHN0YXRlIGNhbGxiYWNrcy5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGRvY3VtZW50LCAnYWRkVHJhbnNpdGlvblN0YXRlJywge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblxuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShzdGF0ZSwgY2FsbGJhY2spIHtcbiAgICAgIGFkZFRyYW5zaXRpb25TdGF0ZShzdGF0ZSwgY2FsbGJhY2spO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gQWxsb3dzIGEgZGV2ZWxvcGVyIHRvIHJlbW92ZSB0cmFuc2l0aW9uIHN0YXRlIGNhbGxiYWNrcy5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGRvY3VtZW50LCAncmVtb3ZlVHJhbnNpdGlvblN0YXRlJywge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblxuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShzdGF0ZSwgY2FsbGJhY2spIHtcbiAgICAgIHJlbW92ZVRyYW5zaXRpb25TdGF0ZShzdGF0ZSwgY2FsbGJhY2spO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gRXhwb3NlcyB0aGUgQVBJIGludG8gdGhlIEVsZW1lbnQsIFNoYWRvd0RPTSwgYW5kIERvY3VtZW50RnJhZ21lbnRcbiAgLy8gY29uc3RydWN0b3JzLlxuICBbdHlwZW9mIEVsZW1lbnQgIT09ICd1bmRlZmluZWQnID8gRWxlbWVudCA6IHVuZGVmaW5lZCwgdHlwZW9mIEhUTUxFbGVtZW50ICE9PSAndW5kZWZpbmVkJyA/IEhUTUxFbGVtZW50IDogdW5kZWZpbmVkLCB0eXBlb2YgU2hhZG93Um9vdCAhPT0gJ3VuZGVmaW5lZCcgPyBTaGFkb3dSb290IDogdW5kZWZpbmVkLCB0eXBlb2YgRG9jdW1lbnRGcmFnbWVudCAhPT0gJ3VuZGVmaW5lZCcgPyBEb2N1bWVudEZyYWdtZW50IDogdW5kZWZpbmVkXS5maWx0ZXIoQm9vbGVhbikuZm9yRWFjaChmdW5jdGlvbiAoQ3Rvcikge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDdG9yLnByb3RvdHlwZSwgJ2RpZmZJbm5lckhUTUwnLCB7XG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG5cbiAgICAgIHNldDogZnVuY3Rpb24gc2V0KG5ld0hUTUwpIHtcbiAgICAgICAgaW5uZXJIVE1MKHRoaXMsIG5ld0hUTUwpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQWxsb3dzIGEgZGV2ZWxvcGVyIHRvIHNldCB0aGUgYG91dGVySFRNTGAgb2YgYW4gZWxlbWVudC5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ3Rvci5wcm90b3R5cGUsICdkaWZmT3V0ZXJIVE1MJywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuXG4gICAgICBzZXQ6IGZ1bmN0aW9uIHNldChuZXdIVE1MKSB7XG4gICAgICAgIG91dGVySFRNTCh0aGlzLCBuZXdIVE1MKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEFsbG93cyBhIGRldmVsb3BlciB0byBkaWZmIHRoZSBjdXJyZW50IGVsZW1lbnQgd2l0aCBhIG5ldyBlbGVtZW50LlxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDdG9yLnByb3RvdHlwZSwgJ2RpZmZFbGVtZW50Jywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUobmV3RWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICBlbGVtZW50KHRoaXMsIG5ld0VsZW1lbnQsIG9wdGlvbnMpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gUmVsZWFzZXMgdGhlIHJldGFpbmVkIG1lbW9yeSBhbmQgd29ya2VyIGluc3RhbmNlLlxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDdG9yLnByb3RvdHlwZSwgJ2RpZmZSZWxlYXNlJywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7XG4gICAgICAgICgwLCBfcmVsZWFzZTIuZGVmYXVsdCkodGhpcyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIFBvbHlmaWxsIGluIHRoZSBgcmVnaXN0ZXJFbGVtZW50YCBtZXRob2QgaWYgaXQgZG9lc24ndCBhbHJlYWR5IGV4aXN0LiBUaGlzXG4gIC8vIHJlcXVpcmVzIHBhdGNoaW5nIGBjcmVhdGVFbGVtZW50YCBhcyB3ZWxsIHRvIGVuc3VyZSB0aGF0IHRoZSBwcm9wZXIgcHJvdG9cbiAgLy8gY2hhaW4gZXhpc3RzLlxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnQsICdyZWdpc3RlckVsZW1lbnQnLCB7XG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHRhZ05hbWUsIGNvbXBvbmVudCkge1xuICAgICAgcmVnaXN0ZXJFbGVtZW50KHRhZ05hbWUsIGNvbXBvbmVudCk7XG4gICAgfVxuICB9KTtcblxuICAvLyBJZiBIVE1MRWxlbWVudCBpcyBhbiBvYmplY3QsIHJlamlnZ2VyIGl0IHRvIHdvcmsgbGlrZSBhIGZ1bmN0aW9uIHNvIHRoYXRcbiAgLy8gaXQgY2FuIGJlIGV4dGVuZGVkLiBTcGVjaWZpY2FsbHkgYWZmZWN0cyBJRSBhbmQgU2FmYXJpLlxuICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7XG4gICAgcmV0dXJuIGtleS5pbmRleE9mKCdIVE1MJykgPT09IDAgJiYgX3R5cGVvZih3aW5kb3dba2V5XSkgPT09ICdvYmplY3QnO1xuICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAvLyBGYWxsIGJhY2sgdG8gdGhlIEVsZW1lbnQgY29uc3RydWN0b3IgaWYgdGhlIEhUTUxFbGVtZW50IGRvZXMgbm90IGV4aXN0LlxuICAgIHZhciByZWFsRWxlbWVudCA9IHdpbmRvd1trZXldO1xuXG4gICAgLy8gSWYgdGhlcmUgaXMgbm8gYF9fcHJvdG9fX2AgYXZhaWxhYmxlLCBhZGQgb25lIHRvIHRoZSBwcm90b3R5cGUuXG4gICAgaWYgKCFyZWFsRWxlbWVudC5fX3Byb3RvX18pIHtcbiAgICAgIHZhciBjb3B5ID0ge1xuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWwpIHtcbiAgICAgICAgICB2YWwgPSBPYmplY3Qua2V5cyh2YWwpLmxlbmd0aCA/IHZhbCA6IE9iamVjdC5nZXRQcm90b3R5cGVPZih2YWwpO1xuXG4gICAgICAgICAgZm9yICh2YXIgX2tleSBpbiB2YWwpIHtcbiAgICAgICAgICAgIGlmICh2YWwuaGFzT3duUHJvcGVydHkoX2tleSkpIHtcbiAgICAgICAgICAgICAgdGhpc1tfa2V5XSA9IHZhbFtfa2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZWFsRWxlbWVudCwgJ19fcHJvdG9fXycsIGNvcHkpO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlYWxFbGVtZW50LnByb3RvdHlwZSwgJ19fcHJvdG9fXycsIGNvcHkpO1xuICAgIH1cblxuICAgIHZhciBFbGVtZW50ID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gZnVuY3Rpb24gJyArIGtleSArICcoKSB7fTsnKSgpO1xuICAgIEVsZW1lbnQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShyZWFsRWxlbWVudC5wcm90b3R5cGUpO1xuICAgIEVsZW1lbnQuX19wcm90b19fID0gcmVhbEVsZW1lbnQ7XG5cbiAgICAvLyBFbnN1cmUgdGhhdCB0aGUgZ2xvYmFsIEVsZW1lbnQgbWF0Y2hlcyB0aGUgSFRNTEVsZW1lbnQuXG4gICAgd2luZG93W2tleV0gPSBFbGVtZW50O1xuICB9KTtcblxuICAvKipcbiAgICogV2lsbCBhdXRvbWF0aWNhbGx5IGFjdGl2YXRlIGFueSBjb21wb25lbnRzIGZvdW5kIGluIHRoZSBwYWdlIGF1dG9tYXRpY2FsbHlcbiAgICogYWZ0ZXIgY2FsbGluZyBgZW5hYmxlUHJvbGx5ZmlsbGAuIFRoaXMgaXMgdXNlZnVsIHRvIHNpbXVsYXRlIGEgcmVhbC13b3JsZFxuICAgKiB1c2FnZSBvZiBDdXN0b20gRWxlbWVudHMuXG4gICAqL1xuICB2YXIgYWN0aXZhdGVDb21wb25lbnRzID0gZnVuY3Rpb24gYWN0aXZhdGVDb21wb25lbnRzKCkge1xuICAgIHZhciBkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgdmFyIGJ1ZmZlclNldCA9IGZhbHNlO1xuXG4gICAgLy8gSWYgdGhpcyBlbGVtZW50IGlzIGFscmVhZHkgcmVuZGVyaW5nLCBhZGQgdGhpcyBuZXcgcmVuZGVyIHJlcXVlc3QgaW50b1xuICAgIC8vIHRoZSBidWZmZXIgcXVldWUuIENoZWNrIGFuZCBzZWUgaWYgYW55IGVsZW1lbnQgaXMgY3VycmVudGx5IHJlbmRlcmluZyxcbiAgICAvLyBjYW4gb25seSBkbyBvbmUgYXQgYSB0aW1lLlxuICAgIF90cmVlLlRyZWVDYWNoZS5mb3JFYWNoKGZ1bmN0aW9uIGl0ZXJhdGVUcmVlQ2FjaGUoZWxlbWVudE1ldGEsIGVsZW1lbnQpIHtcbiAgICAgIGlmIChlbGVtZW50TWV0YS5pc1JlbmRlcmluZykge1xuICAgICAgICBidWZmZXJTZXQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gU2hvcnQgY2lyY3VpdCB0aGUgcmVzdCBvZiB0aGlzIHJlbmRlci5cbiAgICBpZiAoYnVmZmVyU2V0KSB7XG4gICAgICAvLyBSZW1vdmUgdGhlIGxvYWQgZXZlbnQgbGlzdGVuZXIsIHNpbmNlIGl0J3MgY29tcGxldGUuXG4gICAgICByZXR1cm4gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBhY3RpdmF0ZUNvbXBvbmVudHMpO1xuICAgIH1cblxuICAgIHZhciBkZXNjcmlwdG9yID0gKDAsIF9tYWtlMi5kZWZhdWx0KShkb2N1bWVudEVsZW1lbnQpO1xuXG4gICAgLy8gQWZ0ZXIgdGhlIGluaXRpYWwgcmVuZGVyLCBjbGVhbiB1cCB0aGUgcmVzb3VyY2VzLCBubyBwb2ludCBpbiBsaW5nZXJpbmcuXG4gICAgZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3JlbmRlckNvbXBsZXRlJywgZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIGVsZW1lbnRNZXRhID0gX3RyZWUuVHJlZUNhY2hlLmdldChkb2N1bWVudEVsZW1lbnQpIHx8IHt9O1xuXG4gICAgICAvLyBSZWxlYXNlIHJlc291cmNlcyBhbGxvY2F0ZWQgdG8gdGhlIGVsZW1lbnQuXG4gICAgICBpZiAoIWVsZW1lbnRNZXRhLmlzUmVuZGVyaW5nKSB7XG5cbiAgICAgICAgLy8gVW5wcm90ZWN0IGFmdGVyIHRoZSBhY3RpdmF0aW9uIGlzIGNvbXBsZXRlLlxuICAgICAgICAoMCwgX21lbW9yeS51bnByb3RlY3RFbGVtZW50KShkZXNjcmlwdG9yLCBfbWFrZTIuZGVmYXVsdCk7XG4gICAgICAgIGRvY3VtZW50RWxlbWVudC5kaWZmUmVsZWFzZShkb2N1bWVudEVsZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICAvLyBSZW1vdmUgdGhpcyBldmVudCBsaXN0ZW5lci5cbiAgICAgIGRvY3VtZW50RWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdyZW5kZXJDb21wbGV0ZScsIHJlbmRlcik7XG4gICAgfSk7XG5cbiAgICAvLyBQcm90ZWN0IHRoZSBkb2N1bWVudEVsZW1lbnQgYmVmb3JlIGFwcGx5aW5nIHRoZSBjaGFuZ2VzLlxuICAgICgwLCBfbWVtb3J5LnByb3RlY3RFbGVtZW50KShkZXNjcmlwdG9yKTtcblxuICAgIC8vIERpZmYgdGhlIGVudGlyZSBkb2N1bWVudCBvbiBhY3RpdmF0aW9uIG9mIHRoZSBwcm9sbHlmaWxsLlxuICAgIGRvY3VtZW50RWxlbWVudC5kaWZmT3V0ZXJIVE1MID0gZG9jdW1lbnRFbGVtZW50Lm91dGVySFRNTDtcblxuICAgIC8vIFJlbW92ZSB0aGUgbG9hZCBldmVudCBsaXN0ZW5lciwgc2luY2UgaXQncyBjb21wbGV0ZS5cbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbG9hZCcsIGFjdGl2YXRlQ29tcG9uZW50cyk7XG4gIH07XG5cbiAgLy8gSWYgdGhlIGRvY3VtZW50IGhhcyBhbHJlYWR5IGxvYWRlZCwgaW1tZWRpYXRlbHkgYWN0aXZhdGUgdGhlIGNvbXBvbmVudHMuXG4gIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnY29tcGxldGUnKSB7XG4gICAgYWN0aXZhdGVDb21wb25lbnRzKCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gVGhpcyBzZWN0aW9uIHdpbGwgYXV0b21hdGljYWxseSBwYXJzZSBvdXQgeW91ciBlbnRpcmUgcGFnZSB0byBlbnN1cmUgYWxsXG4gICAgLy8gY3VzdG9tIGVsZW1lbnRzIGFyZSBob29rZWQgaW50by5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGFjdGl2YXRlQ29tcG9uZW50cyk7XG4gIH1cbn1cblxufSx7XCIuL2VsZW1lbnQvY3VzdG9tXCI6MSxcIi4vZXJyb3JzXCI6NCxcIi4vbm9kZS9tYWtlXCI6NixcIi4vbm9kZS9wYXRjaFwiOjcsXCIuL25vZGUvcmVsZWFzZVwiOjgsXCIuL25vZGUvdHJlZVwiOjEwLFwiLi90cmFuc2l0aW9uc1wiOjEzLFwiLi91dGlsL21lbW9yeVwiOjE1fV0sNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBtYWtlO1xuXG52YXIgX3Bvb2xzMiA9IF9kZXJlcV8oJy4uL3V0aWwvcG9vbHMnKTtcblxudmFyIF9jdXN0b20gPSBfZGVyZXFfKCcuLi9lbGVtZW50L2N1c3RvbScpO1xuXG52YXIgcG9vbHMgPSBfcG9vbHMyLnBvb2xzO1xudmFyIGVtcHR5ID0ge307XG5cbi8vIENhY2hlIGNyZWF0ZWQgbm9kZXMgaW5zaWRlIHRoaXMgb2JqZWN0LlxubWFrZS5ub2RlcyA9IHt9O1xuXG4vKipcbiAqIENvbnZlcnRzIGEgbGl2ZSBub2RlIGludG8gYSB2aXJ0dWFsIG5vZGUuXG4gKlxuICogQHBhcmFtIG5vZGVcbiAqIEByZXR1cm5cbiAqL1xuZnVuY3Rpb24gbWFrZShub2RlKSB7XG4gIHZhciBub2RlVHlwZSA9IG5vZGUubm9kZVR5cGU7XG5cbiAgLy8gV2hpdGVsaXN0OiBFbGVtZW50cywgVGV4dE5vZGVzLCBhbmQgU2hhZG93IFJvb3QuXG4gIGlmIChub2RlVHlwZSAhPT0gMSAmJiBub2RlVHlwZSAhPT0gMyAmJiBub2RlVHlwZSAhPT0gMTEpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBWaXJ0dWFsIHJlcHJlc2VudGF0aW9uIG9mIGEgbm9kZSwgY29udGFpbmluZyBvbmx5IHRoZSBkYXRhIHdlIHdpc2ggdG9cbiAgLy8gZGlmZiBhbmQgcGF0Y2guXG4gIHZhciBlbnRyeSA9IHBvb2xzLmVsZW1lbnRPYmplY3QuZ2V0KCk7XG5cbiAgLy8gQXNzb2NpYXRlIHRoaXMgbmV3bHkgYWxsb2NhdGVkIHV1aWQgd2l0aCB0aGlzIE5vZGUuXG4gIG1ha2Uubm9kZXNbZW50cnkudXVpZF0gPSBub2RlO1xuXG4gIC8vIFNldCBhIGxvd2VyY2FzZWQgKG5vcm1hbGl6ZWQpIHZlcnNpb24gb2YgdGhlIGVsZW1lbnQncyBub2RlTmFtZS5cbiAgZW50cnkubm9kZU5hbWUgPSBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgLy8gSWYgdGhlIGVsZW1lbnQgaXMgYSB0ZXh0IG5vZGUgc2V0IHRoZSBub2RlVmFsdWUuXG4gIGlmIChub2RlVHlwZSA9PT0gMykge1xuICAgIGVudHJ5Lm5vZGVWYWx1ZSA9IG5vZGUudGV4dENvbnRlbnQ7XG4gIH0gZWxzZSB7XG4gICAgZW50cnkubm9kZVZhbHVlID0gJyc7XG4gIH1cblxuICBlbnRyeS5jaGlsZE5vZGVzLmxlbmd0aCA9IDA7XG4gIGVudHJ5LmF0dHJpYnV0ZXMubGVuZ3RoID0gMDtcblxuICAvLyBDb2xsZWN0IGF0dHJpYnV0ZXMuXG4gIHZhciBhdHRyaWJ1dGVzID0gbm9kZS5hdHRyaWJ1dGVzO1xuXG4gIC8vIElmIHRoZSBlbGVtZW50IGhhcyBubyBhdHRyaWJ1dGVzLCBza2lwIG92ZXIuXG4gIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgdmFyIGF0dHJpYnV0ZXNMZW5ndGggPSBhdHRyaWJ1dGVzLmxlbmd0aDtcblxuICAgIGlmIChhdHRyaWJ1dGVzTGVuZ3RoKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGF0dHJpYnV0ZXNMZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYXR0ciA9IHBvb2xzLmF0dHJpYnV0ZU9iamVjdC5nZXQoKTtcblxuICAgICAgICBhdHRyLm5hbWUgPSBhdHRyaWJ1dGVzW2ldLm5hbWU7XG4gICAgICAgIGF0dHIudmFsdWUgPSBhdHRyaWJ1dGVzW2ldLnZhbHVlO1xuXG4gICAgICAgIGVudHJ5LmF0dHJpYnV0ZXNbZW50cnkuYXR0cmlidXRlcy5sZW5ndGhdID0gYXR0cjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBDb2xsZWN0IGNoaWxkTm9kZXMuXG4gIHZhciBjaGlsZE5vZGVzID0gbm9kZS5jaGlsZE5vZGVzID8gbm9kZS5jaGlsZE5vZGVzIDogW107XG4gIHZhciBjaGlsZE5vZGVzTGVuZ3RoID0gY2hpbGROb2Rlcy5sZW5ndGg7XG5cbiAgLy8gSWYgdGhlIGVsZW1lbnQgaGFzIGNoaWxkIG5vZGVzLCBjb252ZXJ0IHRoZW0gYWxsIHRvIHZpcnR1YWwgbm9kZXMuXG4gIGlmIChub2RlVHlwZSAhPT0gMyAmJiBjaGlsZE5vZGVzTGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGNoaWxkTm9kZXNMZW5ndGg7IF9pKyspIHtcbiAgICAgIHZhciBuZXdOb2RlID0gbWFrZShjaGlsZE5vZGVzW19pXSk7XG5cbiAgICAgIGlmIChuZXdOb2RlKSB7XG4gICAgICAgIGVudHJ5LmNoaWxkTm9kZXNbZW50cnkuY2hpbGROb2Rlcy5sZW5ndGhdID0gbmV3Tm9kZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBQcnVuZSBvdXQgd2hpdGVzcGFjZSBmcm9tIGJldHdlZW4gSFRNTCB0YWdzIGluIG1hcmt1cC5cbiAgaWYgKGVudHJ5Lm5vZGVOYW1lID09PSAnaHRtbCcpIHtcbiAgICBlbnRyeS5jaGlsZE5vZGVzID0gZW50cnkuY2hpbGROb2Rlcy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7XG4gICAgICByZXR1cm4gZWwubm9kZU5hbWUgPT09ICdoZWFkJyB8fCBlbC5ub2RlTmFtZSA9PT0gJ2JvZHknO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gUmVzZXQgdGhlIHByb3RvdHlwZSBjaGFpbiBmb3IgdGhpcyBlbGVtZW50LiBVcGdyYWRlIHdpbGwgcmV0dXJuIGB0cnVlYFxuICAvLyBpZiB0aGUgZWxlbWVudCB3YXMgdXBncmFkZWQgZm9yIHRoZSBmaXJzdCB0aW1lLiBUaGlzIGlzIHVzZWZ1bCBzbyB3ZVxuICAvLyBkb24ndCBlbmQgdXAgaW4gYSBsb29wIHdoZW4gd29ya2luZyB3aXRoIHRoZSBzYW1lIGVsZW1lbnQuXG4gICgwLCBfY3VzdG9tLnVwZ3JhZGUpKGVudHJ5Lm5vZGVOYW1lLCBub2RlLCBlbnRyeSwgdHJ1ZSk7XG5cbiAgcmV0dXJuIGVudHJ5O1xufVxuXG59LHtcIi4uL2VsZW1lbnQvY3VzdG9tXCI6MSxcIi4uL3V0aWwvcG9vbHNcIjoxN31dLDc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gcGF0Y2hOb2RlO1xuXG52YXIgX2NyZWF0ZSA9IF9kZXJlcV8oJy4uL3dvcmtlci9jcmVhdGUnKTtcblxudmFyIF9tZW1vcnkgPSBfZGVyZXFfKCcuLi91dGlsL21lbW9yeScpO1xuXG52YXIgX3BhcnNlciA9IF9kZXJlcV8oJy4uL3V0aWwvcGFyc2VyJyk7XG5cbnZhciBfcmVuZGVyID0gX2RlcmVxXygnLi4vdXRpbC9yZW5kZXInKTtcblxudmFyIF9tYWtlID0gX2RlcmVxXygnLi9tYWtlJyk7XG5cbnZhciBfbWFrZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tYWtlKTtcblxudmFyIF9wcm9jZXNzID0gX2RlcmVxXygnLi4vcGF0Y2hlcy9wcm9jZXNzJyk7XG5cbnZhciBfcHJvY2VzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9jZXNzKTtcblxudmFyIF9zeW5jID0gX2RlcmVxXygnLi9zeW5jJyk7XG5cbnZhciBfc3luYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zeW5jKTtcblxudmFyIF90cmVlID0gX2RlcmVxXygnLi90cmVlJyk7XG5cbnZhciBfcG9vbHMgPSBfZGVyZXFfKCcuLi91dGlsL3Bvb2xzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8qKlxuICogUGF0Y2hlcyBhbiBlbGVtZW50J3MgRE9NIHRvIG1hdGNoIHRoYXQgb2YgdGhlIHBhc3NlZCBtYXJrdXAuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRcbiAqIEBwYXJhbSBuZXdIVE1MXG4gKi9cbmZ1bmN0aW9uIHBhdGNoTm9kZShlbGVtZW50LCBuZXdIVE1MLCBvcHRpb25zKSB7XG4gIC8vIEVuc3VyZSB0aGF0IHRoZSBkb2N1bWVudCBkaXNhYmxlIHdvcmtlciBpcyBhbHdheXMgcGlja2VkIHVwLlxuICBpZiAodHlwZW9mIG9wdGlvbnMuZW5hYmxlV29ya2VyICE9PSAnYm9vbGVhbicpIHtcbiAgICBvcHRpb25zLmVuYWJsZVdvcmtlciA9IGRvY3VtZW50LkVOQUJMRV9XT1JLRVI7XG4gIH1cblxuICAvLyBUaGUgZWxlbWVudCBtZXRhIG9iamVjdCBpcyBhIGxvY2F0aW9uIHRvIGFzc29jaWF0ZSBtZXRhZGF0YSB3aXRoIHRoZVxuICAvLyBjdXJyZW50bHkgcmVuZGVyaW5nIGVsZW1lbnQuIFRoaXMgcHJldmVudHMgYXR0YWNoaW5nIHByb3BlcnRpZXMgdG8gdGhlXG4gIC8vIGluc3RhbmNlIGl0c2VsZi5cbiAgdmFyIGVsZW1lbnRNZXRhID0gX3RyZWUuVHJlZUNhY2hlLmdldChlbGVtZW50KSB8fCB7fTtcblxuICAvLyBMYXN0IG9wdGlvbnMgdXNlZC5cbiAgZWxlbWVudE1ldGEub3B0aW9ucyA9IG9wdGlvbnM7XG5cbiAgLy8gQWx3YXlzIGVuc3VyZSB0aGUgbW9zdCB1cC10by1kYXRlIG1ldGEgb2JqZWN0IGlzIHN0b3JlZC5cbiAgX3RyZWUuVHJlZUNhY2hlLnNldChlbGVtZW50LCBlbGVtZW50TWV0YSk7XG5cbiAgdmFyIGJ1ZmZlclNldCA9IGZhbHNlO1xuICB2YXIgaXNJbm5lciA9IG9wdGlvbnMuaW5uZXI7XG4gIHZhciBwcmV2aW91c01hcmt1cCA9IGVsZW1lbnRNZXRhLnByZXZpb3VzTWFya3VwO1xuXG4gIC8vIElmIHRoaXMgZWxlbWVudCBpcyBhbHJlYWR5IHJlbmRlcmluZywgYWRkIHRoaXMgbmV3IHJlbmRlciByZXF1ZXN0IGludG8gdGhlXG4gIC8vIGJ1ZmZlciBxdWV1ZS4gQ2hlY2sgYW5kIHNlZSBpZiBhbnkgZWxlbWVudCBpcyBjdXJyZW50bHkgcmVuZGVyaW5nLCBjYW5cbiAgLy8gb25seSBkbyBvbmUgYXQgYSB0aW1lLlxuICBfdHJlZS5UcmVlQ2FjaGUuZm9yRWFjaChmdW5jdGlvbiBpdGVyYXRlVHJlZUNhY2hlKF9lbGVtZW50TWV0YSwgX2VsZW1lbnQpIHtcbiAgICBpZiAoX2VsZW1lbnRNZXRhLmlzUmVuZGVyaW5nKSB7XG4gICAgICBlbGVtZW50TWV0YS5yZW5kZXJCdWZmZXIgPSB7IGVsZW1lbnQ6IGVsZW1lbnQsIG5ld0hUTUw6IG5ld0hUTUwsIG9wdGlvbnM6IG9wdGlvbnMgfTtcbiAgICAgIGJ1ZmZlclNldCA9IHRydWU7XG4gICAgfVxuICB9KTtcblxuICAvLyBTaG9ydCBjaXJjdWl0IHRoZSByZXN0IG9mIHRoaXMgcmVuZGVyLlxuICBpZiAoYnVmZmVyU2V0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHNhbWVJbm5lckhUTUwgPSBpc0lubmVyID8gcHJldmlvdXNNYXJrdXAgPT09IGVsZW1lbnQuaW5uZXJIVE1MIDogdHJ1ZTtcbiAgdmFyIHNhbWVPdXRlckhUTUwgPSAhaXNJbm5lciA/IHByZXZpb3VzTWFya3VwID09PSBlbGVtZW50Lm91dGVySFRNTCA6IHRydWU7XG4gIHZhciBzYW1lVGV4dENvbnRlbnQgPSBlbGVtZW50TWV0YS5fdGV4dENvbnRlbnQgPT09IGVsZW1lbnQudGV4dENvbnRlbnQ7XG5cbiAgLy8gSWYgdGhlIGNvbnRlbnRzIGhhdmVuJ3QgY2hhbmdlZCwgYWJvcnQsIHNpbmNlIHRoZXJlIGlzIG5vIHBvaW50IGluXG4gIC8vIGNvbnRpbnVpbmcuXG4gIGlmIChlbGVtZW50TWV0YS5uZXdIVE1MID09PSBuZXdIVE1MKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gQXNzb2NpYXRlIHRoZSBsYXN0IG1hcmt1cCByZW5kZXJlZCB3aXRoIHRoaXMgZWxlbWVudC5cbiAgZWxlbWVudE1ldGEubmV3SFRNTCA9IG5ld0hUTUw7XG5cbiAgLy8gU3RhcnQgd2l0aCB3b3JrZXIgYmVpbmcgYSBmYWxzeSB2YWx1ZS5cbiAgdmFyIHdvcmtlciA9IG51bGw7XG5cbiAgLy8gSWYgd2UgY2FuIHVzZSBhIHdvcmtlciBhbmQgdGhlIHVzZXIgd2FudHMgb25lLCB0cnkgYW5kIGNyZWF0ZSBpdC5cbiAgaWYgKG9wdGlvbnMuZW5hYmxlV29ya2VyICYmIF9jcmVhdGUuaGFzV29ya2VyKSB7XG4gICAgLy8gQ3JlYXRlIGEgd29ya2VyIGZvciB0aGlzIGVsZW1lbnQuXG4gICAgd29ya2VyID0gZWxlbWVudE1ldGEud29ya2VyID0gZWxlbWVudE1ldGEud29ya2VyIHx8ICgwLCBfY3JlYXRlLmNyZWF0ZSkoKTtcbiAgfVxuXG4gIHZhciByZWJ1aWxkVHJlZSA9IGZ1bmN0aW9uIHJlYnVpbGRUcmVlKCkge1xuICAgIHZhciBvbGRUcmVlID0gZWxlbWVudE1ldGEub2xkVHJlZTtcblxuICAgIGlmIChvbGRUcmVlKSB7XG4gICAgICAoMCwgX21lbW9yeS51bnByb3RlY3RFbGVtZW50KShvbGRUcmVlLCBfbWFrZTIuZGVmYXVsdCk7XG4gICAgICAoMCwgX21lbW9yeS5jbGVhbk1lbW9yeSkoX21ha2UyLmRlZmF1bHQpO1xuICAgIH1cblxuICAgIGVsZW1lbnRNZXRhLm9sZFRyZWUgPSAoMCwgX21lbW9yeS5wcm90ZWN0RWxlbWVudCkoKDAsIF9tYWtlMi5kZWZhdWx0KShlbGVtZW50KSk7XG4gICAgZWxlbWVudE1ldGEudXBkYXRlV29ya2VyVHJlZSA9IHRydWU7XG4gIH07XG5cbiAgLy8gVGhlIGxhc3QgcmVuZGVyIHdhcyBkb25lIHZpYSBXb3JrZXIsIGJ1dCBub3cgd2UncmUgcmVuZGVyaW5nIGluIHRoZSBVSVxuICAvLyB0aHJlYWQuIFRoaXMgaXMgdmVyeSB1bmNvbW1vbiwgYnV0IHdlIG5lZWQgdG8gZW5zdXJlIHRyZWVzIHN0YXkgaW4gc3luYy5cbiAgaWYgKGVsZW1lbnRNZXRhLnJlbmRlcmVkVmlhV29ya2VyID09PSB0cnVlICYmICFvcHRpb25zLmVuYWJsZVdvcmtlcikge1xuICAgIHJlYnVpbGRUcmVlKCk7XG4gIH1cblxuICBpZiAoIXNhbWVJbm5lckhUTUwgfHwgIXNhbWVPdXRlckhUTUwgfHwgIXNhbWVUZXh0Q29udGVudCkge1xuICAgIHJlYnVpbGRUcmVlKCk7XG4gIH1cblxuICAvLyBXaWxsIHdhbnQgdG8gZW5zdXJlIHRoYXQgdGhlIGZpcnN0IHJlbmRlciB3ZW50IHRocm91Z2gsIHRoZSB3b3JrZXIgY2FuXG4gIC8vIHRha2UgYSBiaXQgdG8gc3RhcnR1cCBhbmQgd2Ugd2FudCB0byBzaG93IGNoYW5nZXMgYXMgc29vbiBhcyBwb3NzaWJsZS5cbiAgaWYgKG9wdGlvbnMuZW5hYmxlV29ya2VyICYmIF9jcmVhdGUuaGFzV29ya2VyICYmIHdvcmtlcikge1xuICAgIC8vIFNldCBhIHJlbmRlciBsb2NrIGFzIHRvIG5vdCBmbG9vZCB0aGUgd29ya2VyLlxuICAgIGVsZW1lbnRNZXRhLmlzUmVuZGVyaW5nID0gdHJ1ZTtcbiAgICBlbGVtZW50TWV0YS5yZW5kZXJlZFZpYVdvcmtlciA9IHRydWU7XG4gICAgZWxlbWVudE1ldGEud29ya2VyQ2FjaGUgPSBlbGVtZW50TWV0YS53b3JrZXJDYWNoZSB8fCBbXTtcblxuICAgIC8vIEF0dGFjaCBhbGwgcHJvcGVydGllcyBoZXJlIHRvIHRyYW5zcG9ydC5cbiAgICB2YXIgdHJhbnNmZXJPYmplY3QgPSB7fTtcblxuICAgIC8vIFRoaXMgc2hvdWxkIG9ubHkgb2NjdXIgb25jZSwgb3Igd2hlbmV2ZXIgdGhlIG1hcmt1cCBjaGFuZ2VzIGV4dGVybmFsbHlcbiAgICAvLyB0byBkaWZmSFRNTC5cbiAgICBpZiAoIWVsZW1lbnRNZXRhLmhhc1dvcmtlclJlbmRlcmVkIHx8IGVsZW1lbnRNZXRhLnVwZGF0ZVdvcmtlclRyZWUpIHtcbiAgICAgIHRyYW5zZmVyT2JqZWN0Lm9sZFRyZWUgPSBlbGVtZW50TWV0YS5vbGRUcmVlO1xuICAgICAgZWxlbWVudE1ldGEudXBkYXRlV29ya2VyVHJlZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFdhaXQgZm9yIHRoZSB3b3JrZXIgdG8gZmluaXNoIHByb2Nlc3NpbmcgYW5kIHRoZW4gYXBwbHkgdGhlIHBhdGNoc2V0LlxuICAgIHdvcmtlci5vbm1lc3NhZ2UgPSBmdW5jdGlvbiBvbm1lc3NhZ2UoZXYpIHtcbiAgICAgIHZhciB3cmFwUmVuZGVyID0gZnVuY3Rpb24gd3JhcFJlbmRlcihjYikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGVsZW1lbnRNZXRhLmhhc1dvcmtlclJlbmRlcmVkID0gdHJ1ZTtcbiAgICAgICAgICBjYigpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIHZhciBpbnZva2VSZW5kZXIgPSB3cmFwUmVuZGVyKCgwLCBfcmVuZGVyLmNvbXBsZXRlUmVuZGVyKShlbGVtZW50LCBlbGVtZW50TWV0YSkpO1xuXG4gICAgICAvLyBXYWl0IHVudGlsIGFsbCBwcm9taXNlcyBoYXZlIHJlc29sdmVkLCBiZWZvcmUgZmluaXNoaW5nIHVwIHRoZSBwYXRjaFxuICAgICAgLy8gY3ljbGUuICBQcm9jZXNzIHRoZSBkYXRhIGltbWVkaWF0ZWx5IGFuZCB3YWl0IHVudGlsIGFsbCB0cmFuc2l0aW9uXG4gICAgICAvLyBjYWxsYmFja3MgaGF2ZSBjb21wbGV0ZWQuXG4gICAgICB2YXIgcHJvbWlzZXMgPSAoMCwgX3Byb2Nlc3MyLmRlZmF1bHQpKGVsZW1lbnQsIGV2LmRhdGEucGF0Y2hlcyk7XG5cbiAgICAgIC8vIE9wZXJhdGUgc3luY2hyb25vdXNseSB1bmxlc3Mgb3B0ZWQgaW50byBhIFByb21pc2UtY2hhaW4uXG4gICAgICBpZiAocHJvbWlzZXMubGVuZ3RoKSB7XG4gICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGludm9rZVJlbmRlciwgZnVuY3Rpb24gKGV4KSB7XG4gICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGV4KTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnZva2VSZW5kZXIoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKHR5cGVvZiBuZXdIVE1MICE9PSAnc3RyaW5nJykge1xuICAgICAgdHJhbnNmZXJPYmplY3QubmV3VHJlZSA9ICgwLCBfbWFrZTIuZGVmYXVsdCkobmV3SFRNTCk7XG5cbiAgICAgIC8vIFRyYW5zZmVyIHRoaXMgYnVmZmVyIHRvIHRoZSB3b3JrZXIsIHdoaWNoIHdpbGwgdGFrZSBvdmVyIGFuZCBwcm9jZXNzXG4gICAgICAvLyB0aGUgbWFya3VwLlxuICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHRyYW5zZmVyT2JqZWN0KTtcblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIExldCB0aGUgYnJvd3NlciBjb3B5IHRoZSBIVE1MIGludG8gdGhlIHdvcmtlciwgY29udmVydGluZyB0byBhXG4gICAgLy8gdHJhbnNmZXJhYmxlIG9iamVjdCBpcyB0b28gZXhwZW5zaXZlLlxuICAgIHRyYW5zZmVyT2JqZWN0Lm5ld0hUTUwgPSBuZXdIVE1MO1xuXG4gICAgLy8gQWRkIHByb3BlcnRpZXMgdG8gc2VuZCB0byB3b3JrZXIuXG4gICAgdHJhbnNmZXJPYmplY3QuaXNJbm5lciA9IG9wdGlvbnMuaW5uZXI7XG5cbiAgICAvLyBUcmFuc2ZlciB0aGlzIGJ1ZmZlciB0byB0aGUgd29ya2VyLCB3aGljaCB3aWxsIHRha2Ugb3ZlciBhbmQgcHJvY2VzcyB0aGVcbiAgICAvLyBtYXJrdXAuXG4gICAgd29ya2VyLnBvc3RNZXNzYWdlKHRyYW5zZmVyT2JqZWN0KTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoZWxlbWVudE1ldGEucmVuZGVyZWRWaWFXb3JrZXIgJiYgZWxlbWVudE1ldGEub2xkVHJlZSkge1xuICAgICAgcmVidWlsZFRyZWUoKTtcbiAgICB9XG5cbiAgICBpZiAoZWxlbWVudE1ldGEud29ya2VyQ2FjaGUpIHtcbiAgICAgIGVsZW1lbnRNZXRhLndvcmtlckNhY2hlLmZvckVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgcmV0dXJuICgwLCBfbWVtb3J5LnVucHJvdGVjdEVsZW1lbnQpKHgsIF9tYWtlMi5kZWZhdWx0KTtcbiAgICAgIH0pO1xuICAgICAgZGVsZXRlIGVsZW1lbnRNZXRhLndvcmtlckNhY2hlO1xuICAgIH1cblxuICAgIC8vIFdlJ3JlIHJlbmRlcmluZyBpbiB0aGUgVUkgdGhyZWFkLlxuICAgIGVsZW1lbnRNZXRhLmlzUmVuZGVyaW5nID0gdHJ1ZTtcblxuICAgIC8vIFdoZW5ldmVyIHdlIHJlbmRlciBpbiB0aGUgVUktdGhyZWFkLCBlbnN1cmUgdGhhdCB0aGUgV29ya2VyIGdldHMgYVxuICAgIC8vIHJlZnJlc2hlZCBjb3B5IG9mIHRoZSBgb2xkVHJlZWAuXG4gICAgZWxlbWVudE1ldGEudXBkYXRlV29ya2VyVHJlZSA9IHRydWU7XG5cbiAgICB2YXIgbmV3VHJlZSA9IG51bGw7XG5cbiAgICBpZiAodHlwZW9mIG5ld0hUTUwgPT09ICdzdHJpbmcnKSB7XG4gICAgICBuZXdUcmVlID0gKDAsIF9wYXJzZXIucGFyc2VIVE1MKShuZXdIVE1MLCBvcHRpb25zLmlubmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmV3VHJlZSA9ICgwLCBfbWFrZTIuZGVmYXVsdCkobmV3SFRNTCk7XG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnMuaW5uZXIpIHtcbiAgICAgIHZhciBjaGlsZE5vZGVzID0gQXJyYXkuaXNBcnJheShuZXdUcmVlKSA/IG5ld1RyZWUgOiBbbmV3VHJlZV07XG5cbiAgICAgIG5ld1RyZWUgPSB7XG4gICAgICAgIGNoaWxkTm9kZXM6IGNoaWxkTm9kZXMsXG4gICAgICAgIGF0dHJpYnV0ZXM6IGVsZW1lbnRNZXRhLm9sZFRyZWUuYXR0cmlidXRlcyxcbiAgICAgICAgdXVpZDogZWxlbWVudE1ldGEub2xkVHJlZS51dWlkLFxuICAgICAgICBub2RlTmFtZTogZWxlbWVudE1ldGEub2xkVHJlZS5ub2RlTmFtZSxcbiAgICAgICAgbm9kZVZhbHVlOiBlbGVtZW50TWV0YS5vbGRUcmVlLm5vZGVWYWx1ZVxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBTeW5jaHJvbml6ZSB0aGUgdHJlZS5cbiAgICB2YXIgcGF0Y2hlcyA9ICgwLCBfc3luYzIuZGVmYXVsdCkoZWxlbWVudE1ldGEub2xkVHJlZSwgbmV3VHJlZSk7XG4gICAgdmFyIGludm9rZVJlbmRlciA9ICgwLCBfcmVuZGVyLmNvbXBsZXRlUmVuZGVyKShlbGVtZW50LCBlbGVtZW50TWV0YSk7XG5cbiAgICAvLyBQcm9jZXNzIHRoZSBkYXRhIGltbWVkaWF0ZWx5IGFuZCB3YWl0IHVudGlsIGFsbCB0cmFuc2l0aW9uIGNhbGxiYWNrc1xuICAgIC8vIGhhdmUgY29tcGxldGVkLlxuICAgIHZhciBwcm9taXNlcyA9ICgwLCBfcHJvY2VzczIuZGVmYXVsdCkoZWxlbWVudCwgcGF0Y2hlcyk7XG5cbiAgICAvLyBPcGVyYXRlIHN5bmNocm9ub3VzbHkgdW5sZXNzIG9wdGVkIGludG8gYSBQcm9taXNlLWNoYWluLlxuICAgIGlmIChwcm9taXNlcy5sZW5ndGgpIHtcbiAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGludm9rZVJlbmRlciwgZnVuY3Rpb24gKGV4KSB7XG4gICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhleCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW52b2tlUmVuZGVyKCk7XG4gICAgfVxuICB9XG59XG5cbn0se1wiLi4vcGF0Y2hlcy9wcm9jZXNzXCI6MTEsXCIuLi91dGlsL21lbW9yeVwiOjE1LFwiLi4vdXRpbC9wYXJzZXJcIjoxNixcIi4uL3V0aWwvcG9vbHNcIjoxNyxcIi4uL3V0aWwvcmVuZGVyXCI6MTgsXCIuLi93b3JrZXIvY3JlYXRlXCI6MjAsXCIuL21ha2VcIjo2LFwiLi9zeW5jXCI6OSxcIi4vdHJlZVwiOjEwfV0sODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSByZWxlYXNlTm9kZTtcblxudmFyIF90cmVlID0gX2RlcmVxXygnLi90cmVlJyk7XG5cbnZhciBfbWFrZSA9IF9kZXJlcV8oJy4vbWFrZScpO1xuXG52YXIgX21ha2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWFrZSk7XG5cbnZhciBfbWVtb3J5ID0gX2RlcmVxXygnLi4vdXRpbC9tZW1vcnknKTtcblxudmFyIF9wb29scyA9IF9kZXJlcV8oJy4uL3V0aWwvcG9vbHMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLyoqXG4gKiBSZWxlYXNlJ3MgdGhlIGFsbG9jYXRlZCBvYmplY3RzIGFuZCByZWN5Y2xlcyBpbnRlcm5hbCBtZW1vcnkuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gcmVsZWFzZU5vZGUoZWxlbWVudCkge1xuICB2YXIgZWxlbWVudE1ldGEgPSBfdHJlZS5UcmVlQ2FjaGUuZ2V0KGVsZW1lbnQpO1xuXG4gIC8vIERvIG5vdCByZW1vdmUgYW4gZWxlbWVudCB0aGF0IGlzIGluIHByb2Nlc3Mgb2YgcmVuZGVyaW5nLiBVc2VyIGludGVudGlvbnNcbiAgLy8gY29tZSBmaXJzdCwgc28gaWYgd2UgYXJlIGNsZWFuaW5nIHVwIGFuIGVsZW1lbnQgYmVpbmcgdXNlZCBieSBhbm90aGVyIHBhcnRcbiAgLy8gb2YgdGhlIGNvZGUsIGtlZXAgaXQgYWxpdmUuXG4gIGlmIChlbGVtZW50TWV0YSkge1xuICAgIC8vIElmIHRoZXJlIGlzIGEgd29ya2VyIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGVsZW1lbnQsIHRoZW4ga2lsbCBpdC5cbiAgICBpZiAoZWxlbWVudE1ldGEud29ya2VyKSB7XG4gICAgICBlbGVtZW50TWV0YS53b3JrZXIudGVybWluYXRlKCk7XG4gICAgICBkZWxldGUgZWxlbWVudE1ldGEud29ya2VyO1xuICAgIH1cblxuICAgIC8vIElmIHRoZXJlIHdhcyBhIHRyZWUgc2V0IHVwLCByZWN5Y2xlIHRoZSBtZW1vcnkgYWxsb2NhdGVkIGZvciBpdC5cbiAgICBpZiAoZWxlbWVudE1ldGEub2xkVHJlZSkge1xuICAgICAgKDAsIF9tZW1vcnkudW5wcm90ZWN0RWxlbWVudCkoZWxlbWVudE1ldGEub2xkVHJlZSwgX21ha2UyLmRlZmF1bHQpO1xuICAgIH1cblxuICAgIGlmIChlbGVtZW50TWV0YS53b3JrZXJDYWNoZSkge1xuICAgICAgZWxlbWVudE1ldGEud29ya2VyQ2FjaGUuZm9yRWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICByZXR1cm4gKDAsIF9tZW1vcnkudW5wcm90ZWN0RWxlbWVudCkoeCwgX21ha2UyLmRlZmF1bHQpO1xuICAgICAgfSk7XG4gICAgICBkZWxldGUgZWxlbWVudE1ldGEud29ya2VyQ2FjaGU7XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIHRoaXMgZWxlbWVudCdzIG1ldGEgb2JqZWN0IGZyb20gdGhlIGNhY2hlLlxuICAgIF90cmVlLlRyZWVDYWNoZS5kZWxldGUoZWxlbWVudCk7XG4gIH1cblxuICAoMCwgX21lbW9yeS5jbGVhbk1lbW9yeSkoX21ha2UyLmRlZmF1bHQpO1xufVxuXG59LHtcIi4uL3V0aWwvbWVtb3J5XCI6MTUsXCIuLi91dGlsL3Bvb2xzXCI6MTcsXCIuL21ha2VcIjo2LFwiLi90cmVlXCI6MTB9XSw5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuQ0hBTkdFX1RFWFQgPSBleHBvcnRzLk1PRElGWV9BVFRSSUJVVEUgPSBleHBvcnRzLk1PRElGWV9FTEVNRU5UID0gZXhwb3J0cy5SRVBMQUNFX0VOVElSRV9FTEVNRU5UID0gZXhwb3J0cy5SRU1PVkVfRU5USVJFX0VMRU1FTlQgPSBleHBvcnRzLlJFTU9WRV9FTEVNRU5UX0NISUxEUkVOID0gdW5kZWZpbmVkO1xuZXhwb3J0cy5kZWZhdWx0ID0gc3luYztcblxudmFyIF9wb29sczIgPSBfZGVyZXFfKCcuLi91dGlsL3Bvb2xzJyk7XG5cbnZhciBwb29scyA9IF9wb29sczIucG9vbHM7XG5cbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciBmaWx0ZXIgPSBBcnJheS5wcm90b3R5cGUuZmlsdGVyO1xuXG4vLyBQYXRjaCBhY3Rpb25zLlxudmFyIFJFTU9WRV9FTEVNRU5UX0NISUxEUkVOID0gZXhwb3J0cy5SRU1PVkVfRUxFTUVOVF9DSElMRFJFTiA9IC0yO1xudmFyIFJFTU9WRV9FTlRJUkVfRUxFTUVOVCA9IGV4cG9ydHMuUkVNT1ZFX0VOVElSRV9FTEVNRU5UID0gLTE7XG52YXIgUkVQTEFDRV9FTlRJUkVfRUxFTUVOVCA9IGV4cG9ydHMuUkVQTEFDRV9FTlRJUkVfRUxFTUVOVCA9IDA7XG52YXIgTU9ESUZZX0VMRU1FTlQgPSBleHBvcnRzLk1PRElGWV9FTEVNRU5UID0gMTtcbnZhciBNT0RJRllfQVRUUklCVVRFID0gZXhwb3J0cy5NT0RJRllfQVRUUklCVVRFID0gMjtcbnZhciBDSEFOR0VfVEVYVCA9IGV4cG9ydHMuQ0hBTkdFX1RFWFQgPSAzO1xuXG4vKipcbiAqIFN5bmNocm9uaXplcyBjaGFuZ2VzIGZyb20gdGhlIG5ld1RyZWUgaW50byB0aGUgb2xkVHJlZS5cbiAqXG4gKiBAcGFyYW0gb2xkVHJlZVxuICogQHBhcmFtIG5ld1RyZWVcbiAqIEBwYXJhbSBwYXRjaGVzIC0gb3B0aW9uYWxcbiAqL1xuZnVuY3Rpb24gc3luYyhvbGRUcmVlLCBuZXdUcmVlLCBwYXRjaGVzKSB7XG4gIHBhdGNoZXMgPSBwYXRjaGVzIHx8IFtdO1xuXG4gIGlmICghQXJyYXkuaXNBcnJheShwYXRjaGVzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBBcnJheSB0byBzeW5jIHBhdGNoZXMgaW50bycpO1xuICB9XG5cbiAgaWYgKCFvbGRUcmVlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGV4aXN0aW5nIHRyZWUgdG8gc3luYycpO1xuICB9XG5cbiAgdmFyIG9sZE5vZGVWYWx1ZSA9IG9sZFRyZWUubm9kZVZhbHVlO1xuICB2YXIgb2xkQ2hpbGROb2RlcyA9IG9sZFRyZWUuY2hpbGROb2RlcztcbiAgdmFyIG9sZENoaWxkTm9kZXNMZW5ndGggPSBvbGRDaGlsZE5vZGVzID8gb2xkQ2hpbGROb2Rlcy5sZW5ndGggOiAwO1xuICB2YXIgb2xkRWxlbWVudCA9IG9sZFRyZWUudXVpZDtcbiAgdmFyIG9sZE5vZGVOYW1lID0gb2xkVHJlZS5ub2RlTmFtZTtcbiAgdmFyIG9sZElzVGV4dE5vZGUgPSBvbGROb2RlTmFtZSA9PT0gJyN0ZXh0JztcblxuICBpZiAoIW5ld1RyZWUpIHtcbiAgICB2YXIgcmVtb3ZlZCA9IFtvbGRUcmVlXS5jb25jYXQob2xkQ2hpbGROb2Rlcy5zcGxpY2UoMCwgb2xkQ2hpbGROb2Rlc0xlbmd0aCkpO1xuXG4gICAgcGF0Y2hlcy5wdXNoKHtcbiAgICAgIF9fZG9fXzogUkVNT1ZFX0VOVElSRV9FTEVNRU5ULFxuICAgICAgZWxlbWVudDogb2xkVHJlZSxcbiAgICAgIHRvUmVtb3ZlOiByZW1vdmVkXG4gICAgfSk7XG5cbiAgICByZXR1cm4gcGF0Y2hlcztcbiAgfVxuXG4gIHZhciBub2RlVmFsdWUgPSBuZXdUcmVlLm5vZGVWYWx1ZTtcbiAgdmFyIGNoaWxkTm9kZXMgPSBuZXdUcmVlLmNoaWxkTm9kZXM7XG4gIHZhciBjaGlsZE5vZGVzTGVuZ3RoID0gY2hpbGROb2RlcyA/IGNoaWxkTm9kZXMubGVuZ3RoIDogMDtcbiAgdmFyIG5ld0VsZW1lbnQgPSBuZXdUcmVlLnV1aWQ7XG4gIHZhciBub2RlTmFtZSA9IG5ld1RyZWUubm9kZU5hbWU7XG4gIHZhciBuZXdJc1RleHROb2RlID0gbm9kZU5hbWUgPT09ICcjdGV4dCc7XG5cbiAgLy8gSWYgdGhlIGVsZW1lbnQgd2UncmUgcmVwbGFjaW5nIGlzIHRvdGFsbHkgZGlmZmVyZW50IGZyb20gdGhlIHByZXZpb3VzXG4gIC8vIHJlcGxhY2UgdGhlIGVudGlyZSBlbGVtZW50LCBkb24ndCBib3RoZXIgaW52ZXN0aWdhdGluZyBjaGlsZHJlbi5cbiAgaWYgKG9sZFRyZWUubm9kZU5hbWUgIT09IG5ld1RyZWUubm9kZU5hbWUpIHtcbiAgICBwYXRjaGVzLnB1c2goe1xuICAgICAgX19kb19fOiBSRVBMQUNFX0VOVElSRV9FTEVNRU5ULFxuICAgICAgb2xkOiBvbGRUcmVlLFxuICAgICAgbmV3OiBuZXdUcmVlXG4gICAgfSk7XG5cbiAgICByZXR1cm4gcGF0Y2hlcztcbiAgfVxuXG4gIC8vIElmIHRoZSB0b3AgbGV2ZWwgbm9kZVZhbHVlIGhhcyBjaGFuZ2VkIHdlIHNob3VsZCByZWZsZWN0IGl0LlxuICBpZiAob2xkSXNUZXh0Tm9kZSAmJiBuZXdJc1RleHROb2RlICYmIG9sZE5vZGVWYWx1ZSAhPT0gbm9kZVZhbHVlKSB7XG4gICAgcGF0Y2hlcy5wdXNoKHtcbiAgICAgIF9fZG9fXzogQ0hBTkdFX1RFWFQsXG4gICAgICBlbGVtZW50OiBvbGRUcmVlLFxuICAgICAgdmFsdWU6IG5ld1RyZWUubm9kZVZhbHVlXG4gICAgfSk7XG5cbiAgICBvbGRUcmVlLm5vZGVWYWx1ZSA9IG5ld1RyZWUubm9kZVZhbHVlO1xuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gTW9zdCBjb21tb24gYWRkaXRpdmUgZWxlbWVudHMuXG4gIGlmIChjaGlsZE5vZGVzTGVuZ3RoID4gb2xkQ2hpbGROb2Rlc0xlbmd0aCkge1xuICAgIC8vIFN0b3JlIGVsZW1lbnRzIGluIGEgRG9jdW1lbnRGcmFnbWVudCB0byBpbmNyZWFzZSBwZXJmb3JtYW5jZSBhbmQgYmVcbiAgICAvLyBnZW5lcmFsbHkgc2ltcGxpZXIgdG8gd29yayB3aXRoLlxuICAgIHZhciBmcmFnbWVudCA9IFtdO1xuXG4gICAgZm9yICh2YXIgaSA9IG9sZENoaWxkTm9kZXNMZW5ndGg7IGkgPCBjaGlsZE5vZGVzTGVuZ3RoOyBpKyspIHtcbiAgICAgIC8vIEludGVybmFsbHkgYWRkIHRvIHRoZSB0cmVlLlxuICAgICAgb2xkQ2hpbGROb2Rlcy5wdXNoKGNoaWxkTm9kZXNbaV0pO1xuXG4gICAgICAvLyBBZGQgdG8gdGhlIGRvY3VtZW50IGZyYWdtZW50LlxuICAgICAgZnJhZ21lbnQucHVzaChjaGlsZE5vZGVzW2ldKTtcbiAgICB9XG5cbiAgICBvbGRDaGlsZE5vZGVzTGVuZ3RoID0gb2xkQ2hpbGROb2Rlcy5sZW5ndGg7XG5cbiAgICAvLyBBc3NpZ24gdGhlIGZyYWdtZW50IHRvIHRoZSBwYXRjaGVzIHRvIGJlIGluamVjdGVkLlxuICAgIHBhdGNoZXMucHVzaCh7XG4gICAgICBfX2RvX186IE1PRElGWV9FTEVNRU5ULFxuICAgICAgZWxlbWVudDogb2xkVHJlZSxcbiAgICAgIGZyYWdtZW50OiBmcmFnbWVudFxuICAgIH0pO1xuICB9XG5cbiAgLy8gUmVtb3ZlIHRoZXNlIGVsZW1lbnRzLlxuICBpZiAob2xkQ2hpbGROb2Rlc0xlbmd0aCA+IGNoaWxkTm9kZXNMZW5ndGgpIHtcbiAgICAvLyBGb3Igbm93IGp1c3Qgc3BsaWNlIG91dCB0aGUgZW5kIGl0ZW1zLlxuICAgIHZhciBkaWZmID0gb2xkQ2hpbGROb2Rlc0xlbmd0aCAtIGNoaWxkTm9kZXNMZW5ndGg7XG4gICAgdmFyIHRvUmVtb3ZlID0gb2xkQ2hpbGROb2Rlcy5zcGxpY2Uob2xkQ2hpbGROb2Rlc0xlbmd0aCAtIGRpZmYsIGRpZmYpO1xuXG4gICAgb2xkQ2hpbGROb2Rlc0xlbmd0aCA9IG9sZENoaWxkTm9kZXMubGVuZ3RoO1xuXG4gICAgaWYgKG9sZENoaWxkTm9kZXNMZW5ndGggPT09IDAgJiYgY2hpbGROb2Rlc0xlbmd0aCA9PT0gMCkge1xuICAgICAgcGF0Y2hlcy5wdXNoKHtcbiAgICAgICAgX19kb19fOiBSRU1PVkVfRUxFTUVOVF9DSElMRFJFTixcbiAgICAgICAgZWxlbWVudDogb2xkVHJlZSxcbiAgICAgICAgdG9SZW1vdmU6IHRvUmVtb3ZlXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHRvUmVtb3ZlLmxlbmd0aDsgX2krKykge1xuICAgICAgICAvLyBSZW1vdmUgdGhlIGVsZW1lbnQsIHRoaXMgaGFwcGVucyBiZWZvcmUgdGhlIHNwbGljZSBzbyB0aGF0IHdlXG4gICAgICAgIC8vIHN0aWxsIGhhdmUgYWNjZXNzIHRvIHRoZSBlbGVtZW50LlxuICAgICAgICBwYXRjaGVzLnB1c2goe1xuICAgICAgICAgIF9fZG9fXzogTU9ESUZZX0VMRU1FTlQsXG4gICAgICAgICAgb2xkOiB0b1JlbW92ZVtfaV1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gUmVwbGFjZSBlbGVtZW50cyBpZiB0aGV5IGFyZSBkaWZmZXJlbnQuXG4gIGlmIChvbGRDaGlsZE5vZGVzTGVuZ3RoID49IGNoaWxkTm9kZXNMZW5ndGgpIHtcbiAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBjaGlsZE5vZGVzTGVuZ3RoOyBfaTIrKykge1xuICAgICAgaWYgKG9sZENoaWxkTm9kZXNbX2kyXS5ub2RlTmFtZSAhPT0gY2hpbGROb2Rlc1tfaTJdLm5vZGVOYW1lKSB7XG4gICAgICAgIC8vIEFkZCB0byB0aGUgcGF0Y2hlcy5cbiAgICAgICAgcGF0Y2hlcy5wdXNoKHtcbiAgICAgICAgICBfX2RvX186IE1PRElGWV9FTEVNRU5ULFxuICAgICAgICAgIG9sZDogb2xkQ2hpbGROb2Rlc1tfaTJdLFxuICAgICAgICAgIG5ldzogY2hpbGROb2Rlc1tfaTJdXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFJlcGxhY2UgdGhlIGludGVybmFsIHRyZWUncyBwb2ludCBvZiB2aWV3IG9mIHRoaXMgZWxlbWVudC5cbiAgICAgICAgb2xkQ2hpbGROb2Rlc1tfaTJdID0gY2hpbGROb2Rlc1tfaTJdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3luYyhvbGRDaGlsZE5vZGVzW19pMl0sIGNoaWxkTm9kZXNbX2kyXSwgcGF0Y2hlcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gU3luY2hyb25pemUgYXR0cmlidXRlc1xuICB2YXIgYXR0cmlidXRlcyA9IG5ld1RyZWUuYXR0cmlidXRlcztcblxuICBpZiAoYXR0cmlidXRlcykge1xuICAgIHZhciBvbGRMZW5ndGggPSBvbGRUcmVlLmF0dHJpYnV0ZXMubGVuZ3RoO1xuICAgIHZhciBuZXdMZW5ndGggPSBhdHRyaWJ1dGVzLmxlbmd0aDtcblxuICAgIC8vIFN0YXJ0IHdpdGggdGhlIG1vc3QgY29tbW9uLCBhZGRpdGl2ZS5cbiAgICBpZiAobmV3TGVuZ3RoID4gb2xkTGVuZ3RoKSB7XG4gICAgICB2YXIgdG9BZGQgPSBzbGljZS5jYWxsKGF0dHJpYnV0ZXMsIG9sZExlbmd0aCk7XG5cbiAgICAgIGZvciAodmFyIF9pMyA9IDA7IF9pMyA8IHRvQWRkLmxlbmd0aDsgX2kzKyspIHtcbiAgICAgICAgdmFyIGNoYW5nZSA9IHtcbiAgICAgICAgICBfX2RvX186IE1PRElGWV9BVFRSSUJVVEUsXG4gICAgICAgICAgZWxlbWVudDogb2xkVHJlZSxcbiAgICAgICAgICBuYW1lOiB0b0FkZFtfaTNdLm5hbWUsXG4gICAgICAgICAgdmFsdWU6IHRvQWRkW19pM10udmFsdWVcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgYXR0ciA9IHBvb2xzLmF0dHJpYnV0ZU9iamVjdC5nZXQoKTtcbiAgICAgICAgYXR0ci5uYW1lID0gdG9BZGRbX2kzXS5uYW1lO1xuICAgICAgICBhdHRyLnZhbHVlID0gdG9BZGRbX2kzXS52YWx1ZTtcblxuICAgICAgICBwb29scy5hdHRyaWJ1dGVPYmplY3QucHJvdGVjdChhdHRyKTtcblxuICAgICAgICAvLyBQdXNoIHRoZSBjaGFuZ2Ugb2JqZWN0IGludG8gaW50byB0aGUgdmlydHVhbCB0cmVlLlxuICAgICAgICBvbGRUcmVlLmF0dHJpYnV0ZXMucHVzaChhdHRyKTtcblxuICAgICAgICAvLyBBZGQgdGhlIGNoYW5nZSB0byB0aGUgc2VyaWVzIG9mIHBhdGNoZXMuXG4gICAgICAgIHBhdGNoZXMucHVzaChjaGFuZ2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciByZW1vdmFscy5cbiAgICBpZiAob2xkTGVuZ3RoID4gbmV3TGVuZ3RoKSB7XG4gICAgICB2YXIgX3RvUmVtb3ZlID0gc2xpY2UuY2FsbChvbGRUcmVlLmF0dHJpYnV0ZXMsIG5ld0xlbmd0aCk7XG5cbiAgICAgIGZvciAodmFyIF9pNCA9IDA7IF9pNCA8IF90b1JlbW92ZS5sZW5ndGg7IF9pNCsrKSB7XG4gICAgICAgIHZhciBfY2hhbmdlID0ge1xuICAgICAgICAgIF9fZG9fXzogTU9ESUZZX0FUVFJJQlVURSxcbiAgICAgICAgICBlbGVtZW50OiBvbGRUcmVlLFxuICAgICAgICAgIG5hbWU6IF90b1JlbW92ZVtfaTRdLm5hbWUsXG4gICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgYXR0cmlidXRlIGZyb20gdGhlIHZpcnR1YWwgbm9kZS5cbiAgICAgICAgdmFyIF9yZW1vdmVkID0gb2xkVHJlZS5hdHRyaWJ1dGVzLnNwbGljZShfaTQsIDEpO1xuXG4gICAgICAgIGZvciAodmFyIF9pNSA9IDA7IF9pNSA8IF9yZW1vdmVkLmxlbmd0aDsgX2k1KyspIHtcbiAgICAgICAgICBwb29scy5hdHRyaWJ1dGVPYmplY3QudW5wcm90ZWN0KF9yZW1vdmVkW19pNV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHRoZSBjaGFuZ2UgdG8gdGhlIHNlcmllcyBvZiBwYXRjaGVzLlxuICAgICAgICBwYXRjaGVzLnB1c2goX2NoYW5nZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIG1vZGlmaWNhdGlvbnMuXG4gICAgdmFyIHRvTW9kaWZ5ID0gYXR0cmlidXRlcztcblxuICAgIGZvciAodmFyIF9pNiA9IDA7IF9pNiA8IHRvTW9kaWZ5Lmxlbmd0aDsgX2k2KyspIHtcbiAgICAgIHZhciBvbGRBdHRyVmFsdWUgPSBvbGRUcmVlLmF0dHJpYnV0ZXNbX2k2XSAmJiBvbGRUcmVlLmF0dHJpYnV0ZXNbX2k2XS52YWx1ZTtcbiAgICAgIHZhciBuZXdBdHRyVmFsdWUgPSBhdHRyaWJ1dGVzW19pNl0gJiYgYXR0cmlidXRlc1tfaTZdLnZhbHVlO1xuXG4gICAgICAvLyBPbmx5IHB1c2ggaW4gYSBjaGFuZ2UgaWYgdGhlIGF0dHJpYnV0ZSBvciB2YWx1ZSBjaGFuZ2VzLlxuICAgICAgaWYgKG9sZEF0dHJWYWx1ZSAhPT0gbmV3QXR0clZhbHVlKSB7XG4gICAgICAgIHZhciBfY2hhbmdlMiA9IHtcbiAgICAgICAgICBfX2RvX186IE1PRElGWV9BVFRSSUJVVEUsXG4gICAgICAgICAgZWxlbWVudDogb2xkVHJlZSxcbiAgICAgICAgICBuYW1lOiB0b01vZGlmeVtfaTZdLm5hbWUsXG4gICAgICAgICAgdmFsdWU6IHRvTW9kaWZ5W19pNl0udmFsdWVcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBSZXBsYWNlIHRoZSBhdHRyaWJ1dGUgaW4gdGhlIHZpcnR1YWwgbm9kZS5cbiAgICAgICAgdmFyIF9hdHRyID0gb2xkVHJlZS5hdHRyaWJ1dGVzW19pNl07XG4gICAgICAgIF9hdHRyLm5hbWUgPSB0b01vZGlmeVtfaTZdLm5hbWU7XG4gICAgICAgIF9hdHRyLnZhbHVlID0gdG9Nb2RpZnlbX2k2XS52YWx1ZTtcblxuICAgICAgICAvLyBBZGQgdGhlIGNoYW5nZSB0byB0aGUgc2VyaWVzIG9mIHBhdGNoZXMuXG4gICAgICAgIHBhdGNoZXMucHVzaChfY2hhbmdlMik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHBhdGNoZXM7XG59XG5cbn0se1wiLi4vdXRpbC9wb29sc1wiOjE3fV0sMTA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vLyBDYWNoZSBwcmVidWlsdCB0cmVlcyBhbmQgbG9va3VwIGJ5IGVsZW1lbnQuXG52YXIgVHJlZUNhY2hlID0gZXhwb3J0cy5UcmVlQ2FjaGUgPSBuZXcgTWFwKCk7XG5cbn0se31dLDExOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHByb2Nlc3M7XG5cbnZhciBfdHJhbnNpdGlvbnMgPSBfZGVyZXFfKCcuLi90cmFuc2l0aW9ucycpO1xuXG52YXIgdHJhbnNpdGlvbiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF90cmFuc2l0aW9ucyk7XG5cbnZhciBfcG9vbHMgPSBfZGVyZXFfKCcuLi91dGlsL3Bvb2xzJyk7XG5cbnZhciBfZ2V0ID0gX2RlcmVxXygnLi4vZWxlbWVudC9nZXQnKTtcblxudmFyIF9nZXQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0KTtcblxudmFyIF9jdXN0b20gPSBfZGVyZXFfKCcuLi9lbGVtZW50L2N1c3RvbScpO1xuXG52YXIgX21ha2UgPSBfZGVyZXFfKCcuLi9ub2RlL21ha2UnKTtcblxudmFyIF9tYWtlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21ha2UpO1xuXG52YXIgX3N5bmMgPSBfZGVyZXFfKCcuLi9ub2RlL3N5bmMnKTtcblxudmFyIHN5bmMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfc3luYyk7XG5cbnZhciBfdHJlZSA9IF9kZXJlcV8oJy4uL25vZGUvdHJlZScpO1xuXG52YXIgX21lbW9yeSA9IF9kZXJlcV8oJy4uL3V0aWwvbWVtb3J5Jyk7XG5cbnZhciBfZW50aXRpZXMgPSBfZGVyZXFfKCcuLi91dGlsL2VudGl0aWVzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9XG5cbnZhciBibG9ja1RleHRFbGVtZW50cyA9IFsnc2NyaXB0JywgJ25vc2NyaXB0JywgJ3N0eWxlJywgJ3ByZScsICd0ZW1wbGF0ZSddO1xuXG4vKipcbiAqIFByb2Nlc3NlcyBhbiBhcnJheSBvZiBwYXRjaGVzLlxuICpcbiAqIEBwYXJhbSBlbGVtZW50IC0gRWxlbWVudCB0byBwcm9jZXNzIHBhdGNoc2V0cyBvbi5cbiAqIEBwYXJhbSBlIC0gT2JqZWN0IHRoYXQgY29udGFpbnMgcGF0Y2hlcy5cbiAqL1xuZnVuY3Rpb24gcHJvY2VzcyhlbGVtZW50LCBwYXRjaGVzKSB7XG4gIHZhciBlbGVtZW50TWV0YSA9IF90cmVlLlRyZWVDYWNoZS5nZXQoZWxlbWVudCk7XG4gIHZhciBwcm9taXNlcyA9IFtdO1xuICB2YXIgdHJpZ2dlclRyYW5zaXRpb24gPSB0cmFuc2l0aW9uLmJ1aWxkVHJpZ2dlcihwcm9taXNlcyk7XG5cbiAgLy8gVHJpZ2dlciB0aGUgYXR0YWNoZWQgdHJhbnNpdGlvbiBzdGF0ZSBmb3IgdGhpcyBlbGVtZW50IGFuZCBhbGwgY2hpbGROb2Rlcy5cbiAgdmFyIGF0dGFjaGVkID0gZnVuY3Rpb24gYXR0YWNoZWQoZGVzY3JpcHRvciwgZnJhZ21lbnQsIHBhcmVudE5vZGUpIHtcbiAgICAoMCwgX21lbW9yeS5wcm90ZWN0RWxlbWVudCkoZGVzY3JpcHRvcik7XG5cbiAgICBpZiAoZWxlbWVudE1ldGEud29ya2VyQ2FjaGUpIHtcbiAgICAgIGVsZW1lbnRNZXRhLndvcmtlckNhY2hlLnB1c2goZGVzY3JpcHRvcik7XG4gICAgfVxuXG4gICAgdmFyIGVsID0gKDAsIF9nZXQyLmRlZmF1bHQpKGRlc2NyaXB0b3IpLmVsZW1lbnQ7XG5cbiAgICAvLyBJZiB0aGUgZWxlbWVudCBhZGRlZCB3YXMgYSBET00gdGV4dCBub2RlIG9yIFNWRyB0ZXh0IGVsZW1lbnQsIHRyaWdnZXJcbiAgICAvLyB0aGUgdGV4dENoYW5nZWQgdHJhbnNpdGlvbi5cbiAgICBpZiAoZGVzY3JpcHRvci5ub2RlTmFtZSA9PT0gJyN0ZXh0Jykge1xuICAgICAgdmFyIHRleHRQcm9taXNlcyA9IHRyYW5zaXRpb24ubWFrZVByb21pc2VzKCd0ZXh0Q2hhbmdlZCcsIFtlbF0sIG51bGwsIGRlc2NyaXB0b3Iubm9kZVZhbHVlKTtcblxuICAgICAgZWwudGV4dENvbnRlbnQgPSAoMCwgX2VudGl0aWVzLmRlY29kZUVudGl0aWVzKShkZXNjcmlwdG9yLm5vZGVWYWx1ZSk7XG5cbiAgICAgIGlmIChwYXJlbnROb2RlKSB7XG4gICAgICAgIHZhciBub2RlTmFtZSA9IHBhcmVudE5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBpZiAoYmxvY2tUZXh0RWxlbWVudHMuaW5kZXhPZihub2RlTmFtZSkgPiAtMSkge1xuICAgICAgICAgIHBhcmVudE5vZGUubm9kZVZhbHVlID0gKDAsIF9lbnRpdGllcy5kZWNvZGVFbnRpdGllcykoZGVzY3JpcHRvci5ub2RlVmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRyaWdnZXJUcmFuc2l0aW9uKCd0ZXh0Q2hhbmdlZCcsIHRleHRQcm9taXNlcywgZnVuY3Rpb24gKHByb21pc2VzKSB7fSk7XG4gICAgfVxuXG4gICAgaWYgKGRlc2NyaXB0b3IuYXR0cmlidXRlcyAmJiBkZXNjcmlwdG9yLmF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICBkZXNjcmlwdG9yLmF0dHJpYnV0ZXMuZm9yRWFjaChmdW5jdGlvbiAoYXR0cikge1xuICAgICAgICB2YXIgYXR0ckNoYW5nZVByb21pc2VzID0gdHJhbnNpdGlvbi5tYWtlUHJvbWlzZXMoJ2F0dHJpYnV0ZUNoYW5nZWQnLCBbZWxdLCBhdHRyLm5hbWUsIG51bGwsIGF0dHIudmFsdWUpO1xuXG4gICAgICAgIHRyaWdnZXJUcmFuc2l0aW9uKCdhdHRyaWJ1dGVDaGFuZ2VkJywgYXR0ckNoYW5nZVByb21pc2VzLCBmdW5jdGlvbiAocHJvbWlzZXMpIHt9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIENhbGwgYWxsIGBjaGlsZE5vZGVzYCBhdHRhY2hlZCBjYWxsYmFja3MgYXMgd2VsbC5cbiAgICBpZiAoZGVzY3JpcHRvci5jaGlsZE5vZGVzICYmIGRlc2NyaXB0b3IuY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgIGRlc2NyaXB0b3IuY2hpbGROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIHJldHVybiBhdHRhY2hlZCh4LCBudWxsLCBlbCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBJZiBhIGRvY3VtZW50IGZyYWdtZW50IHdhcyBzcGVjaWZpZWQsIGFwcGVuZCB0aGUgcmVhbCBlbGVtZW50IGludG8gaXQuXG4gICAgaWYgKGZyYWdtZW50KSB7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChlbCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVsO1xuICB9O1xuXG4gIC8vIExvb3AgdGhyb3VnaCBhbGwgdGhlIHBhdGNoZXMgYW5kIGFwcGx5IHRoZW0uXG5cbiAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoaSkge1xuICAgIHZhciBwYXRjaCA9IHBhdGNoZXNbaV07XG4gICAgdmFyIG5ld0VsID0gdm9pZCAwLFxuICAgICAgICBvbGRFbCA9IHZvaWQgMCxcbiAgICAgICAgZWwgPSB2b2lkIDA7XG5cbiAgICBpZiAocGF0Y2guZWxlbWVudCkge1xuICAgICAgdmFyIHJlc3VsdCA9ICgwLCBfZ2V0Mi5kZWZhdWx0KShwYXRjaC5lbGVtZW50KTtcbiAgICAgIGVsID0gcmVzdWx0LmVsZW1lbnQ7XG4gICAgfVxuXG4gICAgaWYgKHBhdGNoLm9sZCkge1xuICAgICAgdmFyIF9yZXN1bHQgPSAoMCwgX2dldDIuZGVmYXVsdCkocGF0Y2gub2xkKTtcbiAgICAgIG9sZEVsID0gX3Jlc3VsdC5lbGVtZW50O1xuICAgIH1cblxuICAgIGlmIChwYXRjaC5uZXcpIHtcbiAgICAgIHZhciBfcmVzdWx0MiA9ICgwLCBfZ2V0Mi5kZWZhdWx0KShwYXRjaC5uZXcpO1xuICAgICAgbmV3RWwgPSBfcmVzdWx0Mi5lbGVtZW50O1xuICAgIH1cblxuICAgIC8vIEVtcHR5IHRoZSBOb2RlJ3MgY29udGVudHMuIFRoaXMgaXMgYW4gb3B0aW1pemF0aW9uLCBzaW5jZSBgaW5uZXJIVE1MYFxuICAgIC8vIHdpbGwgYmUgZmFzdGVyIHRoYW4gaXRlcmF0aW5nIG92ZXIgZXZlcnkgZWxlbWVudCBhbmQgbWFudWFsbHkgcmVtb3ZpbmcuXG4gICAgaWYgKHBhdGNoLl9fZG9fXyA9PT0gc3luYy5SRU1PVkVfRUxFTUVOVF9DSElMRFJFTikge1xuICAgICAgdmFyIGNoaWxkTm9kZXMgPSBlbC5jaGlsZE5vZGVzO1xuICAgICAgdmFyIGRldGFjaFByb21pc2VzID0gdHJhbnNpdGlvbi5tYWtlUHJvbWlzZXMoJ2RldGFjaGVkJywgY2hpbGROb2Rlcyk7XG5cbiAgICAgIHRyaWdnZXJUcmFuc2l0aW9uKCdkZXRhY2hlZCcsIGRldGFjaFByb21pc2VzLCBmdW5jdGlvbiAocHJvbWlzZXMpIHtcbiAgICAgICAgcGF0Y2gudG9SZW1vdmUuZm9yRWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgIHJldHVybiAoMCwgX21lbW9yeS51bnByb3RlY3RFbGVtZW50KSh4LCBfbWFrZTIuZGVmYXVsdCk7XG4gICAgICAgIH0pO1xuICAgICAgICBlbC5pbm5lckhUTUwgPSAnJztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFJlbW92ZSB0aGUgZW50aXJlIE5vZGUuIE9ubHkgZG9lcyBzb21ldGhpbmcgaWYgdGhlIE5vZGUgaGFzIGEgcGFyZW50XG4gICAgLy8gZWxlbWVudC5cbiAgICBlbHNlIGlmIChwYXRjaC5fX2RvX18gPT09IHN5bmMuUkVNT1ZFX0VOVElSRV9FTEVNRU5UKSB7XG4gICAgICAgIHZhciBfZGV0YWNoUHJvbWlzZXMgPSB0cmFuc2l0aW9uLm1ha2VQcm9taXNlcygnZGV0YWNoZWQnLCBbZWxdKTtcblxuICAgICAgICBpZiAoZWwucGFyZW50Tm9kZSkge1xuICAgICAgICAgIHRyaWdnZXJUcmFuc2l0aW9uKCdkZXRhY2hlZCcsIF9kZXRhY2hQcm9taXNlcywgZnVuY3Rpb24gKHByb21pc2VzKSB7XG4gICAgICAgICAgICBlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsKTtcbiAgICAgICAgICAgIHBhdGNoLnRvUmVtb3ZlLmZvckVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuICgwLCBfbWVtb3J5LnVucHJvdGVjdEVsZW1lbnQpKHgsIF9tYWtlMi5kZWZhdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBhdGNoLnRvUmVtb3ZlLmZvckVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiAoMCwgX21lbW9yeS51bnByb3RlY3RFbGVtZW50KSh4LCBfbWFrZTIuZGVmYXVsdCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gUmVwbGFjZSB0aGUgZW50aXJlIE5vZGUuXG4gICAgICBlbHNlIGlmIChwYXRjaC5fX2RvX18gPT09IHN5bmMuUkVQTEFDRV9FTlRJUkVfRUxFTUVOVCkge1xuICAgICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYWxsUHJvbWlzZXMgPSBbXTtcbiAgICAgICAgICAgIHZhciBhdHRhY2hlZFByb21pc2VzID0gdHJhbnNpdGlvbi5tYWtlUHJvbWlzZXMoJ2F0dGFjaGVkJywgW25ld0VsXSk7XG4gICAgICAgICAgICB2YXIgZGV0YWNoZWRQcm9taXNlcyA9IHRyYW5zaXRpb24ubWFrZVByb21pc2VzKCdkZXRhY2hlZCcsIFtvbGRFbF0pO1xuICAgICAgICAgICAgdmFyIHJlcGxhY2VkUHJvbWlzZXMgPSB0cmFuc2l0aW9uLm1ha2VQcm9taXNlcygncmVwbGFjZWQnLCBbb2xkRWxdLCBuZXdFbCk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBhbGwgdGhlIHRyYW5zaXRpb24gc3RhdGUgcHJvbWlzZXMgaW50byB0aGUgbWFpbiBhcnJheSwgd2UnbGwgdXNlXG4gICAgICAgICAgICAvLyB0aGVtIGFsbCB0byBkZWNpZGUgd2hlbiB0byBhbHRlciB0aGUgRE9NLlxuICAgICAgICAgICAgdHJpZ2dlclRyYW5zaXRpb24oJ2RldGFjaGVkJywgZGV0YWNoZWRQcm9taXNlcywgZnVuY3Rpb24gKHByb21pc2VzKSB7XG4gICAgICAgICAgICAgIGFsbFByb21pc2VzLnB1c2guYXBwbHkoYWxsUHJvbWlzZXMsIHByb21pc2VzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0cmlnZ2VyVHJhbnNpdGlvbignYXR0YWNoZWQnLCBhdHRhY2hlZFByb21pc2VzLCBmdW5jdGlvbiAocHJvbWlzZXMpIHtcbiAgICAgICAgICAgICAgYWxsUHJvbWlzZXMucHVzaC5hcHBseShhbGxQcm9taXNlcywgcHJvbWlzZXMpO1xuICAgICAgICAgICAgICBhdHRhY2hlZChwYXRjaC5uZXcsIG51bGwsIG5ld0VsKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0cmlnZ2VyVHJhbnNpdGlvbigncmVwbGFjZWQnLCByZXBsYWNlZFByb21pc2VzLCBmdW5jdGlvbiAocHJvbWlzZXMpIHtcbiAgICAgICAgICAgICAgYWxsUHJvbWlzZXMucHVzaC5hcHBseShhbGxQcm9taXNlcywgcHJvbWlzZXMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICgwLCBfbWVtb3J5LnVucHJvdGVjdEVsZW1lbnQpKHBhdGNoLm9sZCwgX21ha2UyLmRlZmF1bHQpO1xuXG4gICAgICAgICAgICAvLyBSZXNldCB0aGUgdHJlZSBjYWNoZS5cbiAgICAgICAgICAgIF90cmVlLlRyZWVDYWNoZS5zZXQobmV3RWwsIHtcbiAgICAgICAgICAgICAgb2xkVHJlZTogcGF0Y2gubmV3LFxuICAgICAgICAgICAgICBlbGVtZW50OiBuZXdFbFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIE9uY2UgYWxsIHRoZSBwcm9taXNlcyBoYXZlIGNvbXBsZXRlZCwgaW52b2tlIHRoZSBhY3Rpb24sIGlmIG5vXG4gICAgICAgICAgICAvLyBwcm9taXNlcyB3ZXJlIGFkZGVkLCB0aGlzIHdpbGwgYmUgYSBzeW5jaHJvbm91cyBvcGVyYXRpb24uXG4gICAgICAgICAgICBpZiAoYWxsUHJvbWlzZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIFByb21pc2UuYWxsKGFsbFByb21pc2VzKS50aGVuKGZ1bmN0aW9uIHJlcGxhY2VFbnRpcmVFbGVtZW50KCkge1xuICAgICAgICAgICAgICAgIGlmICghb2xkRWwucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgKDAsIF9tZW1vcnkudW5wcm90ZWN0RWxlbWVudCkocGF0Y2gubmV3LCBfbWFrZTIuZGVmYXVsdCk7XG5cbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2FuXFwndCByZXBsYWNlIHdpdGhvdXQgcGFyZW50LCBpcyB0aGlzIHRoZSAnICsgJ2RvY3VtZW50IHJvb3Q/Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgb2xkRWwucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3RWwsIG9sZEVsKTtcbiAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGV4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGV4KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpZiAoIW9sZEVsLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICAoMCwgX21lbW9yeS51bnByb3RlY3RFbGVtZW50KShwYXRjaC5uZXcsIF9tYWtlMi5kZWZhdWx0KTtcblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2FuXFwndCByZXBsYWNlIHdpdGhvdXQgcGFyZW50LCBpcyB0aGlzIHRoZSAnICsgJ2RvY3VtZW50IHJvb3Q/Jyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBvbGRFbC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChuZXdFbCwgb2xkRWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBOb2RlIG1hbmlwLlxuICAgICAgICBlbHNlIGlmIChwYXRjaC5fX2RvX18gPT09IHN5bmMuTU9ESUZZX0VMRU1FTlQpIHtcbiAgICAgICAgICAgIC8vIEFkZC5cbiAgICAgICAgICAgIGlmIChlbCAmJiBwYXRjaC5mcmFnbWVudCAmJiAhb2xkRWwpIHtcbiAgICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBMb29wIG92ZXIgZXZlcnkgZWxlbWVudCB0byBiZSBhZGRlZCBhbmQgcHJvY2VzcyB0aGUgZGVzY3JpcHRvclxuICAgICAgICAgICAgICAgIC8vIGludG8gdGhlIHJlYWwgZWxlbWVudCBhbmQgYXBwZW5kIGludG8gdGhlIERPTSBmcmFnbWVudC5cbiAgICAgICAgICAgICAgICB0b0F0dGFjaCA9IHBhdGNoLmZyYWdtZW50Lm1hcChmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBhdHRhY2hlZChlbCwgZnJhZ21lbnQsIGVsKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIFR1cm4gZWxlbWVudHMgaW50byBjaGlsZE5vZGVzIG9mIHRoZSBwYXRjaCBlbGVtZW50LlxuXG4gICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB0cmFuc2l0aW9ucy5cbiAgICAgICAgICAgICAgICB2YXIgbWFrZUF0dGFjaGVkID0gdHJhbnNpdGlvbi5tYWtlUHJvbWlzZXMoJ2F0dGFjaGVkJywgdG9BdHRhY2gpO1xuICAgICAgICAgICAgICAgIHRyaWdnZXJUcmFuc2l0aW9uKCdhdHRhY2hlZCcsIG1ha2VBdHRhY2hlZCk7XG4gICAgICAgICAgICAgIH0pKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZS5cbiAgICAgICAgICAgIGVsc2UgaWYgKG9sZEVsICYmICFuZXdFbCkge1xuICAgICAgICAgICAgICAgIGlmICghb2xkRWwucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgKDAsIF9tZW1vcnkudW5wcm90ZWN0RWxlbWVudCkocGF0Y2gub2xkLCBfbWFrZTIuZGVmYXVsdCk7XG5cbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2FuXFwndCByZW1vdmUgd2l0aG91dCBwYXJlbnQsIGlzIHRoaXMgdGhlICcgKyAnZG9jdW1lbnQgcm9vdD8nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgbWFrZURldGFjaGVkID0gdHJhbnNpdGlvbi5tYWtlUHJvbWlzZXMoJ2RldGFjaGVkJywgW29sZEVsXSk7XG5cbiAgICAgICAgICAgICAgICB0cmlnZ2VyVHJhbnNpdGlvbignZGV0YWNoZWQnLCBtYWtlRGV0YWNoZWQsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIC8vIEFuZCB0aGVuIGVtcHR5IG91dCB0aGUgZW50aXJlIGNvbnRlbnRzLlxuICAgICAgICAgICAgICAgICAgb2xkRWwuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChvbGRFbC5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9sZEVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQob2xkRWwpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAoMCwgX21lbW9yeS51bnByb3RlY3RFbGVtZW50KShwYXRjaC5vbGQsIF9tYWtlMi5kZWZhdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIC8vIFJlcGxhY2UuXG4gICAgICAgICAgICAgIGVsc2UgaWYgKG9sZEVsICYmIG5ld0VsKSB7XG4gICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW9sZEVsLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAoMCwgX21lbW9yeS51bnByb3RlY3RFbGVtZW50KShwYXRjaC5vbGQsIF9tYWtlMi5kZWZhdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAoMCwgX21lbW9yeS51bnByb3RlY3RFbGVtZW50KShwYXRjaC5uZXcsIF9tYWtlMi5kZWZhdWx0KTtcblxuICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2FuXFwndCByZXBsYWNlIHdpdGhvdXQgcGFyZW50LCBpcyB0aGlzIHRoZSAnICsgJ2RvY3VtZW50IHJvb3Q/Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdGhlIGVsZW1lbnQgZmlyc3QsIGJlZm9yZSBkb2luZyB0aGUgcmVwbGFjZW1lbnQuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbGRFbC5uZXh0U2libGluZykge1xuICAgICAgICAgICAgICAgICAgICAgIG9sZEVsLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5ld0VsLCBvbGRFbC5uZXh0U2libGluZyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgb2xkRWwucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChuZXdFbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmVkIHN0YXRlIGZvciB0cmFuc2l0aW9ucyBBUEkuXG4gICAgICAgICAgICAgICAgICAgIHZhciBhbGxQcm9taXNlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXR0YWNoUHJvbWlzZXMgPSB0cmFuc2l0aW9uLm1ha2VQcm9taXNlcygnYXR0YWNoZWQnLCBbbmV3RWxdKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRldGFjaFByb21pc2VzID0gdHJhbnNpdGlvbi5tYWtlUHJvbWlzZXMoJ2RldGFjaGVkJywgW29sZEVsXSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXBsYWNlUHJvbWlzZXMgPSB0cmFuc2l0aW9uLm1ha2VQcm9taXNlcygncmVwbGFjZWQnLCBbb2xkRWxdLCBuZXdFbCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlclRyYW5zaXRpb24oJ2RldGFjaGVkJywgZGV0YWNoUHJvbWlzZXMsIGZ1bmN0aW9uIChwcm9taXNlcykge1xuICAgICAgICAgICAgICAgICAgICAgIGFsbFByb21pc2VzLnB1c2guYXBwbHkoYWxsUHJvbWlzZXMsIHByb21pc2VzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlclRyYW5zaXRpb24oJ2F0dGFjaGVkJywgYXR0YWNoUHJvbWlzZXMsIGZ1bmN0aW9uIChwcm9taXNlcykge1xuICAgICAgICAgICAgICAgICAgICAgIGFsbFByb21pc2VzLnB1c2guYXBwbHkoYWxsUHJvbWlzZXMsIHByb21pc2VzKTtcbiAgICAgICAgICAgICAgICAgICAgICBhdHRhY2hlZChwYXRjaC5uZXcpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyVHJhbnNpdGlvbigncmVwbGFjZWQnLCByZXBsYWNlUHJvbWlzZXMsIGZ1bmN0aW9uIChwcm9taXNlcykge1xuICAgICAgICAgICAgICAgICAgICAgIGFsbFByb21pc2VzLnB1c2guYXBwbHkoYWxsUHJvbWlzZXMsIHByb21pc2VzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gT25jZSBhbGwgdGhlIHByb21pc2VzIGhhdmUgY29tcGxldGVkLCBpbnZva2UgdGhlIGFjdGlvbiwgaWYgbm9cbiAgICAgICAgICAgICAgICAgICAgLy8gcHJvbWlzZXMgd2VyZSBhZGRlZCwgdGhpcyB3aWxsIGJlIGEgc3luY2hyb25vdXMgb3BlcmF0aW9uLlxuICAgICAgICAgICAgICAgICAgICBpZiAoYWxsUHJvbWlzZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgUHJvbWlzZS5hbGwoYWxsUHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gcmVwbGFjZUVsZW1lbnQoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRFbC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChuZXdFbCwgb2xkRWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgKDAsIF9tZW1vcnkudW5wcm90ZWN0RWxlbWVudCkocGF0Y2gub2xkLCBfbWFrZTIuZGVmYXVsdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICgwLCBfbWVtb3J5LnByb3RlY3RFbGVtZW50KShwYXRjaC5uZXcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudE1ldGEud29ya2VyQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudE1ldGEud29ya2VyQ2FjaGUucHVzaChwYXRjaC5uZXcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9sZEVsLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICgwLCBfbWVtb3J5LnVucHJvdGVjdEVsZW1lbnQpKHBhdGNoLm9sZCwgX21ha2UyLmRlZmF1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgKDAsIF9tZW1vcnkudW5wcm90ZWN0RWxlbWVudCkocGF0Y2gubmV3LCBfbWFrZTIuZGVmYXVsdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2FuXFwndCByZXBsYWNlIHdpdGhvdXQgcGFyZW50LCBpcyB0aGlzIHRoZSAnICsgJ2RvY3VtZW50IHJvb3Q/Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgb2xkRWwucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3RWwsIG9sZEVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAoMCwgX21lbW9yeS51bnByb3RlY3RFbGVtZW50KShwYXRjaC5vbGQsIF9tYWtlMi5kZWZhdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAoMCwgX21lbW9yeS5wcm90ZWN0RWxlbWVudCkocGF0Y2gubmV3KTtcblxuICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50TWV0YS53b3JrZXJDYWNoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudE1ldGEud29ya2VyQ2FjaGUucHVzaChwYXRjaC5uZXcpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gQXR0cmlidXRlIG1hbmlwdWxhdGlvbi5cbiAgICAgICAgICBlbHNlIGlmIChwYXRjaC5fX2RvX18gPT09IHN5bmMuTU9ESUZZX0FUVFJJQlVURSkge1xuICAgICAgICAgICAgICB2YXIgYXR0ckNoYW5nZVByb21pc2VzID0gdHJhbnNpdGlvbi5tYWtlUHJvbWlzZXMoJ2F0dHJpYnV0ZUNoYW5nZWQnLCBbZWxdLCBwYXRjaC5uYW1lLCBlbC5nZXRBdHRyaWJ1dGUocGF0Y2gubmFtZSksIHBhdGNoLnZhbHVlKTtcblxuICAgICAgICAgICAgICB0cmlnZ2VyVHJhbnNpdGlvbignYXR0cmlidXRlQ2hhbmdlZCcsIGF0dHJDaGFuZ2VQcm9taXNlcywgZnVuY3Rpb24gKHByb21pc2VzKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlLlxuICAgICAgICAgICAgICAgIGlmIChwYXRjaC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUocGF0Y2gubmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChwYXRjaC5uYW1lID09PSAnY2hlY2tlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWwuY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBDaGFuZ2UuXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZShwYXRjaC5uYW1lLCBwYXRjaC52YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgYW4gYGlzYCBhdHRyaWJ1dGUgd2FzIHNldCwgd2Ugc2hvdWxkIHVwZ3JhZGUgaXQuXG4gICAgICAgICAgICAgICAgICAgICgwLCBfY3VzdG9tLnVwZ3JhZGUpKHBhdGNoLmVsZW1lbnQubm9kZU5hbWUsIGVsLCBwYXRjaC5lbGVtZW50KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTdXBwb3J0IGxpdmUgdXBkYXRpbmcgb2YgdGhlIHZhbHVlIGF0dHJpYnV0ZS5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhdGNoLm5hbWUgPT09ICd2YWx1ZScgfHwgcGF0Y2gubmFtZSA9PT0gJ2NoZWNrZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZWxbcGF0Y2gubmFtZV0gPSBwYXRjaC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVGV4dCBub2RlIG1hbmlwdWxhdGlvbi5cbiAgICAgICAgICAgIGVsc2UgaWYgKHBhdGNoLl9fZG9fXyA9PT0gc3luYy5DSEFOR0VfVEVYVCkge1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0Q2hhbmdlUHJvbWlzZXMgPSB0cmFuc2l0aW9uLm1ha2VQcm9taXNlcygndGV4dENoYW5nZWQnLCBbZWxdLCBlbC5ub2RlVmFsdWUsIHBhdGNoLnZhbHVlKTtcblxuICAgICAgICAgICAgICAgIHRyaWdnZXJUcmFuc2l0aW9uKCd0ZXh0Q2hhbmdlZCcsIHRleHRDaGFuZ2VQcm9taXNlcywgZnVuY3Rpb24gKHByb21pc2VzKSB7XG4gICAgICAgICAgICAgICAgICBwYXRjaC5lbGVtZW50Lm5vZGVWYWx1ZSA9ICgwLCBfZW50aXRpZXMuZGVjb2RlRW50aXRpZXMpKHBhdGNoLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgIGVsLm5vZGVWYWx1ZSA9IHBhdGNoLmVsZW1lbnQubm9kZVZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoZWwucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZU5hbWUgPSBlbC5wYXJlbnROb2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGJsb2NrVGV4dEVsZW1lbnRzLmluZGV4T2Yobm9kZU5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICBlbC5wYXJlbnROb2RlLm5vZGVWYWx1ZSA9IHBhdGNoLmVsZW1lbnQubm9kZVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgfTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHBhdGNoZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgdG9BdHRhY2g7XG5cbiAgICBfbG9vcChpKTtcbiAgfVxuXG4gIC8vIFJldHVybiB0aGUgUHJvbWlzZXMgdGhhdCB3ZXJlIGFsbG9jYXRlZCBzbyB0aGF0IHJlbmRlcmluZyBjYW4gYmUgYmxvY2tlZFxuICAvLyB1bnRpbCB0aGV5IHJlc29sdmUuXG4gIHJldHVybiBwcm9taXNlcy5maWx0ZXIoQm9vbGVhbik7XG59XG5cbn0se1wiLi4vZWxlbWVudC9jdXN0b21cIjoxLFwiLi4vZWxlbWVudC9nZXRcIjoyLFwiLi4vbm9kZS9tYWtlXCI6NixcIi4uL25vZGUvc3luY1wiOjksXCIuLi9ub2RlL3RyZWVcIjoxMCxcIi4uL3RyYW5zaXRpb25zXCI6MTMsXCIuLi91dGlsL2VudGl0aWVzXCI6MTQsXCIuLi91dGlsL21lbW9yeVwiOjE1LFwiLi4vdXRpbC9wb29sc1wiOjE3fV0sMTI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLy8gTGlzdCBvZiBTVkcgZWxlbWVudHMuXG52YXIgZWxlbWVudHMgPSBleHBvcnRzLmVsZW1lbnRzID0gWydhbHRHbHlwaCcsICdhbHRHbHlwaERlZicsICdhbHRHbHlwaEl0ZW0nLCAnYW5pbWF0ZScsICdhbmltYXRlQ29sb3InLCAnYW5pbWF0ZU1vdGlvbicsICdhbmltYXRlVHJhbnNmb3JtJywgJ2NpcmNsZScsICdjbGlwUGF0aCcsICdjb2xvci1wcm9maWxlJywgJ2N1cnNvcicsICdkZWZzJywgJ2Rlc2MnLCAnZWxsaXBzZScsICdmZUJsZW5kJywgJ2ZlQ29sb3JNYXRyaXgnLCAnZmVDb21wb25lbnRUcmFuc2ZlcicsICdmZUNvbXBvc2l0ZScsICdmZUNvbnZvbHZlTWF0cml4JywgJ2ZlRGlmZnVzZUxpZ2h0aW5nJywgJ2ZlRGlzcGxhY2VtZW50TWFwJywgJ2ZlRGlzdGFudExpZ2h0JywgJ2ZlRmxvb2QnLCAnZmVGdW5jQScsICdmZUZ1bmNCJywgJ2ZlRnVuY0cnLCAnZmVGdW5jUicsICdmZUdhdXNzaWFuQmx1cicsICdmZUltYWdlJywgJ2ZlTWVyZ2UnLCAnZmVNZXJnZU5vZGUnLCAnZmVNb3JwaG9sb2d5JywgJ2ZlT2Zmc2V0JywgJ2ZlUG9pbnRMaWdodCcsICdmZVNwZWN1bGFyTGlnaHRpbmcnLCAnZmVTcG90TGlnaHQnLCAnZmVUaWxlJywgJ2ZlVHVyYnVsZW5jZScsICdmaWx0ZXInLCAnZm9udCcsICdmb250LWZhY2UnLCAnZm9udC1mYWNlLWZvcm1hdCcsICdmb250LWZhY2UtbmFtZScsICdmb250LWZhY2Utc3JjJywgJ2ZvbnQtZmFjZS11cmknLCAnZm9yZWlnbk9iamVjdCcsICdnJywgJ2dseXBoJywgJ2dseXBoUmVmJywgJ2hrZXJuJywgJ2ltYWdlJywgJ2xpbmUnLCAnbGluZWFyR3JhZGllbnQnLCAnbWFya2VyJywgJ21hc2snLCAnbWV0YWRhdGEnLCAnbWlzc2luZy1nbHlwaCcsICdtcGF0aCcsICdwYXRoJywgJ3BhdHRlcm4nLCAncG9seWdvbicsICdwb2x5bGluZScsICdyYWRpYWxHcmFkaWVudCcsICdyZWN0JywgJ3NldCcsICdzdG9wJywgJ3N2ZycsICdzd2l0Y2gnLCAnc3ltYm9sJywgJ3RleHQnLCAndGV4dFBhdGgnLCAndHJlZicsICd0c3BhbicsICd1c2UnLCAndmlldycsICd2a2VybiddO1xuXG4vLyBOYW1lc3BhY2UuXG52YXIgbmFtZXNwYWNlID0gZXhwb3J0cy5uYW1lc3BhY2UgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnO1xuXG59LHt9XSwxMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnN0YXRlcyA9IHVuZGVmaW5lZDtcbmV4cG9ydHMuYnVpbGRUcmlnZ2VyID0gYnVpbGRUcmlnZ2VyO1xuZXhwb3J0cy5tYWtlUHJvbWlzZXMgPSBtYWtlUHJvbWlzZXM7XG5cbnZhciBfY3VzdG9tID0gX2RlcmVxXygnLi9lbGVtZW50L2N1c3RvbScpO1xuXG52YXIgX21ha2UgPSBfZGVyZXFfKCcuL25vZGUvbWFrZScpO1xuXG52YXIgX21ha2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWFrZSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciBmb3JFYWNoID0gQXJyYXkucHJvdG90eXBlLmZvckVhY2g7XG52YXIgY29uY2F0ID0gQXJyYXkucHJvdG90eXBlLmNvbmNhdDtcbnZhciBlbXB0eSA9IHsgcHJvdG90eXBlOiB7fSB9O1xuXG4vKipcbiAqIENvbnRhaW5zIGFycmF5cyB0byBzdG9yZSB0cmFuc2l0aW9uIGNhbGxiYWNrcy5cbiAqXG4gKiBhdHRhY2hlZFxuICogLS0tLS0tLS1cbiAqXG4gKiBGb3Igd2hlbiBlbGVtZW50cyBjb21lIGludG8gdGhlIERPTS4gVGhlIGNhbGxiYWNrIHRyaWdnZXJzIGltbWVkaWF0ZWx5IGFmdGVyXG4gKiB0aGUgZWxlbWVudCBlbnRlcnMgdGhlIERPTS4gSXQgaXMgY2FsbGVkIHdpdGggdGhlIGVsZW1lbnQgYXMgdGhlIG9ubHlcbiAqIGFyZ3VtZW50LlxuICpcbiAqIGRldGFjaGVkXG4gKiAtLS0tLS0tLVxuICpcbiAqIEZvciB3aGVuIGVsZW1lbnRzIGFyZSByZW1vdmVkIGZyb20gdGhlIERPTS4gVGhlIGNhbGxiYWNrIHRyaWdnZXJzIGp1c3RcbiAqIGJlZm9yZSB0aGUgZWxlbWVudCBsZWF2ZXMgdGhlIERPTS4gSXQgaXMgY2FsbGVkIHdpdGggdGhlIGVsZW1lbnQgYXMgdGhlIG9ubHlcbiAqIGFyZ3VtZW50LlxuICpcbiAqIHJlcGxhY2VkXG4gKiAtLS0tLS0tLVxuICpcbiAqIEZvciB3aGVuIGVsZW1lbnRzIGFyZSByZXBsYWNlZCBpbiB0aGUgRE9NLiBUaGUgY2FsbGJhY2sgdHJpZ2dlcnMgYWZ0ZXIgdGhlXG4gKiBuZXcgZWxlbWVudCBlbnRlcnMgdGhlIERPTSwgYW5kIGJlZm9yZSB0aGUgb2xkIGVsZW1lbnQgbGVhdmVzLiBJdCBpcyBjYWxsZWRcbiAqIHdpdGggb2xkIGFuZCBuZXcgZWxlbWVudHMgYXMgYXJndW1lbnRzLCBpbiB0aGF0IG9yZGVyLlxuICpcbiAqIGF0dHJpYnV0ZUNoYW5nZWRcbiAqIC0tLS0tLS0tLS0tLS0tLS1cbiAqXG4gKiBUcmlnZ2VyZWQgd2hlbiBhbiBlbGVtZW50J3MgYXR0cmlidXRlIGhhcyBjaGFuZ2VkLiBUaGUgY2FsbGJhY2sgdHJpZ2dlcnNcbiAqIGFmdGVyIHRoZSBhdHRyaWJ1dGUgaGFzIGNoYW5nZWQgaW4gdGhlIERPTS4gSXQgaXMgY2FsbGVkIHdpdGggdGhlIGVsZW1lbnQsXG4gKiB0aGUgYXR0cmlidXRlIG5hbWUsIG9sZCB2YWx1ZSwgYW5kIGN1cnJlbnQgdmFsdWUuXG4gKlxuICogdGV4dENoYW5nZWRcbiAqIC0tLS0tLS0tLS0tXG4gKlxuICogVHJpZ2dlcmVkIHdoZW4gYW4gZWxlbWVudCdzIGB0ZXh0Q29udGVudGAgY2huYWdlcy4gVGhlIGNhbGxiYWNrIHRyaWdnZXJzXG4gKiBhZnRlciB0aGUgdGV4dENvbnRlbnQgaGFzIGNoYW5nZWQgaW4gdGhlIERPTS4gSXQgaXMgY2FsbGVkIHdpdGggdGhlIGVsZW1lbnQsXG4gKiB0aGUgb2xkIHZhbHVlLCBhbmQgY3VycmVudCB2YWx1ZS5cbiAqL1xudmFyIHN0YXRlcyA9IGV4cG9ydHMuc3RhdGVzID0ge1xuICBhdHRhY2hlZDogW10sXG4gIGRldGFjaGVkOiBbXSxcbiAgcmVwbGFjZWQ6IFtdLFxuICBhdHRyaWJ1dGVDaGFuZ2VkOiBbXSxcbiAgdGV4dENoYW5nZWQ6IFtdXG59O1xuXG4vLyBEZWZpbmUgdGhlIGN1c3RvbSBzaWduYXR1cmVzIG5lY2Vzc2FyeSBmb3IgdGhlIGxvb3AgdG8gZmlsbCBpbiB0aGUgXCJtYWdpY1wiXG4vLyBtZXRob2RzIHRoYXQgcHJvY2VzcyB0aGUgdHJhbnNpdGlvbnMgY29uc2lzdGVudGx5LlxudmFyIGZuU2lnbmF0dXJlcyA9IHtcbiAgYXR0YWNoZWQ6IHtcbiAgICBtYXBGbjogZnVuY3Rpb24gbWFwRm4oZWwpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgcmV0dXJuIGNiKGVsKTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBjdXN0b21FbGVtZW50c0ZuOiBmdW5jdGlvbiBjdXN0b21FbGVtZW50c0ZuKGVsKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgIHJldHVybiBjYi5jYWxsKGVsKTtcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIGRldGFjaGVkOiB7XG4gICAgbWFwRm46IGZ1bmN0aW9uIG1hcEZuKGVsKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgIHJldHVybiBjYihlbCk7XG4gICAgICB9O1xuICAgIH0sXG4gICAgY3VzdG9tRWxlbWVudHNGbjogZnVuY3Rpb24gY3VzdG9tRWxlbWVudHNGbihlbCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYikge1xuICAgICAgICByZXR1cm4gY2IuY2FsbChlbCk7XG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICByZXBsYWNlZDoge1xuICAgIG1hcEZuOiBmdW5jdGlvbiBtYXBGbihvbGRFbCwgbmV3RWwpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgcmV0dXJuIGNiKG9sZEVsLCBuZXdFbCk7XG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICBhdHRyaWJ1dGVDaGFuZ2VkOiB7XG4gICAgbWFwRm46IGZ1bmN0aW9uIG1hcEZuKGVsLCBuYW1lLCBvbGRWYWwsIG5ld1ZhbCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYikge1xuICAgICAgICByZXR1cm4gY2IoZWwsIG5hbWUsIG9sZFZhbCwgbmV3VmFsKTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBjdXN0b21FbGVtZW50c0ZuOiBmdW5jdGlvbiBjdXN0b21FbGVtZW50c0ZuKGVsLCBuYW1lLCBvbGRWYWwsIG5ld1ZhbCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYikge1xuICAgICAgICByZXR1cm4gY2IuY2FsbChlbCwgbmFtZSwgb2xkVmFsLCBuZXdWYWwpO1xuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgdGV4dENoYW5nZWQ6IHtcbiAgICBtYXBGbjogZnVuY3Rpb24gbWFwRm4oZWwsIG9sZFZhbCwgbmV3VmFsKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgIHJldHVybiBjYihlbCwgb2xkVmFsLCBuZXdWYWwpO1xuICAgICAgfTtcbiAgICB9LFxuICAgIGN1c3RvbUVsZW1lbnRzRm46IGZ1bmN0aW9uIGN1c3RvbUVsZW1lbnRzRm4oZWwsIG9sZFZhbCwgbmV3VmFsKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgIHJldHVybiBjYi5jYWxsKGVsLCBvbGRWYWwsIG5ld1ZhbCk7XG4gICAgICB9O1xuICAgIH1cbiAgfVxufTtcblxudmFyIG1ha2UgPSB7fTtcblxuLy8gRHluYW1pY2FsbHkgZmlsbCBpbiB0aGUgY3VzdG9tIG1ldGhvZHMgaW5zdGVhZCBvZiBtYW51YWxseSBjb25zdHJ1Y3Rpbmdcbi8vIHRoZW0uXG5PYmplY3Qua2V5cyhzdGF0ZXMpLmZvckVhY2goZnVuY3Rpb24gaXRlcmF0ZVN0YXRlcyhzdGF0ZU5hbWUpIHtcbiAgdmFyIG1hcEZuID0gZm5TaWduYXR1cmVzW3N0YXRlTmFtZV0ubWFwRm47XG5cbiAgLyoqXG4gICAqIE1ha2UncyB0aGUgdHJhbnNpdGlvbiBwcm9taXNlcy5cbiAgICpcbiAgICogQHBhcmFtIGVsZW1lbnRzXG4gICAqIEBwYXJhbSBhcmdzXG4gICAqIEBwYXJhbSBwcm9taXNlc1xuICAgKi9cbiAgbWFrZVtzdGF0ZU5hbWVdID0gZnVuY3Rpb24gbWFrZVRyYW5zaXRpb25Qcm9taXNlcyhlbGVtZW50cywgYXJncywgcHJvbWlzZXMpIHtcbiAgICBmb3JFYWNoLmNhbGwoZWxlbWVudHMsIGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAvLyBOZXZlciBwYXNzIHRleHQgbm9kZXMgdG8gYSBzdGF0ZSBjYWxsYmFjayB1bmxlc3MgaXQgaXMgdGV4dENoYW5nZWQuXG4gICAgICBpZiAoc3RhdGVOYW1lICE9PSAndGV4dENoYW5nZWQnICYmIGVsZW1lbnQubm9kZVR5cGUgIT09IDEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBDYWxsIHRoZSBtYXAgZnVuY3Rpb24gd2l0aCBlYWNoIGVsZW1lbnQuXG4gICAgICB2YXIgbmV3UHJvbWlzZXMgPSBzdGF0ZXNbc3RhdGVOYW1lXS5tYXAobWFwRm4uYXBwbHkobnVsbCwgW2VsZW1lbnRdLmNvbmNhdChhcmdzKSkpLmZpbHRlcihCb29sZWFuKTtcblxuICAgICAgLy8gTWVyZ2UgdGhlc2UgUHJvbWlzZXMgaW50byB0aGUgbWFpbiBjYWNoZS5cbiAgICAgIHByb21pc2VzLnB1c2guYXBwbHkocHJvbWlzZXMsIG5ld1Byb21pc2VzKTtcblxuICAgICAgLy8gUmVjdXJzaXZlbHkgY2FsbCBpbnRvIHRoZSBjaGlsZHJlbiBpZiBhdHRhY2hlZCBvciBkZXRhY2hlZC5cbiAgICAgIGlmIChzdGF0ZU5hbWUgPT09ICdhdHRhY2hlZCcgfHwgc3RhdGVOYW1lID09PSAnZGV0YWNoZWQnKSB7XG4gICAgICAgIG1ha2Vbc3RhdGVOYW1lXShlbGVtZW50LmNoaWxkTm9kZXMsIGFyZ3MsIHByb21pc2VzKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBwcm9taXNlcztcbiAgfTtcbn0pO1xuXG4vKipcbiAqIEJ1aWxkcyBhIHJldXNhYmxlIHRyaWdnZXIgbWVjaGFuaXNtIGZvciB0aGUgZWxlbWVudCB0cmFuc2l0aW9ucy5cbiAqXG4gKiBAcGFyYW0gc3RhdGVOYW1lXG4gKiBAcGFyYW0gbm9kZXNcbiAqIEBwYXJhbSBjYWxsYmFja1xuICogQHJldHVyblxuICovXG5mdW5jdGlvbiBidWlsZFRyaWdnZXIoYWxsUHJvbWlzZXMpIHtcbiAgdmFyIGFkZFByb21pc2VzID0gYWxsUHJvbWlzZXMucHVzaC5hcHBseS5iaW5kKGFsbFByb21pc2VzLnB1c2gsIGFsbFByb21pc2VzKTtcblxuICAvLyBUaGlzIGJlY29tZXMgYHRyaWdnZXJUcmFuc2l0aW9uYCBpbiBwcm9jZXNzLmpzLlxuICByZXR1cm4gZnVuY3Rpb24gKHN0YXRlTmFtZSwgbWFrZVByb21pc2VzQ2FsbGJhY2ssIGNhbGxiYWNrKSB7XG4gICAgaWYgKHN0YXRlc1tzdGF0ZU5hbWVdICYmIHN0YXRlc1tzdGF0ZU5hbWVdLmxlbmd0aCkge1xuICAgICAgLy8gQ2FsbHMgaW50byBlYWNoIGN1c3RvbSBob29rIHRvIGJpbmQgUHJvbWlzZXMgaW50byB0aGUgbG9jYWwgYXJyYXksXG4gICAgICAvLyB0aGVzZSB3aWxsIHRoZW4gZ2V0IG1lcmdlZCBpbnRvIHRoZSBtYWluIGBhbGxQcm9taXNlc2AgYXJyYXkuXG4gICAgICB2YXIgcHJvbWlzZXMgPSBtYWtlUHJvbWlzZXNDYWxsYmFjayhbXSk7XG5cbiAgICAgIC8vIEFkZCB0aGVzZSBwcm9taXNlcyBpbnRvIHRoZSBnbG9iYWwgY2FjaGUuXG4gICAgICBhZGRQcm9taXNlcyhwcm9taXNlcyk7XG5cbiAgICAgIGlmICghcHJvbWlzZXMubGVuZ3RoICYmIGNhbGxiYWNrKSB7XG4gICAgICAgIGNhbGxiYWNrKHByb21pc2VzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGNhbGxiYWNrLCBmdW5jdGlvbiBoYW5kbGVSZWplY3Rpb24oZXgpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhleCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoY2FsbGJhY2spIHtcbiAgICAgIGNhbGxiYWNrKCk7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIFRyaWdnZXJzIHRoZSBsaWZlY3ljbGUgZXZlbnRzIG9uIGFuIEhUTUxFbGVtZW50LlxuICpcbiAqIEBwYXJhbSBzdGF0ZU5hbWVcbiAqIEBwYXJhbSBlbGVtZW50c1xuICogQHJldHVyblxuICovXG5mdW5jdGlvbiB0cmlnZ2VyTGlmZWN5Y2xlRXZlbnQoc3RhdGVOYW1lLCBhcmdzLCBlbGVtZW50cykge1xuICAvLyBUcmlnZ2VyIGN1c3RvbSBlbGVtZW50XG4gIHZhciBjdXN0b21FbGVtZW50Rm4gPSBmblNpZ25hdHVyZXNbc3RhdGVOYW1lXS5jdXN0b21FbGVtZW50c0ZuO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgZWxlbWVudCA9IGVsZW1lbnRzW2ldO1xuICAgIHZhciBpc1RleHROb2RlID0gZWxlbWVudC5ub2RlVHlwZSA9PT0gMztcbiAgICB2YXIgbm9kZU5hbWUgPSBlbGVtZW50Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgdmFyIGRlc2NyaXB0b3IgPSAoMCwgX21ha2UyLmRlZmF1bHQpKGVsZW1lbnQpO1xuXG4gICAgLy8gVmFsdWUgb2YgdGhlIGBpc2AgYXR0cmlidXRlLCBpZiBpdCBleGlzdHMuXG4gICAgdmFyIGlzQXR0ciA9IG51bGw7XG5cbiAgICAvLyBDaGVjayBmb3IgdGhlIGBpc2AgYXR0cmlidXRlLiBJdCBoYXMgYSBrbm93biBidWcgd2hlcmUgaXQgY2Fubm90IGJlXG4gICAgLy8gYXBwbGllZCBkeW5hbWljYWxseS5cbiAgICBpZiAoIV9jdXN0b20uY29tcG9uZW50c1tub2RlTmFtZV0gJiYgQXJyYXkuaXNBcnJheShkZXNjcmlwdG9yLmF0dHJpYnV0ZXMpKSB7XG4gICAgICBkZXNjcmlwdG9yLmF0dHJpYnV0ZXMuc29tZShmdW5jdGlvbiAoYXR0ciwgaWR4KSB7XG4gICAgICAgIGlmIChhdHRyLm5hbWUgPT09ICdpcycpIHtcbiAgICAgICAgICBpc0F0dHIgPSBhdHRyLnZhbHVlO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBIYWNrIGFyb3VuZCB0aGUgYGlzYCBhdHRyaWJ1dGUgYmVpbmcgdW5hYmxlIHRvIGJlIHNldCBkeW5hbWljYWxseS5cbiAgICBpZiAoaXNBdHRyICYmIF9jdXN0b20uY29tcG9uZW50c1tpc0F0dHJdKSB7XG4gICAgICBub2RlTmFtZSA9IGlzQXR0cjtcbiAgICB9XG5cbiAgICB2YXIgY3VzdG9tRWxlbWVudCA9IF9jdXN0b20uY29tcG9uZW50c1tub2RlTmFtZV0gfHwgZW1wdHk7XG4gICAgdmFyIGN1c3RvbUVsZW1lbnRNZXRob2ROYW1lID0gc3RhdGVOYW1lICsgJ0NhbGxiYWNrJztcblxuICAgIC8vIENhbGwgdGhlIGFzc29jaWF0ZWQgQ3VzdG9tRWxlbWVudCdzIGxpZmVjeWNsZSBjYWxsYmFjaywgaWYgaXQgZXhpc3RzLlxuICAgIGlmIChjdXN0b21FbGVtZW50LnByb3RvdHlwZVtjdXN0b21FbGVtZW50TWV0aG9kTmFtZV0pIHtcbiAgICAgIGN1c3RvbUVsZW1lbnRGbi5hcHBseShudWxsLCBhcmdzKShjdXN0b21FbGVtZW50LnByb3RvdHlwZVtjdXN0b21FbGVtZW50TWV0aG9kTmFtZV0uYmluZChlbGVtZW50KSk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogTWFrZSBhIHJldXNhYmxlIGZ1bmN0aW9uIGZvciBlYXN5IHRyYW5zaXRpb24gY2FsbGluZy5cbiAqXG4gKiBAcGFyYW0gc3RhdGVOYW1lXG4gKiBAcGFyYW0gZWxlbWVudHNcbiAqIEByZXR1cm5cbiAqL1xuZnVuY3Rpb24gbWFrZVByb21pc2VzKHN0YXRlTmFtZSkge1xuICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgfVxuXG4gIC8vIEVuc3VyZSBlbGVtZW50cyBpcyBhbHdheXMgYW4gYXJyYXkuXG4gIHZhciBlbGVtZW50cyA9IHNsaWNlLmNhbGwoYXJnc1swXSk7XG5cbiAgLy8gVHJpZ2dlcnMgdGhlIGN1c3RvbSBlbGVtZW50IGNhbGxiYWNrLlxuICB0cmlnZ2VyTGlmZWN5Y2xlRXZlbnQoc3RhdGVOYW1lLCBhcmdzLnNsaWNlKDEpLCBlbGVtZW50cyk7XG5cbiAgLy8gQWNjZXB0cyB0aGUgbG9jYWwgQXJyYXkgb2YgcHJvbWlzZXMgdG8gdXNlLlxuICByZXR1cm4gZnVuY3Rpb24gKHByb21pc2VzKSB7XG4gICAgcmV0dXJuIG1ha2Vbc3RhdGVOYW1lXShlbGVtZW50cywgYXJncy5zbGljZSgxKSwgcHJvbWlzZXMpO1xuICB9O1xufVxuXG59LHtcIi4vZWxlbWVudC9jdXN0b21cIjoxLFwiLi9ub2RlL21ha2VcIjo2fV0sMTQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWNvZGVFbnRpdGllcyA9IGRlY29kZUVudGl0aWVzO1xudmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuLyoqXG4gKiBEZWNvZGVzIEhUTUwgc3RyaW5ncy5cbiAqXG4gKiBAc2VlIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzU3OTY3MThcbiAqIEBwYXJhbSBzdHJpbmdpbmdcbiAqIEByZXR1cm4gdW5lc2NhcGVkIEhUTUxcbiAqL1xuZnVuY3Rpb24gZGVjb2RlRW50aXRpZXMoc3RyaW5nKSB7XG4gIGVsZW1lbnQuaW5uZXJIVE1MID0gc3RyaW5nO1xuXG4gIHJldHVybiBlbGVtZW50LnRleHRDb250ZW50O1xufVxuXG59LHt9XSwxNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnByb3RlY3RFbGVtZW50ID0gcHJvdGVjdEVsZW1lbnQ7XG5leHBvcnRzLnVucHJvdGVjdEVsZW1lbnQgPSB1bnByb3RlY3RFbGVtZW50O1xuZXhwb3J0cy5jbGVhbk1lbW9yeSA9IGNsZWFuTWVtb3J5O1xuXG52YXIgX3Bvb2xzMiA9IF9kZXJlcV8oJy4uL3V0aWwvcG9vbHMnKTtcblxudmFyIF9tYWtlID0gX2RlcmVxXygnLi4vbm9kZS9tYWtlJyk7XG5cbnZhciBfbWFrZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tYWtlKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIHBvb2xzID0gX3Bvb2xzMi5wb29scztcbnZhciBtYWtlTm9kZSA9IF9tYWtlMi5kZWZhdWx0O1xuXG4vKipcbiAqIEVuc3VyZXMgdGhhdCBhbiBlbGVtZW50IGlzIG5vdCByZWN5Y2xlZCBkdXJpbmcgYSByZW5kZXIgY3ljbGUuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRcbiAqIEByZXR1cm4gZWxlbWVudFxuICovXG5mdW5jdGlvbiBwcm90ZWN0RWxlbWVudChlbGVtZW50KSB7XG4gIHZhciBlbGVtZW50T2JqZWN0ID0gcG9vbHMuZWxlbWVudE9iamVjdDtcbiAgdmFyIGF0dHJpYnV0ZU9iamVjdCA9IHBvb2xzLmF0dHJpYnV0ZU9iamVjdDtcblxuICBlbGVtZW50T2JqZWN0LnByb3RlY3QoZWxlbWVudCk7XG5cbiAgZWxlbWVudC5hdHRyaWJ1dGVzLmZvckVhY2goYXR0cmlidXRlT2JqZWN0LnByb3RlY3QsIGF0dHJpYnV0ZU9iamVjdCk7XG5cbiAgaWYgKGVsZW1lbnQuY2hpbGROb2Rlcykge1xuICAgIGVsZW1lbnQuY2hpbGROb2Rlcy5mb3JFYWNoKHByb3RlY3RFbGVtZW50KTtcbiAgfVxuXG4gIHJldHVybiBlbGVtZW50O1xufVxuXG4vKipcbiAqIEFsbG93cyBhbiBlbGVtZW50IHRvIGJlIHJlY3ljbGVkIGR1cmluZyBhIHJlbmRlciBjeWNsZS5cbiAqXG4gKiBAcGFyYW0gZWxlbWVudFxuICogQHJldHVyblxuICovXG5mdW5jdGlvbiB1bnByb3RlY3RFbGVtZW50KGVsZW1lbnQsIG1ha2VOb2RlKSB7XG4gIHZhciBlbGVtZW50T2JqZWN0ID0gcG9vbHMuZWxlbWVudE9iamVjdDtcbiAgdmFyIGF0dHJpYnV0ZU9iamVjdCA9IHBvb2xzLmF0dHJpYnV0ZU9iamVjdDtcblxuICBlbGVtZW50T2JqZWN0LnVucHJvdGVjdChlbGVtZW50KTtcbiAgZWxlbWVudE9iamVjdC5jYWNoZS51dWlkLmRlbGV0ZShlbGVtZW50LnV1aWQpO1xuXG4gIGVsZW1lbnQuYXR0cmlidXRlcy5mb3JFYWNoKGF0dHJpYnV0ZU9iamVjdC51bnByb3RlY3QsIGF0dHJpYnV0ZU9iamVjdCk7XG5cbiAgaWYgKGVsZW1lbnQuY2hpbGROb2Rlcykge1xuICAgIGVsZW1lbnQuY2hpbGROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICByZXR1cm4gdW5wcm90ZWN0RWxlbWVudChub2RlLCBtYWtlTm9kZSk7XG4gICAgfSk7XG4gIH1cblxuICBpZiAobWFrZU5vZGUgJiYgbWFrZU5vZGUubm9kZXMpIHtcbiAgICBkZWxldGUgbWFrZU5vZGUubm9kZXNbZWxlbWVudC51dWlkXTtcbiAgfVxuXG4gIHJldHVybiBlbGVtZW50O1xufVxuXG4vKipcbiAqIFJlY3ljbGVzIGFsbCB1bnByb3RlY3RlZCBhbGxvY2F0aW9ucy5cbiAqL1xuZnVuY3Rpb24gY2xlYW5NZW1vcnkobWFrZU5vZGUpIHtcbiAgdmFyIGVsZW1lbnRPYmplY3QgPSBwb29scy5lbGVtZW50T2JqZWN0O1xuICB2YXIgYXR0cmlidXRlT2JqZWN0ID0gcG9vbHMuYXR0cmlidXRlT2JqZWN0O1xuXG4gIC8vIENsZWFuIG91dCB1bnVzZWQgZWxlbWVudHMuXG4gIGlmIChtYWtlTm9kZSAmJiBtYWtlTm9kZS5ub2Rlcykge1xuICAgIGZvciAodmFyIHV1aWQgaW4gbWFrZU5vZGUubm9kZXMpIHtcbiAgICAgIGlmICghZWxlbWVudE9iamVjdC5jYWNoZS51dWlkLmhhcyh1dWlkKSkge1xuICAgICAgICBkZWxldGUgbWFrZU5vZGUubm9kZXNbdXVpZF07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gRW1wdHkgYWxsIGVsZW1lbnQgYWxsb2NhdGlvbnMuXG4gIGVsZW1lbnRPYmplY3QuY2FjaGUuYWxsb2NhdGVkLmZvckVhY2goZnVuY3Rpb24gKHYpIHtcbiAgICBlbGVtZW50T2JqZWN0LmNhY2hlLmZyZWUucHVzaCh2KTtcbiAgfSk7XG5cbiAgZWxlbWVudE9iamVjdC5jYWNoZS5hbGxvY2F0ZWQuY2xlYXIoKTtcblxuICAvLyBFbXB0eSBhbGwgYXR0cmlidXRlIGFsbG9jYXRpb25zLlxuICBhdHRyaWJ1dGVPYmplY3QuY2FjaGUuYWxsb2NhdGVkLmZvckVhY2goZnVuY3Rpb24gKHYpIHtcbiAgICBhdHRyaWJ1dGVPYmplY3QuY2FjaGUuZnJlZS5wdXNoKHYpO1xuICB9KTtcblxuICBhdHRyaWJ1dGVPYmplY3QuY2FjaGUuYWxsb2NhdGVkLmNsZWFyKCk7XG59XG5cbn0se1wiLi4vbm9kZS9tYWtlXCI6NixcIi4uL3V0aWwvcG9vbHNcIjoxN31dLDE2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMucGFyc2VIVE1MID0gcGFyc2VIVE1MO1xuZXhwb3J0cy5tYWtlUGFyc2VyID0gbWFrZVBhcnNlcjtcblxudmFyIF9wb29sczIgPSBfZGVyZXFfKCcuL3Bvb2xzJyk7XG5cbnZhciBwb29scyA9IF9wb29sczIucG9vbHM7IC8vIENvZGUgYmFzZWQgb2ZmIG9mOlxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2FzaGkwMDkvbm9kZS1mYXN0LWh0bWwtcGFyc2VyXG5cbnZhciBwYXJzZXIgPSBtYWtlUGFyc2VyKCk7XG52YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cbi8qKlxuICogcGFyc2VIVE1MXG4gKlxuICogQHBhcmFtIG5ld0hUTUxcbiAqIEByZXR1cm5cbiAqL1xuZnVuY3Rpb24gcGFyc2VIVE1MKG5ld0hUTUwsIGlzSW5uZXIpIHtcbiAgdmFyIGRvY3VtZW50RWxlbWVudCA9IHBhcnNlci5wYXJzZShuZXdIVE1MKTtcbiAgdmFyIG5vZGVzID0gZG9jdW1lbnRFbGVtZW50LmNoaWxkTm9kZXM7XG5cbiAgcmV0dXJuIGlzSW5uZXIgPyBub2RlcyA6IG5vZGVzWzBdO1xufVxuXG4vKipcbiAqIG1ha2VQYXJzZXJcbiAqXG4gKiBAcmV0dXJuXG4gKi9cbmZ1bmN0aW9uIG1ha2VQYXJzZXIoKSB7XG4gIHZhciBrTWFya3VwUGF0dGVybiA9IC88IS0tW15dKj8oPz0tLT4pLS0+fDwoXFwvPykoW2EtelxcLV1bYS16MC05XFwtXSopXFxzKihbXj5dKj8pKFxcLz8pPi9pZztcblxuICB2YXIga0F0dHJpYnV0ZVBhdHRlcm4gPSAvXFxiKGlkfGNsYXNzKVxccyooPVxccyooXCIoW15cIl0rKVwifCcoW14nXSspJ3woXFxTKykpKT8vaWc7XG5cbiAgdmFyIHJlQXR0clBhdHRlcm4gPSAvXFxiKFthLXpdW2EtejAtOVxcLV0qKVxccyooPVxccyooXCIoW15cIl0rKVwifCcoW14nXSspJ3woXFxTKykpKT8vaWc7XG5cbiAgdmFyIGtTZWxmQ2xvc2luZ0VsZW1lbnRzID0ge1xuICAgIG1ldGE6IHRydWUsXG4gICAgaW1nOiB0cnVlLFxuICAgIGxpbms6IHRydWUsXG4gICAgaW5wdXQ6IHRydWUsXG4gICAgYXJlYTogdHJ1ZSxcbiAgICBicjogdHJ1ZSxcbiAgICBocjogdHJ1ZVxuICB9O1xuXG4gIHZhciBrRWxlbWVudHNDbG9zZWRCeU9wZW5pbmcgPSB7XG4gICAgbGk6IHtcbiAgICAgIGxpOiB0cnVlXG4gICAgfSxcblxuICAgIHA6IHtcbiAgICAgIHA6IHRydWUsIGRpdjogdHJ1ZVxuICAgIH0sXG5cbiAgICB0ZDoge1xuICAgICAgdGQ6IHRydWUsIHRoOiB0cnVlXG4gICAgfSxcblxuICAgIHRoOiB7XG4gICAgICB0ZDogdHJ1ZSwgdGg6IHRydWVcbiAgICB9XG4gIH07XG5cbiAgdmFyIGtFbGVtZW50c0Nsb3NlZEJ5Q2xvc2luZyA9IHtcbiAgICBsaToge1xuICAgICAgdWw6IHRydWUsIG9sOiB0cnVlXG4gICAgfSxcblxuICAgIGE6IHtcbiAgICAgIGRpdjogdHJ1ZVxuICAgIH0sXG5cbiAgICBiOiB7XG4gICAgICBkaXY6IHRydWVcbiAgICB9LFxuXG4gICAgaToge1xuICAgICAgZGl2OiB0cnVlXG4gICAgfSxcblxuICAgIHA6IHtcbiAgICAgIGRpdjogdHJ1ZVxuICAgIH0sXG5cbiAgICB0ZDoge1xuICAgICAgdHI6IHRydWUsIHRhYmxlOiB0cnVlXG4gICAgfSxcblxuICAgIHRoOiB7XG4gICAgICB0cjogdHJ1ZSwgdGFibGU6IHRydWVcbiAgICB9XG4gIH07XG5cbiAgdmFyIGtCbG9ja1RleHRFbGVtZW50cyA9IHtcbiAgICBzY3JpcHQ6IHRydWUsXG4gICAgbm9zY3JpcHQ6IHRydWUsXG4gICAgc3R5bGU6IHRydWUsXG4gICAgdGVtcGxhdGU6IHRydWVcbiAgfTtcblxuICB2YXIgZXNjYXBlTWFwID0ge1xuICAgICcmJzogJyZhbXA7JyxcbiAgICAnPCc6ICcmbHQ7JyxcbiAgICAnPic6ICcmZ3Q7JyxcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjeDI3OycsXG4gICAgJ2AnOiAnJiN4NjA7J1xuICB9O1xuXG4gIC8qKlxuICAgKiBUZXh0Tm9kZSB0byBjb250YWluIGEgdGV4dCBlbGVtZW50IGluIERPTSB0cmVlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgW2Rlc2NyaXB0aW9uXVxuICAgKi9cbiAgZnVuY3Rpb24gVGV4dE5vZGUodmFsdWUpIHtcbiAgICB2YXIgaW5zdGFuY2UgPSBwb29scy5lbGVtZW50T2JqZWN0LmdldCgpO1xuXG4gICAgaW5zdGFuY2Uubm9kZU5hbWUgPSAnI3RleHQnO1xuICAgIGluc3RhbmNlLm5vZGVWYWx1ZSA9IHZhbHVlO1xuICAgIGluc3RhbmNlLm5vZGVUeXBlID0gMztcbiAgICBpbnN0YW5jZS5jaGlsZE5vZGVzLmxlbmd0aCA9IDA7XG4gICAgaW5zdGFuY2UuYXR0cmlidXRlcy5sZW5ndGggPSAwO1xuXG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEhUTUxFbGVtZW50LCB3aGljaCBjb250YWlucyBhIHNldCBvZiBjaGlsZHJlbi5cbiAgICpcbiAgICogTm90ZTogdGhpcyBpcyBhIG1pbmltYWxpc3QgaW1wbGVtZW50YXRpb24sIG5vIGNvbXBsZXRlIHRyZWUgc3RydWN0dXJlXG4gICAqIHByb3ZpZGVkIChubyBwYXJlbnROb2RlLCBuZXh0U2libGluZywgcHJldmlvdXNTaWJsaW5nIGV0YykuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lICAgICBub2RlTmFtZVxuICAgKiBAcGFyYW0ge09iamVjdH0ga2V5QXR0cnMgaWQgYW5kIGNsYXNzIGF0dHJpYnV0ZVxuICAgKiBAcGFyYW0ge09iamVjdH0gcmF3QXR0cnMgYXR0cmlidXRlcyBpbiBzdHJpbmdcbiAgICovXG4gIGZ1bmN0aW9uIEhUTUxFbGVtZW50KG5hbWUsIGtleUF0dHJzLCByYXdBdHRycykge1xuICAgIHZhciBpbnN0YW5jZSA9IHBvb2xzLmVsZW1lbnRPYmplY3QuZ2V0KCk7XG5cbiAgICBpbnN0YW5jZS5ub2RlTmFtZSA9IG5hbWU7XG4gICAgaW5zdGFuY2Uubm9kZVZhbHVlID0gJyc7XG4gICAgaW5zdGFuY2Uubm9kZVR5cGUgPSAxO1xuICAgIGluc3RhbmNlLmNoaWxkTm9kZXMubGVuZ3RoID0gMDtcbiAgICBpbnN0YW5jZS5hdHRyaWJ1dGVzLmxlbmd0aCA9IDA7XG5cbiAgICBpZiAocmF3QXR0cnMpIHtcbiAgICAgIGZvciAodmFyIG1hdGNoOyBtYXRjaCA9IHJlQXR0clBhdHRlcm4uZXhlYyhyYXdBdHRycyk7KSB7XG4gICAgICAgIHZhciBhdHRyID0gcG9vbHMuYXR0cmlidXRlT2JqZWN0LmdldCgpO1xuXG4gICAgICAgIGF0dHIubmFtZSA9IG1hdGNoWzFdO1xuICAgICAgICBhdHRyLnZhbHVlID0gbWF0Y2hbNl0gfHwgbWF0Y2hbNV0gfHwgbWF0Y2hbNF0gfHwgbWF0Y2hbMV07XG5cbiAgICAgICAgLy8gTG9vayBmb3IgZW1wdHkgYXR0cmlidXRlcy5cbiAgICAgICAgaWYgKG1hdGNoWzZdID09PSAnXCJcIicpIHtcbiAgICAgICAgICBhdHRyLnZhbHVlID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBpbnN0YW5jZS5hdHRyaWJ1dGVzLnB1c2goYXR0cik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlcyBIVE1MIGFuZCByZXR1cm5zIGEgcm9vdCBlbGVtZW50XG4gICAqL1xuICB2YXIgaHRtbFBhcnNlciA9IHtcbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIGNodWNrIG9mIEhUTUwgc291cmNlLlxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gZGF0YSAgICAgIGh0bWxcbiAgICAgKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gICAgICByb290IGVsZW1lbnRcbiAgICAgKi9cbiAgICBwYXJzZTogZnVuY3Rpb24gcGFyc2UoZGF0YSkge1xuICAgICAgdmFyIHJvb3RPYmplY3QgPSB7fTtcbiAgICAgIHZhciByb290ID0gSFRNTEVsZW1lbnQobnVsbCwgcm9vdE9iamVjdCk7XG4gICAgICB2YXIgY3VycmVudFBhcmVudCA9IHJvb3Q7XG4gICAgICB2YXIgc3RhY2sgPSBbcm9vdF07XG4gICAgICB2YXIgbGFzdFRleHRQb3MgPSAtMTtcblxuICAgICAgaWYgKGRhdGEuaW5kZXhPZignPCcpID09PSAtMSAmJiBkYXRhKSB7XG4gICAgICAgIGN1cnJlbnRQYXJlbnQuY2hpbGROb2Rlcy5wdXNoKFRleHROb2RlKGRhdGEpKTtcblxuICAgICAgICByZXR1cm4gcm9vdDtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgbWF0Y2gsIHRleHQ7IG1hdGNoID0ga01hcmt1cFBhdHRlcm4uZXhlYyhkYXRhKTspIHtcbiAgICAgICAgaWYgKGxhc3RUZXh0UG9zID4gLTEpIHtcbiAgICAgICAgICBpZiAobGFzdFRleHRQb3MgKyBtYXRjaFswXS5sZW5ndGggPCBrTWFya3VwUGF0dGVybi5sYXN0SW5kZXgpIHtcbiAgICAgICAgICAgIC8vIGlmIGhhcyBjb250ZW50XG4gICAgICAgICAgICB0ZXh0ID0gZGF0YS5zbGljZShsYXN0VGV4dFBvcywga01hcmt1cFBhdHRlcm4ubGFzdEluZGV4IC0gbWF0Y2hbMF0ubGVuZ3RoKTtcblxuICAgICAgICAgICAgY3VycmVudFBhcmVudC5jaGlsZE5vZGVzLnB1c2goVGV4dE5vZGUodGV4dCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxhc3RUZXh0UG9zID0ga01hcmt1cFBhdHRlcm4ubGFzdEluZGV4O1xuXG4gICAgICAgIC8vIFRoaXMgaXMgYSBjb21tZW50LlxuICAgICAgICBpZiAobWF0Y2hbMF1bMV0gPT09ICchJykge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFtYXRjaFsxXSkge1xuICAgICAgICAgIC8vIG5vdCA8LyB0YWdzXG4gICAgICAgICAgdmFyIGF0dHJzID0ge307XG5cbiAgICAgICAgICBmb3IgKHZhciBhdHRNYXRjaDsgYXR0TWF0Y2ggPSBrQXR0cmlidXRlUGF0dGVybi5leGVjKG1hdGNoWzNdKTspIHtcbiAgICAgICAgICAgIGF0dHJzW2F0dE1hdGNoWzFdXSA9IGF0dE1hdGNoWzNdIHx8IGF0dE1hdGNoWzRdIHx8IGF0dE1hdGNoWzVdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghbWF0Y2hbNF0gJiYga0VsZW1lbnRzQ2xvc2VkQnlPcGVuaW5nW2N1cnJlbnRQYXJlbnQubm9kZU5hbWVdKSB7XG4gICAgICAgICAgICBpZiAoa0VsZW1lbnRzQ2xvc2VkQnlPcGVuaW5nW2N1cnJlbnRQYXJlbnQubm9kZU5hbWVdW21hdGNoWzJdXSkge1xuICAgICAgICAgICAgICBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgY3VycmVudFBhcmVudCA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGN1cnJlbnRQYXJlbnQgPSBjdXJyZW50UGFyZW50LmNoaWxkTm9kZXNbY3VycmVudFBhcmVudC5jaGlsZE5vZGVzLnB1c2goSFRNTEVsZW1lbnQobWF0Y2hbMl0sIGF0dHJzLCBtYXRjaFszXSkpIC0gMV07XG5cbiAgICAgICAgICBzdGFjay5wdXNoKGN1cnJlbnRQYXJlbnQpO1xuXG4gICAgICAgICAgaWYgKGtCbG9ja1RleHRFbGVtZW50c1ttYXRjaFsyXV0pIHtcbiAgICAgICAgICAgIC8vIEEgbGl0dGxlIHRlc3QgdG8gZmluZCBuZXh0IDwvc2NyaXB0PiBvciA8L3N0eWxlPiAuLi5cbiAgICAgICAgICAgIHZhciBjbG9zZU1hcmt1cCA9ICc8LycgKyBtYXRjaFsyXSArICc+JztcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGRhdGEuaW5kZXhPZihjbG9zZU1hcmt1cCwga01hcmt1cFBhdHRlcm4ubGFzdEluZGV4KTtcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSBtYXRjaFsyXS5sZW5ndGg7XG5cbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgbGFzdFRleHRQb3MgPSBrTWFya3VwUGF0dGVybi5sYXN0SW5kZXggPSBkYXRhLmxlbmd0aCArIDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBsYXN0VGV4dFBvcyA9IGtNYXJrdXBQYXR0ZXJuLmxhc3RJbmRleCA9IGluZGV4ICsgY2xvc2VNYXJrdXAubGVuZ3RoO1xuICAgICAgICAgICAgICBtYXRjaFsxXSA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBuZXdUZXh0ID0gZGF0YS5zbGljZShtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aCwgaW5kZXgpO1xuXG4gICAgICAgICAgICBpZiAobmV3VGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgICAgbmV3VGV4dCA9IHNsaWNlLmNhbGwobmV3VGV4dCkubWFwKGZ1bmN0aW9uIChjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlc2NhcGVNYXBbY2hdIHx8IGNoO1xuICAgICAgICAgICAgICB9KS5qb2luKCcnKTtcblxuICAgICAgICAgICAgICBjdXJyZW50UGFyZW50LmNoaWxkTm9kZXMucHVzaChUZXh0Tm9kZShuZXdUZXh0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChtYXRjaFsxXSB8fCBtYXRjaFs0XSB8fCBrU2VsZkNsb3NpbmdFbGVtZW50c1ttYXRjaFsyXV0pIHtcbiAgICAgICAgICAvLyA8LyBvciAvPiBvciA8YnI+IGV0Yy5cbiAgICAgICAgICB3aGlsZSAoY3VycmVudFBhcmVudCkge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRQYXJlbnQubm9kZU5hbWUgPT0gbWF0Y2hbMl0pIHtcbiAgICAgICAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgICAgICAgIGN1cnJlbnRQYXJlbnQgPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTtcblxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIFRyeWluZyB0byBjbG9zZSBjdXJyZW50IHRhZywgYW5kIG1vdmUgb25cbiAgICAgICAgICAgICAgaWYgKGtFbGVtZW50c0Nsb3NlZEJ5Q2xvc2luZ1tjdXJyZW50UGFyZW50Lm5vZGVOYW1lXSkge1xuICAgICAgICAgICAgICAgIGlmIChrRWxlbWVudHNDbG9zZWRCeUNsb3NpbmdbY3VycmVudFBhcmVudC5ub2RlTmFtZV1bbWF0Y2hbMl1dKSB7XG4gICAgICAgICAgICAgICAgICBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXJlbnQgPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTtcblxuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLy8gVXNlIGFnZ3Jlc3NpdmUgc3RyYXRlZ3kgdG8gaGFuZGxlIHVubWF0Y2hpbmcgbWFya3Vwcy5cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRoaXMgaXMgYW4gZW50aXJlIGRvY3VtZW50LCBzbyBvbmx5IGFsbG93IHRoZSBIVE1MIGNoaWxkcmVuIHRvIGJlXG4gICAgICAvLyBib2R5IG9yIGhlYWQuXG4gICAgICBpZiAocm9vdC5jaGlsZE5vZGVzLmxlbmd0aCAmJiByb290LmNoaWxkTm9kZXNbMF0ubm9kZU5hbWUgPT09ICdodG1sJykge1xuICAgICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIC8vIFN0b3JlIGVsZW1lbnRzIGZyb20gYmVmb3JlIGJvZHkgZW5kIGFuZCBhZnRlciBib2R5IGVuZC5cbiAgICAgICAgICB2YXIgaGVhZCA9IHsgYmVmb3JlOiBbXSwgYWZ0ZXI6IFtdIH07XG4gICAgICAgICAgdmFyIGJvZHkgPSB7IGFmdGVyOiBbXSB9O1xuICAgICAgICAgIHZhciBiZWZvcmVIZWFkID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgYmVmb3JlQm9keSA9IHRydWU7XG4gICAgICAgICAgdmFyIEhUTUwgPSByb290LmNoaWxkTm9kZXNbMF07XG5cbiAgICAgICAgICAvLyBJdGVyYXRlIHRoZSBjaGlsZHJlbiBhbmQgc3RvcmUgZWxlbWVudHMgaW4gdGhlIHByb3BlciBhcnJheSBmb3JcbiAgICAgICAgICAvLyBsYXRlciBjb25jYXQsIHJlcGxhY2UgdGhlIGN1cnJlbnQgY2hpbGROb2RlcyB3aXRoIHRoaXMgbmV3IGFycmF5LlxuICAgICAgICAgIEhUTUwuY2hpbGROb2RlcyA9IEhUTUwuY2hpbGROb2Rlcy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAvLyBJZiBlaXRoZXIgYm9keSBvciBoZWFkLCBhbGxvdyBhcyBhIHZhbGlkIGVsZW1lbnQuXG4gICAgICAgICAgICBpZiAoZWwubm9kZU5hbWUgPT09ICdib2R5JyB8fCBlbC5ub2RlTmFtZSA9PT0gJ2hlYWQnKSB7XG4gICAgICAgICAgICAgIGlmIChlbC5ub2RlTmFtZSA9PT0gJ2hlYWQnKSB7XG4gICAgICAgICAgICAgICAgYmVmb3JlSGVhZCA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGVsLm5vZGVOYW1lID09PSAnYm9keScpIHtcbiAgICAgICAgICAgICAgICBiZWZvcmVCb2R5ID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIE5vdCBhIHZhbGlkIG5lc3RlZCBIVE1MIHRhZyBlbGVtZW50LCBtb3ZlIHRvIHJlc3BlY3RpdmUgY29udGFpbmVyLlxuICAgICAgICAgICAgZWxzZSBpZiAoZWwubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAoYmVmb3JlSGVhZCAmJiBiZWZvcmVCb2R5KSB7XG4gICAgICAgICAgICAgICAgICBoZWFkLmJlZm9yZS5wdXNoKGVsKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFiZWZvcmVIZWFkICYmIGJlZm9yZUJvZHkpIHtcbiAgICAgICAgICAgICAgICAgIGhlYWQuYWZ0ZXIucHVzaChlbCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghYmVmb3JlQm9keSkge1xuICAgICAgICAgICAgICAgICAgYm9keS5hZnRlci5wdXNoKGVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIEVuc3VyZSB0aGUgZmlyc3QgZWxlbWVudCBpcyB0aGUgSEVBRCB0YWcuXG4gICAgICAgICAgaWYgKCFIVE1MLmNoaWxkTm9kZXNbMF0gfHwgSFRNTC5jaGlsZE5vZGVzWzBdLm5vZGVOYW1lICE9PSAnaGVhZCcpIHtcbiAgICAgICAgICAgIHZhciBoZWFkSW5zdGFuY2UgPSBwb29scy5lbGVtZW50T2JqZWN0LmdldCgpO1xuICAgICAgICAgICAgaGVhZEluc3RhbmNlLm5vZGVOYW1lID0gJ2hlYWQnO1xuICAgICAgICAgICAgaGVhZEluc3RhbmNlLmNoaWxkTm9kZXMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgIGhlYWRJbnN0YW5jZS5hdHRyaWJ1dGVzLmxlbmd0aCA9IDA7XG5cbiAgICAgICAgICAgIHZhciBleGlzdGluZyA9IGhlYWRJbnN0YW5jZS5jaGlsZE5vZGVzO1xuICAgICAgICAgICAgZXhpc3RpbmcudW5zaGlmdC5hcHBseShleGlzdGluZywgaGVhZC5iZWZvcmUpO1xuICAgICAgICAgICAgZXhpc3RpbmcucHVzaC5hcHBseShleGlzdGluZywgaGVhZC5hZnRlcik7XG5cbiAgICAgICAgICAgIEhUTUwuY2hpbGROb2Rlcy51bnNoaWZ0KGhlYWRJbnN0YW5jZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBfZXhpc3RpbmcgPSBIVE1MLmNoaWxkTm9kZXNbMF0uY2hpbGROb2RlcztcbiAgICAgICAgICAgIF9leGlzdGluZy51bnNoaWZ0LmFwcGx5KF9leGlzdGluZywgaGVhZC5iZWZvcmUpO1xuICAgICAgICAgICAgX2V4aXN0aW5nLnB1c2guYXBwbHkoX2V4aXN0aW5nLCBoZWFkLmFmdGVyKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBFbnN1cmUgdGhlIHNlY29uZCBlbGVtZW50IGlzIHRoZSBib2R5IHRhZy5cbiAgICAgICAgICBpZiAoIUhUTUwuY2hpbGROb2Rlc1sxXSB8fCBIVE1MLmNoaWxkTm9kZXNbMV0ubm9kZU5hbWUgIT09ICdib2R5Jykge1xuICAgICAgICAgICAgdmFyIGJvZHlJbnN0YW5jZSA9IHBvb2xzLmVsZW1lbnRPYmplY3QuZ2V0KCk7XG4gICAgICAgICAgICBib2R5SW5zdGFuY2Uubm9kZU5hbWUgPSAnYm9keSc7XG4gICAgICAgICAgICBib2R5SW5zdGFuY2UuY2hpbGROb2Rlcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgYm9keUluc3RhbmNlLmF0dHJpYnV0ZXMubGVuZ3RoID0gMDtcblxuICAgICAgICAgICAgdmFyIF9leGlzdGluZzIgPSBib2R5SW5zdGFuY2UuY2hpbGROb2RlcztcbiAgICAgICAgICAgIF9leGlzdGluZzIucHVzaC5hcHBseShfZXhpc3RpbmcyLCBib2R5LmFmdGVyKTtcblxuICAgICAgICAgICAgSFRNTC5jaGlsZE5vZGVzLnB1c2goYm9keUluc3RhbmNlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIF9leGlzdGluZzMgPSBIVE1MLmNoaWxkTm9kZXNbMV0uY2hpbGROb2RlcztcbiAgICAgICAgICAgIF9leGlzdGluZzMucHVzaC5hcHBseShfZXhpc3RpbmczLCBib2R5LmFmdGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByb290O1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gaHRtbFBhcnNlcjtcbn1cblxufSx7XCIuL3Bvb2xzXCI6MTd9XSwxNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmNvdW50ID0gZXhwb3J0cy5wb29scyA9IHVuZGVmaW5lZDtcbmV4cG9ydHMuY3JlYXRlUG9vbCA9IGNyZWF0ZVBvb2w7XG5leHBvcnRzLmluaXRpYWxpemVQb29scyA9IGluaXRpYWxpemVQb29scztcblxudmFyIF91dWlkMiA9IF9kZXJlcV8oJy4vdXVpZCcpO1xuXG52YXIgX3V1aWQzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXVpZDIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgdXVpZCA9IF91dWlkMy5kZWZhdWx0O1xuXG52YXIgcG9vbHMgPSBleHBvcnRzLnBvb2xzID0ge307XG52YXIgY291bnQgPSBleHBvcnRzLmNvdW50ID0gMTAwMDA7XG5cbi8qKlxuICogQ3JlYXRlcyBhIHBvb2wgdG8gcXVlcnkgbmV3IG9yIHJldXNlZCB2YWx1ZXMgZnJvbS5cbiAqXG4gKiBAcGFyYW0gbmFtZVxuICogQHBhcmFtIG9wdHNcbiAqIEByZXR1cm4ge09iamVjdH0gcG9vbFxuICovXG5mdW5jdGlvbiBjcmVhdGVQb29sKG5hbWUsIG9wdHMpIHtcbiAgdmFyIHNpemUgPSBvcHRzLnNpemU7XG4gIHZhciBmaWxsID0gb3B0cy5maWxsO1xuXG4gIHZhciBjYWNoZSA9IHtcbiAgICBmcmVlOiBbXSxcbiAgICBhbGxvY2F0ZWQ6IG5ldyBTZXQoKSxcbiAgICBwcm90ZWN0ZWQ6IG5ldyBTZXQoKSxcbiAgICB1dWlkOiBuZXcgU2V0KClcbiAgfTtcblxuICAvLyBQcmltZSB0aGUgY2FjaGUgd2l0aCBuIG9iamVjdHMuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgY2FjaGUuZnJlZS5wdXNoKGZpbGwoKSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNhY2hlOiBjYWNoZSxcblxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgdmFyIHZhbHVlID0gY2FjaGUuZnJlZS5wb3AoKSB8fCBmaWxsKCk7XG4gICAgICBjYWNoZS5hbGxvY2F0ZWQuYWRkKHZhbHVlKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHByb3RlY3Q6IGZ1bmN0aW9uIHByb3RlY3QodmFsdWUpIHtcbiAgICAgIGNhY2hlLmFsbG9jYXRlZC5kZWxldGUodmFsdWUpO1xuICAgICAgY2FjaGUucHJvdGVjdGVkLmFkZCh2YWx1ZSk7XG5cbiAgICAgIGlmIChuYW1lID09PSAnZWxlbWVudE9iamVjdCcpIHtcbiAgICAgICAgY2FjaGUudXVpZC5hZGQodmFsdWUudXVpZCk7XG4gICAgICB9XG4gICAgfSxcbiAgICB1bnByb3RlY3Q6IGZ1bmN0aW9uIHVucHJvdGVjdCh2YWx1ZSkge1xuICAgICAgaWYgKGNhY2hlLnByb3RlY3RlZC5oYXModmFsdWUpKSB7XG4gICAgICAgIGNhY2hlLnByb3RlY3RlZC5kZWxldGUodmFsdWUpO1xuICAgICAgICBjYWNoZS5mcmVlLnB1c2godmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gaW5pdGlhbGl6ZVBvb2xzKENPVU5UKSB7XG4gIHBvb2xzLmF0dHJpYnV0ZU9iamVjdCA9IGNyZWF0ZVBvb2woJ2F0dHJpYnV0ZU9iamVjdCcsIHtcbiAgICBzaXplOiBDT1VOVCxcblxuICAgIGZpbGw6IGZ1bmN0aW9uIGZpbGwoKSB7XG4gICAgICByZXR1cm4geyBuYW1lOiAnJywgdmFsdWU6ICcnIH07XG4gICAgfVxuICB9KTtcblxuICBwb29scy5lbGVtZW50T2JqZWN0ID0gY3JlYXRlUG9vbCgnZWxlbWVudE9iamVjdCcsIHtcbiAgICBzaXplOiBDT1VOVCxcblxuICAgIGZpbGw6IGZ1bmN0aW9uIGZpbGwoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBub2RlTmFtZTogJycsXG4gICAgICAgIG5vZGVWYWx1ZTogJycsXG4gICAgICAgIHV1aWQ6IHV1aWQoKSxcbiAgICAgICAgY2hpbGROb2RlczogW10sXG4gICAgICAgIGF0dHJpYnV0ZXM6IFtdXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG59XG5cbi8vIENyZWF0ZSAke0NPVU5UfSBpdGVtcyBvZiBlYWNoIHR5cGUuXG5pbml0aWFsaXplUG9vbHMoY291bnQpO1xuXG59LHtcIi4vdXVpZFwiOjE5fV0sMTg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5jb21wbGV0ZVJlbmRlciA9IGNvbXBsZXRlUmVuZGVyO1xuXG52YXIgX2N1c3RvbUV2ZW50ID0gX2RlcmVxXygnY3VzdG9tLWV2ZW50Jyk7XG5cbnZhciBfY3VzdG9tRXZlbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3VzdG9tRXZlbnQpO1xuXG52YXIgX3BhdGNoID0gX2RlcmVxXygnLi4vbm9kZS9wYXRjaCcpO1xuXG52YXIgX3BhdGNoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BhdGNoKTtcblxudmFyIF9tYWtlID0gX2RlcmVxXygnLi4vbm9kZS9tYWtlJyk7XG5cbnZhciBfbWFrZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tYWtlKTtcblxudmFyIF90cmVlID0gX2RlcmVxXygnLi4vbm9kZS90cmVlJyk7XG5cbnZhciBfbWVtb3J5ID0gX2RlcmVxXygnLi4vdXRpbC9tZW1vcnknKTtcblxudmFyIF9wb29scyA9IF9kZXJlcV8oJy4uL3V0aWwvcG9vbHMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gcmVuZGVyTmV4dChlbGVtZW50TWV0YSkge1xuICB2YXIgbmV4dFJlbmRlciA9IGVsZW1lbnRNZXRhLnJlbmRlckJ1ZmZlcjtcbiAgZWxlbWVudE1ldGEucmVuZGVyQnVmZmVyID0gdW5kZWZpbmVkO1xuXG4gIC8vIE5vdGljaW5nIHNvbWUgd2VpcmQgcGVyZm9ybWFuY2UgaW1wbGljYXRpb25zIHdpdGggdGhpcyBjb25jZXB0LlxuICAoMCwgX3BhdGNoMi5kZWZhdWx0KShuZXh0UmVuZGVyLmVsZW1lbnQsIG5leHRSZW5kZXIubmV3SFRNTCwgbmV4dFJlbmRlci5vcHRpb25zKTtcbn1cblxuLyoqXG4gKiBXaGVuIHRoZSBVSSBvciBXb3JrZXIgdGhyZWFkIGNvbXBsZXRlcywgY2xlYW4gdXAgbWVtb3J5IGFuZCBzY2hlZHVsZSB0aGVcbiAqIG5leHQgcmVuZGVyIGlmIG5lY2Vzc2FyeS5cbiAqXG4gKiBAcGFyYW0gZWxlbWVudFxuICogQHBhcmFtIGVsZW1lbnRNZXRhXG4gKi9cbmZ1bmN0aW9uIGNvbXBsZXRlUmVuZGVyKGVsZW1lbnQsIGVsZW1lbnRNZXRhKSB7XG4gIHJldHVybiBmdW5jdGlvbiBpbnZva2VSZW5kZXIoKSB7XG4gICAgZWxlbWVudE1ldGEucHJldmlvdXNNYXJrdXAgPSBlbGVtZW50TWV0YS5vcHRpb25zLmlubmVyID8gZWxlbWVudC5pbm5lckhUTUwgOiBlbGVtZW50Lm91dGVySFRNTDtcbiAgICBlbGVtZW50TWV0YS5fdGV4dENvbnRlbnQgPSBlbGVtZW50LnRleHRDb250ZW50O1xuXG4gICAgKDAsIF9tZW1vcnkuY2xlYW5NZW1vcnkpKF9tYWtlMi5kZWZhdWx0KTtcblxuICAgIGVsZW1lbnRNZXRhLmlzUmVuZGVyaW5nID0gZmFsc2U7XG5cbiAgICAvLyBCb29sZWFuIHRvIHN0b3Agb3BlcmF0aW9ucyBpbiB0aGUgVHJlZUNhY2hlIGxvb3AgYmVsb3cuXG4gICAgdmFyIHN0b3BMb29waW5nID0gZmFsc2U7XG5cbiAgICAvLyBUaGlzIGlzIGRlc2lnbmVkIHRvIGhhbmRsZSB1c2UgY2FzZXMgd2hlcmUgcmVuZGVycyBhcmUgYmVpbmcgaGFtbWVyZWRcbiAgICAvLyBvciB3aGVuIHRyYW5zaXRpb25zIGFyZSB1c2VkIHdpdGggUHJvbWlzZXMuXG4gICAgaWYgKGVsZW1lbnRNZXRhLnJlbmRlckJ1ZmZlcikge1xuICAgICAgcmVuZGVyTmV4dChlbGVtZW50TWV0YSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIF90cmVlLlRyZWVDYWNoZS5mb3JFYWNoKGZ1bmN0aW9uIGl0ZXJhdGVUcmVlQ2FjaGUoZWxlbWVudE1ldGEpIHtcbiAgICAgICAgaWYgKCFzdG9wTG9vcGluZyAmJiBlbGVtZW50TWV0YS5yZW5kZXJCdWZmZXIpIHtcbiAgICAgICAgICByZW5kZXJOZXh0KGVsZW1lbnRNZXRhKTtcbiAgICAgICAgICBzdG9wTG9vcGluZyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIERpc3BhdGNoIGFuIGV2ZW50IG9uIHRoZSBlbGVtZW50IG9uY2UgcmVuZGVyaW5nIGhhcyBjb21wbGV0ZWQuXG4gICAgZWxlbWVudC5kaXNwYXRjaEV2ZW50KG5ldyBfY3VzdG9tRXZlbnQyLmRlZmF1bHQoJ3JlbmRlckNvbXBsZXRlJykpO1xuICB9O1xufVxuXG59LHtcIi4uL25vZGUvbWFrZVwiOjYsXCIuLi9ub2RlL3BhdGNoXCI6NyxcIi4uL25vZGUvdHJlZVwiOjEwLFwiLi4vdXRpbC9tZW1vcnlcIjoxNSxcIi4uL3V0aWwvcG9vbHNcIjoxNyxcImN1c3RvbS1ldmVudFwiOjIyfV0sMTk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdXVpZDtcbi8qKlxuICogR2VuZXJhdGVzIGEgdXVpZC5cbiAqXG4gKiBAc2VlIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIxMTc1MjMvMjgyMTc1XG4gKiBAcmV0dXJuIHtzdHJpbmd9IHV1aWRcbiAqL1xuZnVuY3Rpb24gdXVpZCgpIHtcbiAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcbiAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAxNiB8IDA7XG4gICAgdmFyIHYgPSBjID09ICd4JyA/IHIgOiByICYgMHgzIHwgMHg4O1xuICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcbiAgfSk7XG59XG5cbn0se31dLDIwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuaGFzV29ya2VyID0gdW5kZWZpbmVkO1xuZXhwb3J0cy5jcmVhdGUgPSBjcmVhdGU7XG5cbnZhciBfdXVpZCA9IF9kZXJlcV8oJy4uL3V0aWwvdXVpZCcpO1xuXG52YXIgX3V1aWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXVpZCk7XG5cbnZhciBfcG9vbHMgPSBfZGVyZXFfKCcuLi91dGlsL3Bvb2xzJyk7XG5cbnZhciBfcGFyc2VyID0gX2RlcmVxXygnLi4vdXRpbC9wYXJzZXInKTtcblxudmFyIF9tZW1vcnkgPSBfZGVyZXFfKCcuLi91dGlsL21lbW9yeScpO1xuXG52YXIgX3N5bmMgPSBfZGVyZXFfKCcuLi9ub2RlL3N5bmMnKTtcblxudmFyIF9zeW5jMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N5bmMpO1xuXG52YXIgX21ha2UgPSBfZGVyZXFfKCcuLi9ub2RlL21ha2UnKTtcblxudmFyIF9tYWtlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21ha2UpO1xuXG52YXIgX3NvdXJjZSA9IF9kZXJlcV8oJy4vc291cmNlJyk7XG5cbnZhciBfc291cmNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NvdXJjZSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8vIFRlc3RzIGlmIHRoZSBicm93c2VyIGhhcyBzdXBwb3J0IGZvciB0aGUgYFdvcmtlcmAgQVBJLlxudmFyIGhhc1dvcmtlciA9IGV4cG9ydHMuaGFzV29ya2VyID0gdHlwZW9mIFdvcmtlciA9PT0gJ2Z1bmN0aW9uJztcblxuLy8gRmluZCBhbGwgdGhlIGNvdmVyYWdlIHN0YXRlbWVudHMgYW5kIGV4cHJlc3Npb25zLlxudmFyIENPVl9FWFAgPSAvX19jb3ZfKFteXFwrXFwrXSopXFwrXFwrL2dpO1xuXG4vKipcbiAqIEF3ZnVsIGhhY2sgdG8gcmVtb3ZlIGBfX2NvdmAgbGluZXMgZnJvbSB0aGUgc291cmNlIGJlZm9yZSBzZW5kaW5nIG92ZXIgdG9cbiAqIHRoZSB3b3JrZXIuIE9ubHkgdXNlZnVsIHdoaWxlIHRlc3RpbmcuXG4gKi9cbmZ1bmN0aW9uIGZpbHRlck91dENvdmVyYWdlKHN0cmluZykge1xuICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoQ09WX0VYUCwgJ251bGwnKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFdlYiBXb3JrZXIgcGVyIGVsZW1lbnQgdGhhdCB3aWxsIGJlIGRpZmZlZC4gQWxsb3dzIG11bHRpcGxlXG4gKiBjb25jdXJyZW50IGRpZmZpbmcgb3BlcmF0aW9ucyB0byBvY2N1ciBzaW11bHRhbmVvdXNseSwgbGV2ZXJhZ2luZyB0aGVcbiAqIG11bHRpLWNvcmUgbmF0dXJlIG9mIGRlc2t0b3AgYW5kIG1vYmlsZSBkZXZpY2VzLlxuICpcbiAqIEF0dGFjaCBhbnkgZnVuY3Rpb25zIHRoYXQgY291bGQgYmUgdXNlZCBieSB0aGUgV29ya2VyIGluc2lkZSB0aGUgQmxvYiBiZWxvdy5cbiAqIEFsbCBmdW5jdGlvbnMgYXJlIG5hbWVkIHNvIHRoZXkgY2FuIGJlIGFjY2Vzc2VkIGdsb2JhbGx5LiBTaW5jZSB3ZSdyZVxuICogZGlyZWN0bHkgaW5qZWN0aW5nIHRoZSBtZXRob2RzIGludG8gdGhlIEVTNiB0ZW1wbGF0ZSBzdHJpbmcsXG4gKiBgRnVuY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nYCB3aWxsIGJlIGludm9rZWQgcmV0dXJuaW5nIGEgcmVwcmVzZW50YXRpb24gb2ZcbiAqIHRoZSBmdW5jdGlvbidzIHNvdXJjZS4gVGhpcyBjb21lcyBhdCBhIGNvc3Qgc2luY2UgQmFiZWwgcmV3cml0ZXMgdmFyaWFibGVcbiAqIG5hbWVzIHdoZW4geW91IGBpbXBvcnRgIGEgbW9kdWxlLiBUaGlzIGlzIHdoeSB5b3UnbGwgc2VlIHVuZGVyc2NvcmVkXG4gKiBwcm9wZXJ0aWVzIGJlaW5nIGltcG9ydGVkIGFuZCB0aGVuIHJlYXNzaWduZWQgdG8gbm9uLXVuZGVyc2NvcmVkIG5hbWVzIGluXG4gKiBtb2R1bGVzIHRoYXQgYXJlIHJldXNlZCBoZXJlLiBJc3BhcnRhIGluamVjdHMgY292ZXJhZ2UgZnVuY3Rpb24gY2FsbHMgdGhhdFxuICogd2lsbCBlcnJvciBvdXQgaW4gdGhlIFdvcmtlciwgd2hpY2ggaXMgd2h5IHdlIHN0cmlwIHRoZW0gb3V0LlxuICpcbiAqIEByZXR1cm4ge09iamVjdH0gQSBXb3JrZXIgaW5zdGFuY2UuXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZSgpIHtcbiAgdmFyIHdvcmtlciA9IG51bGw7XG4gIHZhciB3b3JrZXJCbG9iID0gbnVsbDtcbiAgdmFyIHdvcmtlclNvdXJjZSA9IGZpbHRlck91dENvdmVyYWdlKCdcXG4gICAgLy8gUmV1c2FibGUgQXJyYXkgbWV0aG9kcy5cXG4gICAgdmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xcbiAgICB2YXIgZmlsdGVyID0gQXJyYXkucHJvdG90eXBlLmZpbHRlcjtcXG5cXG4gICAgLy8gQWRkIGEgbmFtZXNwYWNlIHRvIGF0dGFjaCBwb29sIG1ldGhvZHMgdG8uXFxuICAgIHZhciBwb29scyA9IHt9O1xcbiAgICB2YXIgbm9kZXMgPSAwO1xcbiAgICB2YXIgUkVNT1ZFX0VMRU1FTlRfQ0hJTERSRU4gPSAtMjtcXG4gICAgdmFyIFJFTU9WRV9FTlRJUkVfRUxFTUVOVCA9IC0xO1xcbiAgICB2YXIgTU9ESUZZX0VMRU1FTlQgPSAxO1xcbiAgICB2YXIgTU9ESUZZX0FUVFJJQlVURSA9IDI7XFxuICAgIHZhciBDSEFOR0VfVEVYVCA9IDM7XFxuXFxuICAgIC8vIEluamVjdCB0aGUgdXVpZCBjb2RlLlxcbiAgICAnICsgX3V1aWQyLmRlZmF1bHQgKyAnO1xcblxcbiAgICAvLyBBZGQgaW4gcG9vbCBtYW5pcHVsYXRpb24gbWV0aG9kcy5cXG4gICAgJyArIF9wb29scy5jcmVhdGVQb29sICsgJztcXG4gICAgJyArIF9wb29scy5pbml0aWFsaXplUG9vbHMgKyAnO1xcblxcbiAgICBpbml0aWFsaXplUG9vbHMoJyArIF9wb29scy5jb3VudCArICcpO1xcblxcbiAgICAvLyBBZGQgdGhlIGFiaWxpdHkgdG8gcHJvdGVjdCBlbGVtZW50cyBmcm9tIGZyZWVcXCdkIG1lbW9yeS5cXG4gICAgJyArIF9tZW1vcnkucHJvdGVjdEVsZW1lbnQgKyAnO1xcbiAgICAnICsgX21lbW9yeS51bnByb3RlY3RFbGVtZW50ICsgJztcXG4gICAgJyArIF9tZW1vcnkuY2xlYW5NZW1vcnkgKyAnO1xcblxcbiAgICAvLyBBZGQgaW4gTm9kZSBtYW5pcHVsYXRpb24uXFxuICAgIHZhciBzeW5jTm9kZSA9ICcgKyBfc3luYzIuZGVmYXVsdCArICc7XFxuICAgIHZhciBtYWtlTm9kZSA9ICcgKyBfbWFrZTIuZGVmYXVsdCArICc7XFxuXFxuICAgIC8vIEFkZCBpbiB0aGUgYWJpbGl0eSB0byBwYXJzZUhUTUwuXFxuICAgICcgKyBfcGFyc2VyLnBhcnNlSFRNTCArICc7XFxuXFxuICAgIHZhciBtYWtlUGFyc2VyID0gJyArIF9wYXJzZXIubWFrZVBhcnNlciArICc7XFxuICAgIHZhciBwYXJzZXIgPSBtYWtlUGFyc2VyKCk7XFxuXFxuICAgIC8vIEFkZCBpbiB0aGUgd29ya2VyIHNvdXJjZS5cXG4gICAgJyArIF9zb3VyY2UyLmRlZmF1bHQgKyAnO1xcblxcbiAgICAvLyBNZXRhcHJvZ3JhbW1pbmcgdXAgdGhpcyB3b3JrZXIgY2FsbC5cXG4gICAgc3RhcnR1cChzZWxmKTtcXG4gICcpO1xuXG4gIC8vIFNldCB1cCBhIFdlYldvcmtlciBpZiBhdmFpbGFibGUuXG4gIGlmIChoYXNXb3JrZXIpIHtcbiAgICAvLyBDb25zdHJ1Y3QgdGhlIHdvcmtlciByZXVzaW5nIGNvZGUgYWxyZWFkeSBvcmdhbml6ZWQgaW50byBtb2R1bGVzLiAgS2VlcFxuICAgIC8vIHRoaXMgY29kZSBFUzUgc2luY2Ugd2UgZG8gbm90IGdldCB0aW1lIHRvIHByZS1wcm9jZXNzIGl0IGFzIEVTNi5cbiAgICB3b3JrZXJCbG9iID0gbmV3IEJsb2IoW3dvcmtlclNvdXJjZV0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnIH0pO1xuXG4gICAgLy8gQ29uc3RydWN0IHRoZSB3b3JrZXIgYW5kIHN0YXJ0IGl0IHVwLlxuICAgIHRyeSB7XG4gICAgICB3b3JrZXIgPSBuZXcgV29ya2VyKFVSTC5jcmVhdGVPYmplY3RVUkwod29ya2VyQmxvYikpO1xuICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICBpZiAoY29uc29sZSAmJiBjb25zb2xlLmluZm8pIHtcbiAgICAgICAgY29uc29sZS5pbmZvKCdGYWlsZWQgdG8gY3JlYXRlIGRpZmZodG1sIHdvcmtlcicsIGV4KTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgd2UgY2Fubm90IGNyZWF0ZSBhIFdvcmtlciwgdGhlbiBkaXNhYmxlIHRyeWluZyBhZ2FpbiwgYWxsIHdvcmtcbiAgICAgIC8vIHdpbGwgaGFwcGVuIG9uIHRoZSBtYWluIFVJIHRocmVhZC5cbiAgICAgIGV4cG9ydHMuaGFzV29ya2VyID0gaGFzV29ya2VyID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHdvcmtlcjtcbn1cblxufSx7XCIuLi9ub2RlL21ha2VcIjo2LFwiLi4vbm9kZS9zeW5jXCI6OSxcIi4uL3V0aWwvbWVtb3J5XCI6MTUsXCIuLi91dGlsL3BhcnNlclwiOjE2LFwiLi4vdXRpbC9wb29sc1wiOjE3LFwiLi4vdXRpbC91dWlkXCI6MTksXCIuL3NvdXJjZVwiOjIxfV0sMjE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG4vLyBUaGVzZSBhcmUgZ2xvYmFsbHkgZGVmaW5lZCB0byBhdm9pZCBpc3N1ZXMgd2l0aCBKU0hpbnQgdGhpbmtpbmcgdGhhdCB3ZSdyZVxuLy8gcmVmZXJlbmNpbmcgdW5rbm93biBpZGVudGlmaWVycy5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHN0YXJ0dXA7XG52YXIgcGFyc2VIVE1MO1xudmFyIHN5bmNOb2RlO1xudmFyIHBvb2xzO1xudmFyIHVucHJvdGVjdEVsZW1lbnQ7XG52YXIgcHJvdGVjdEVsZW1lbnQ7XG52YXIgY2xlYW5NZW1vcnk7XG5cbi8qKlxuICogVGhpcyBpcyB0aGUgV2ViIFdvcmtlciBzb3VyY2UgY29kZS4gQWxsIGdsb2JhbHMgaGVyZSBhcmUgZGVmaW5lZCBpbiB0aGVcbiAqIHdvcmtlci9jcmVhdGUgbW9kdWxlLiBUaGlzIGFsbG93cyBjb2RlIHNoYXJpbmcgYW5kIGxlc3MgZHVwbGljYXRpb24gc2luY2VcbiAqIG1vc3Qgb2YgdGhlIGxvZ2ljIGlzIGlkZW50aWNhbCB0byB0aGUgVUkgdGhyZWFkLlxuICpcbiAqIEBwYXJhbSB3b3JrZXIgLSBBIHdvcmtlciBpbnN0YW5jZVxuICovXG5mdW5jdGlvbiBzdGFydHVwKHdvcmtlcikge1xuICB2YXIgcGF0Y2hlcyA9IFtdO1xuICB2YXIgb2xkVHJlZSA9IG51bGw7XG5cbiAgLyoqXG4gICAqIFRyaWdnZXJlZCB3aGVuZXZlciBhIGBwb3N0TWVzc2FnZWAgY2FsbCBpcyBtYWRlIG9uIHRoZSBXb3JrZXIgaW5zdGFuY2VcbiAgICogZnJvbSB0aGUgVUkgdGhyZWFkLiBTaWduYWxzIHRoYXQgc29tZSB3b3JrIG5lZWRzIHRvIG9jY3VyLiBXaWxsIHBvc3QgYmFja1xuICAgKiB0byB0aGUgbWFpbiB0aHJlYWQgd2l0aCBwYXRjaCBhbmQgbm9kZSB0cmFuc2Zvcm0gcmVzdWx0cy5cbiAgICpcbiAgICogQHBhcmFtIGUgLSBUaGUgbm9ybWFsaXplZCBldmVudCBvYmplY3QuXG4gICAqL1xuICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gb25tZXNzYWdlKGUpIHtcbiAgICB2YXIgZGF0YSA9IGUuZGF0YTtcbiAgICB2YXIgaXNJbm5lciA9IGRhdGEuaXNJbm5lcjtcbiAgICB2YXIgbmV3VHJlZSA9IG51bGw7XG5cbiAgICAvLyBJZiBhbiBgb2xkVHJlZWAgd2FzIHByb3ZpZGVkIGJ5IHRoZSBVSSB0aHJlYWQsIHVzZSB0aGF0IGluIHBsYWNlIG9mIHRoZVxuICAgIC8vIGN1cnJlbnQgYG9sZFRyZWVgLlxuICAgIGlmIChkYXRhLm9sZFRyZWUpIHtcbiAgICAgIGlmIChvbGRUcmVlKSB7XG4gICAgICAgIHVucHJvdGVjdEVsZW1lbnQob2xkVHJlZSk7XG4gICAgICAgIGNsZWFuTWVtb3J5KCk7XG4gICAgICB9XG5cbiAgICAgIG9sZFRyZWUgPSBkYXRhLm9sZFRyZWU7XG4gICAgfVxuXG4gICAgLy8gSWYgdGhlIGBuZXdUcmVlYCB3YXMgcHJvdmlkZWQgdG8gdGhlIHdvcmtlciwgdXNlIHRoYXQgaW5zdGVhZCBvZiB0cnlpbmdcbiAgICAvLyB0byBjcmVhdGUgb25lIGZyb20gSFRNTCBzb3VyY2UuXG4gICAgaWYgKGRhdGEubmV3VHJlZSkge1xuICAgICAgbmV3VHJlZSA9IGRhdGEubmV3VHJlZTtcbiAgICB9XG5cbiAgICAvLyBJZiBubyBgbmV3VHJlZWAgd2FzIHByb3ZpZGVkLCB3ZSdsbCBoYXZlIHRvIHRyeSBhbmQgY3JlYXRlIG9uZSBmcm9tIHRoZVxuICAgIC8vIEhUTUwgc291cmNlIHByb3ZpZGVkLlxuICAgIGVsc2UgaWYgKHR5cGVvZiBkYXRhLm5ld0hUTUwgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIC8vIENhbGN1bGF0ZSBhIG5ldyB0cmVlLlxuICAgICAgICBuZXdUcmVlID0gcGFyc2VIVE1MKGRhdGEubmV3SFRNTCwgaXNJbm5lcik7XG5cbiAgICAgICAgLy8gSWYgdGhlIG9wZXJhdGlvbiBpcyBmb3IgYGlubmVySFRNTGAgdGhlbiB3ZSdsbCByZXRhaW4gdGhlIHByZXZpb3VzXG4gICAgICAgIC8vIHRyZWUncyBhdHRyaWJ1dGVzLCBub2RlTmFtZSwgYW5kIG5vZGVWYWx1ZSwgYW5kIG9ubHkgYWRqdXN0IHRoZVxuICAgICAgICAvLyBjaGlsZE5vZGVzLlxuICAgICAgICBpZiAoaXNJbm5lcikge1xuICAgICAgICAgIHZhciBjaGlsZE5vZGVzID0gbmV3VHJlZTtcblxuICAgICAgICAgIG5ld1RyZWUgPSB7XG4gICAgICAgICAgICBjaGlsZE5vZGVzOiBjaGlsZE5vZGVzLFxuICAgICAgICAgICAgYXR0cmlidXRlczogb2xkVHJlZS5hdHRyaWJ1dGVzLFxuICAgICAgICAgICAgdXVpZDogb2xkVHJlZS51dWlkLFxuICAgICAgICAgICAgbm9kZU5hbWU6IG9sZFRyZWUubm9kZU5hbWUsXG4gICAgICAgICAgICBub2RlVmFsdWU6IG9sZFRyZWUubm9kZVZhbHVlXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgLy8gU3luY2hyb25pemUgdGhlIG9sZCB2aXJ0dWFsIHRyZWUgd2l0aCB0aGUgbmV3IHZpcnR1YWwgdHJlZS4gIFRoaXMgd2lsbFxuICAgIC8vIHByb2R1Y2UgYSBzZXJpZXMgb2YgcGF0Y2hlcyB0aGF0IHdpbGwgYmUgZXhlY3V0ZWQgdG8gdXBkYXRlIHRoZSBET00uXG4gICAgc3luY05vZGUob2xkVHJlZSwgbmV3VHJlZSwgcGF0Y2hlcyk7XG5cbiAgICAvLyBQcm90ZWN0IHRoZSBjdXJyZW50IGBvbGRUcmVlYCBzbyB0aGF0IE5vZGVzIHdpbGwgbm90IGJlIGFjY2lkZW50YWxseVxuICAgIC8vIHJlY3ljbGVkIGluIHRoZSBjbGVhbnVwIHByb2Nlc3MuXG4gICAgcHJvdGVjdEVsZW1lbnQob2xkVHJlZSk7XG5cbiAgICAvLyBTZW5kIHRoZSBwYXRjaGVzIGJhY2sgdG8gdGhlIHVzZXJsYW5kLlxuICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7XG4gICAgICAvLyBBbGwgdGhlIHBhdGNoZXMgdG8gYXBwbHkgdG8gdGhlIERPTS5cbiAgICAgIHBhdGNoZXM6IHBhdGNoZXNcbiAgICB9KTtcblxuICAgIC8vIFJlY3ljbGUgYWxsb2NhdGVkIG9iamVjdHMgYmFjayBpbnRvIHRoZSBwb29sLlxuICAgIGNsZWFuTWVtb3J5KCk7XG5cbiAgICAvLyBXaXBlIG91dCB0aGUgcGF0Y2hlcyBpbiBtZW1vcnkuXG4gICAgcGF0Y2hlcy5sZW5ndGggPSAwO1xuICB9O1xufVxuXG59LHt9XSwyMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4oZnVuY3Rpb24gKGdsb2JhbCl7XG5cbnZhciBOYXRpdmVDdXN0b21FdmVudCA9IGdsb2JhbC5DdXN0b21FdmVudDtcblxuZnVuY3Rpb24gdXNlTmF0aXZlICgpIHtcbiAgdHJ5IHtcbiAgICB2YXIgcCA9IG5ldyBOYXRpdmVDdXN0b21FdmVudCgnY2F0JywgeyBkZXRhaWw6IHsgZm9vOiAnYmFyJyB9IH0pO1xuICAgIHJldHVybiAgJ2NhdCcgPT09IHAudHlwZSAmJiAnYmFyJyA9PT0gcC5kZXRhaWwuZm9vO1xuICB9IGNhdGNoIChlKSB7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIENyb3NzLWJyb3dzZXIgYEN1c3RvbUV2ZW50YCBjb25zdHJ1Y3Rvci5cbiAqXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ3VzdG9tRXZlbnQuQ3VzdG9tRXZlbnRcbiAqXG4gKiBAcHVibGljXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSB1c2VOYXRpdmUoKSA/IE5hdGl2ZUN1c3RvbUV2ZW50IDpcblxuLy8gSUUgPj0gOVxuJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUV2ZW50ID8gZnVuY3Rpb24gQ3VzdG9tRXZlbnQgKHR5cGUsIHBhcmFtcykge1xuICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICBpZiAocGFyYW1zKSB7XG4gICAgZS5pbml0Q3VzdG9tRXZlbnQodHlwZSwgcGFyYW1zLmJ1YmJsZXMsIHBhcmFtcy5jYW5jZWxhYmxlLCBwYXJhbXMuZGV0YWlsKTtcbiAgfSBlbHNlIHtcbiAgICBlLmluaXRDdXN0b21FdmVudCh0eXBlLCBmYWxzZSwgZmFsc2UsIHZvaWQgMCk7XG4gIH1cbiAgcmV0dXJuIGU7XG59IDpcblxuLy8gSUUgPD0gOFxuZnVuY3Rpb24gQ3VzdG9tRXZlbnQgKHR5cGUsIHBhcmFtcykge1xuICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XG4gIGUudHlwZSA9IHR5cGU7XG4gIGlmIChwYXJhbXMpIHtcbiAgICBlLmJ1YmJsZXMgPSBCb29sZWFuKHBhcmFtcy5idWJibGVzKTtcbiAgICBlLmNhbmNlbGFibGUgPSBCb29sZWFuKHBhcmFtcy5jYW5jZWxhYmxlKTtcbiAgICBlLmRldGFpbCA9IHBhcmFtcy5kZXRhaWw7XG4gIH0gZWxzZSB7XG4gICAgZS5idWJibGVzID0gZmFsc2U7XG4gICAgZS5jYW5jZWxhYmxlID0gZmFsc2U7XG4gICAgZS5kZXRhaWwgPSB2b2lkIDA7XG4gIH1cbiAgcmV0dXJuIGU7XG59XG5cbn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KVxufSx7fV19LHt9LFs1XSkoNSlcbn0pOyJdfQ==","/*\nCopyright (c) 2010,2011,2012,2013,2014 Morgan Roderick http://roderick.dk\nLicense: MIT - http://mrgnrdrck.mit-license.org\n\nhttps://github.com/mroderick/PubSubJS\n*/\n(function (root, factory){\n\t'use strict';\n\n    if (typeof define === 'function' && define.amd){\n        // AMD. Register as an anonymous module.\n        define(['exports'], factory);\n\n    } else if (typeof exports === 'object'){\n        // CommonJS\n        factory(exports);\n\n    }\n\n    // Browser globals\n    var PubSub = {};\n    root.PubSub = PubSub;\n    factory(PubSub);\n    \n}(( typeof window === 'object' && window ) || this, function (PubSub){\n\t'use strict';\n\n\tvar messages = {},\n\t\tlastUid = -1;\n\n\tfunction hasKeys(obj){\n\t\tvar key;\n\n\t\tfor (key in obj){\n\t\t\tif ( obj.hasOwnProperty(key) ){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t *\tReturns a function that throws the passed exception, for use as argument for setTimeout\n\t *\t@param { Object } ex An Error object\n\t */\n\tfunction throwException( ex ){\n\t\treturn function reThrowException(){\n\t\t\tthrow ex;\n\t\t};\n\t}\n\n\tfunction callSubscriberWithDelayedExceptions( subscriber, message, data ){\n\t\ttry {\n\t\t\tsubscriber( message, data );\n\t\t} catch( ex ){\n\t\t\tsetTimeout( throwException( ex ), 0);\n\t\t}\n\t}\n\n\tfunction callSubscriberWithImmediateExceptions( subscriber, message, data ){\n\t\tsubscriber( message, data );\n\t}\n\n\tfunction deliverMessage( originalMessage, matchedMessage, data, immediateExceptions ){\n\t\tvar subscribers = messages[matchedMessage],\n\t\t\tcallSubscriber = immediateExceptions ? callSubscriberWithImmediateExceptions : callSubscriberWithDelayedExceptions,\n\t\t\ts;\n\n\t\tif ( !messages.hasOwnProperty( matchedMessage ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (s in subscribers){\n\t\t\tif ( subscribers.hasOwnProperty(s)){\n\t\t\t\tcallSubscriber( subscribers[s], originalMessage, data );\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction createDeliveryFunction( message, data, immediateExceptions ){\n\t\treturn function deliverNamespaced(){\n\t\t\tvar topic = String( message ),\n\t\t\t\tposition = topic.lastIndexOf( '.' );\n\n\t\t\t// deliver the message as it is now\n\t\t\tdeliverMessage(message, message, data, immediateExceptions);\n\n\t\t\t// trim the hierarchy and deliver message to each level\n\t\t\twhile( position !== -1 ){\n\t\t\t\ttopic = topic.substr( 0, position );\n\t\t\t\tposition = topic.lastIndexOf('.');\n\t\t\t\tdeliverMessage( message, topic, data, immediateExceptions );\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction messageHasSubscribers( message ){\n\t\tvar topic = String( message ),\n\t\t\tfound = Boolean(messages.hasOwnProperty( topic ) && hasKeys(messages[topic])),\n\t\t\tposition = topic.lastIndexOf( '.' );\n\n\t\twhile ( !found && position !== -1 ){\n\t\t\ttopic = topic.substr( 0, position );\n\t\t\tposition = topic.lastIndexOf( '.' );\n\t\t\tfound = Boolean(messages.hasOwnProperty( topic ) && hasKeys(messages[topic]));\n\t\t}\n\n\t\treturn found;\n\t}\n\n\tfunction publish( message, data, sync, immediateExceptions ){\n\t\tvar deliver = createDeliveryFunction( message, data, immediateExceptions ),\n\t\t\thasSubscribers = messageHasSubscribers( message );\n\n\t\tif ( !hasSubscribers ){\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( sync === true ){\n\t\t\tdeliver();\n\t\t} else {\n\t\t\tsetTimeout( deliver, 0 );\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t *\tPubSub.publish( message[, data] ) -> Boolean\n\t *\t- message (String): The message to publish\n\t *\t- data: The data to pass to subscribers\n\t *\tPublishes the the message, passing the data to it's subscribers\n\t**/\n\tPubSub.publish = function( message, data ){\n\t\treturn publish( message, data, false, PubSub.immediateExceptions );\n\t};\n\n\t/**\n\t *\tPubSub.publishSync( message[, data] ) -> Boolean\n\t *\t- message (String): The message to publish\n\t *\t- data: The data to pass to subscribers\n\t *\tPublishes the the message synchronously, passing the data to it's subscribers\n\t**/\n\tPubSub.publishSync = function( message, data ){\n\t\treturn publish( message, data, true, PubSub.immediateExceptions );\n\t};\n\n\t/**\n\t *\tPubSub.subscribe( message, func ) -> String\n\t *\t- message (String): The message to subscribe to\n\t *\t- func (Function): The function to call when a new message is published\n\t *\tSubscribes the passed function to the passed message. Every returned token is unique and should be stored if\n\t *\tyou need to unsubscribe\n\t**/\n\tPubSub.subscribe = function( message, func ){\n\t\tif ( typeof func !== 'function'){\n\t\t\treturn false;\n\t\t}\n\n\t\t// message is not registered yet\n\t\tif ( !messages.hasOwnProperty( message ) ){\n\t\t\tmessages[message] = {};\n\t\t}\n\n\t\t// forcing token as String, to allow for future expansions without breaking usage\n\t\t// and allow for easy use as key names for the 'messages' object\n\t\tvar token = 'uid_' + String(++lastUid);\n\t\tmessages[message][token] = func;\n\n\t\t// return token for unsubscribing\n\t\treturn token;\n\t};\n\n\t/* Public: Clears all subscriptions\n\t */\n\tPubSub.clearAllSubscriptions = function clearAllSubscriptions(){\n\t\tmessages = {};\n\t};\n\n\t/*Public: Clear subscriptions by the topic\n\t*/\n\tPubSub.clearSubscriptions = function clearSubscriptions(topic){\n\t\tvar m; \n\t\tfor (m in messages){\n\t\t\tif (messages.hasOwnProperty(m) && m.indexOf(topic) === 0){\n\t\t\t\tdelete messages[m];\n\t\t\t}\n\t\t}\n\t};\n\n\t/* Public: removes subscriptions.\n\t * When passed a token, removes a specific subscription.\n\t * When passed a function, removes all subscriptions for that function\n\t * When passed a topic, removes all subscriptions for that topic (hierarchy)\n\t *\n\t * value - A token, function or topic to unsubscribe.\n\t *\n\t * Examples\n\t *\n\t *\t\t// Example 1 - unsubscribing with a token\n\t *\t\tvar token = PubSub.subscribe('mytopic', myFunc);\n\t *\t\tPubSub.unsubscribe(token);\n\t *\n\t *\t\t// Example 2 - unsubscribing with a function\n\t *\t\tPubSub.unsubscribe(myFunc);\n\t *\n\t *\t\t// Example 3 - unsubscribing a topic\n\t *\t\tPubSub.unsubscribe('mytopic');\n\t */\n\tPubSub.unsubscribe = function(value){\n\t\tvar isTopic    = typeof value === 'string' && messages.hasOwnProperty(value),\n\t\t\tisToken    = !isTopic && typeof value === 'string',\n\t\t\tisFunction = typeof value === 'function',\n\t\t\tresult = false,\n\t\t\tm, message, t;\n\n\t\tif (isTopic){\n\t\t\tdelete messages[value];\n\t\t\treturn;\n\t\t}\n\n\t\tfor ( m in messages ){\n\t\t\tif ( messages.hasOwnProperty( m ) ){\n\t\t\t\tmessage = messages[m];\n\n\t\t\t\tif ( isToken && message[value] ){\n\t\t\t\t\tdelete message[value];\n\t\t\t\t\tresult = value;\n\t\t\t\t\t// tokens are unique, so we can just stop here\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (isFunction) {\n\t\t\t\t\tfor ( t in message ){\n\t\t\t\t\t\tif (message.hasOwnProperty(t) && message[t] === value){\n\t\t\t\t\t\t\tdelete message[t];\n\t\t\t\t\t\t\tresult = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n}));\n","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports['default'] = applyMiddleware;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _compose = require('./compose');\n\nvar _compose2 = _interopRequireDefault(_compose);\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\n\nfunction applyMiddleware() {\n  for (var _len = arguments.length, middlewares = Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function (reducer, initialState, enhancer) {\n      var store = createStore(reducer, initialState, enhancer);\n      var _dispatch = store.dispatch;\n      var chain = [];\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch(action) {\n          return _dispatch(action);\n        }\n      };\n      chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = _compose2['default'].apply(undefined, chain)(store.dispatch);\n\n      return _extends({}, store, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}\n\nmodule.exports = exports['default'];","'use strict';\n\nexports.__esModule = true;\nexports['default'] = bindActionCreators;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _utilsMapValues = require('./utils/mapValues');\n\nvar _utilsMapValues2 = _interopRequireDefault(_utilsMapValues);\n\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(undefined, arguments));\n  };\n}\n\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass a single function as the first argument,\n * and get a function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\n\nfunction bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null || actionCreators === undefined) {\n    throw new Error('bindActionCreators expected an object or a function, instead received ' + (actionCreators === null ? 'null' : typeof actionCreators) + '. ' + 'Did you write \"import ActionCreators from\" instead of \"import * as ActionCreators from\"?');\n  }\n\n  return _utilsMapValues2['default'](actionCreators, function (actionCreator) {\n    return bindActionCreator(actionCreator, dispatch);\n  });\n}\n\nmodule.exports = exports['default'];","(function (process){\n'use strict';\n\nexports.__esModule = true;\nexports['default'] = combineReducers;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _createStore = require('./createStore');\n\nvar _utilsIsPlainObject = require('./utils/isPlainObject');\n\nvar _utilsIsPlainObject2 = _interopRequireDefault(_utilsIsPlainObject);\n\nvar _utilsMapValues = require('./utils/mapValues');\n\nvar _utilsMapValues2 = _interopRequireDefault(_utilsMapValues);\n\nvar _utilsPick = require('./utils/pick');\n\nvar _utilsPick2 = _interopRequireDefault(_utilsPick);\n\nvar _utilsWarning = require('./utils/warning');\n\nvar _utilsWarning2 = _interopRequireDefault(_utilsWarning);\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  var actionType = action && action.type;\n  var actionName = actionType && '\"' + actionType.toString() + '\"' || 'an action';\n\n  return 'Reducer \"' + key + '\" returned undefined handling ' + actionName + '. ' + 'To ignore an action, you must explicitly return the previous state.';\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === _createStore.ActionTypes.INIT ? 'initialState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!_utilsIsPlainObject2['default'](inputState)) {\n    return 'The ' + argumentName + ' has unexpected type of \"' + ({}).toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + '\". Expected argument to be an object with the following ' + ('keys: \"' + reducerKeys.join('\", \"') + '\"');\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key);\n  });\n\n  if (unexpectedKeys.length > 0) {\n    return 'Unexpected ' + (unexpectedKeys.length > 1 ? 'keys' : 'key') + ' ' + ('\"' + unexpectedKeys.join('\", \"') + '\" found in ' + argumentName + '. ') + 'Expected to find one of the known reducer keys instead: ' + ('\"' + reducerKeys.join('\", \"') + '\". Unexpected keys will be ignored.');\n  }\n}\n\nfunction assertReducerSanity(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, { type: _createStore.ActionTypes.INIT });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined during initialization. ' + 'If the state passed to the reducer is undefined, you must ' + 'explicitly return the initial state. The initial state may ' + 'not be undefined.');\n    }\n\n    var type = '@@redux/PROBE_UNKNOWN_ACTION_' + Math.random().toString(36).substring(7).split('').join('.');\n    if (typeof reducer(undefined, { type: type }) === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined when probed with a random type. ' + ('Don\\'t try to handle ' + _createStore.ActionTypes.INIT + ' or other actions in \"redux/*\" ') + 'namespace. They are considered private. Instead, you must return the ' + 'current state for any unknown actions, unless it is undefined, ' + 'in which case you must return the initial state, regardless of the ' + 'action type. The initial state may not be undefined.');\n    }\n  });\n}\n\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\n\nfunction combineReducers(reducers) {\n  var finalReducers = _utilsPick2['default'](reducers, function (val) {\n    return typeof val === 'function';\n  });\n  var sanityError;\n\n  try {\n    assertReducerSanity(finalReducers);\n  } catch (e) {\n    sanityError = e;\n  }\n\n  return function combination(state, action) {\n    if (state === undefined) state = {};\n\n    if (sanityError) {\n      throw sanityError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action);\n      if (warningMessage) {\n        _utilsWarning2['default'](warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var finalState = _utilsMapValues2['default'](finalReducers, function (reducer, key) {\n      var previousStateForKey = state[key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n      if (typeof nextStateForKey === 'undefined') {\n        var errorMessage = getUndefinedStateErrorMessage(key, action);\n        throw new Error(errorMessage);\n      }\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n      return nextStateForKey;\n    });\n\n    return hasChanged ? finalState : state;\n  };\n}\n\nmodule.exports = exports['default'];\n}).call(this,require('_process'))\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yZWR1eC9saWIvY29tYmluZVJlZHVjZXJzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbJ2RlZmF1bHQnXSA9IGNvbWJpbmVSZWR1Y2VycztcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX2NyZWF0ZVN0b3JlID0gcmVxdWlyZSgnLi9jcmVhdGVTdG9yZScpO1xuXG52YXIgX3V0aWxzSXNQbGFpbk9iamVjdCA9IHJlcXVpcmUoJy4vdXRpbHMvaXNQbGFpbk9iamVjdCcpO1xuXG52YXIgX3V0aWxzSXNQbGFpbk9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc0lzUGxhaW5PYmplY3QpO1xuXG52YXIgX3V0aWxzTWFwVmFsdWVzID0gcmVxdWlyZSgnLi91dGlscy9tYXBWYWx1ZXMnKTtcblxudmFyIF91dGlsc01hcFZhbHVlczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc01hcFZhbHVlcyk7XG5cbnZhciBfdXRpbHNQaWNrID0gcmVxdWlyZSgnLi91dGlscy9waWNrJyk7XG5cbnZhciBfdXRpbHNQaWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzUGljayk7XG5cbnZhciBfdXRpbHNXYXJuaW5nID0gcmVxdWlyZSgnLi91dGlscy93YXJuaW5nJyk7XG5cbnZhciBfdXRpbHNXYXJuaW5nMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzV2FybmluZyk7XG5cbmZ1bmN0aW9uIGdldFVuZGVmaW5lZFN0YXRlRXJyb3JNZXNzYWdlKGtleSwgYWN0aW9uKSB7XG4gIHZhciBhY3Rpb25UeXBlID0gYWN0aW9uICYmIGFjdGlvbi50eXBlO1xuICB2YXIgYWN0aW9uTmFtZSA9IGFjdGlvblR5cGUgJiYgJ1wiJyArIGFjdGlvblR5cGUudG9TdHJpbmcoKSArICdcIicgfHwgJ2FuIGFjdGlvbic7XG5cbiAgcmV0dXJuICdSZWR1Y2VyIFwiJyArIGtleSArICdcIiByZXR1cm5lZCB1bmRlZmluZWQgaGFuZGxpbmcgJyArIGFjdGlvbk5hbWUgKyAnLiAnICsgJ1RvIGlnbm9yZSBhbiBhY3Rpb24sIHlvdSBtdXN0IGV4cGxpY2l0bHkgcmV0dXJuIHRoZSBwcmV2aW91cyBzdGF0ZS4nO1xufVxuXG5mdW5jdGlvbiBnZXRVbmV4cGVjdGVkU3RhdGVTaGFwZVdhcm5pbmdNZXNzYWdlKGlucHV0U3RhdGUsIHJlZHVjZXJzLCBhY3Rpb24pIHtcbiAgdmFyIHJlZHVjZXJLZXlzID0gT2JqZWN0LmtleXMocmVkdWNlcnMpO1xuICB2YXIgYXJndW1lbnROYW1lID0gYWN0aW9uICYmIGFjdGlvbi50eXBlID09PSBfY3JlYXRlU3RvcmUuQWN0aW9uVHlwZXMuSU5JVCA/ICdpbml0aWFsU3RhdGUgYXJndW1lbnQgcGFzc2VkIHRvIGNyZWF0ZVN0b3JlJyA6ICdwcmV2aW91cyBzdGF0ZSByZWNlaXZlZCBieSB0aGUgcmVkdWNlcic7XG5cbiAgaWYgKHJlZHVjZXJLZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnU3RvcmUgZG9lcyBub3QgaGF2ZSBhIHZhbGlkIHJlZHVjZXIuIE1ha2Ugc3VyZSB0aGUgYXJndW1lbnQgcGFzc2VkICcgKyAndG8gY29tYmluZVJlZHVjZXJzIGlzIGFuIG9iamVjdCB3aG9zZSB2YWx1ZXMgYXJlIHJlZHVjZXJzLic7XG4gIH1cblxuICBpZiAoIV91dGlsc0lzUGxhaW5PYmplY3QyWydkZWZhdWx0J10oaW5wdXRTdGF0ZSkpIHtcbiAgICByZXR1cm4gJ1RoZSAnICsgYXJndW1lbnROYW1lICsgJyBoYXMgdW5leHBlY3RlZCB0eXBlIG9mIFwiJyArICh7fSkudG9TdHJpbmcuY2FsbChpbnB1dFN0YXRlKS5tYXRjaCgvXFxzKFthLXp8QS1aXSspLylbMV0gKyAnXCIuIEV4cGVjdGVkIGFyZ3VtZW50IHRvIGJlIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgJyArICgna2V5czogXCInICsgcmVkdWNlcktleXMuam9pbignXCIsIFwiJykgKyAnXCInKTtcbiAgfVxuXG4gIHZhciB1bmV4cGVjdGVkS2V5cyA9IE9iamVjdC5rZXlzKGlucHV0U3RhdGUpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7XG4gICAgcmV0dXJuICFyZWR1Y2Vycy5oYXNPd25Qcm9wZXJ0eShrZXkpO1xuICB9KTtcblxuICBpZiAodW5leHBlY3RlZEtleXMubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiAnVW5leHBlY3RlZCAnICsgKHVuZXhwZWN0ZWRLZXlzLmxlbmd0aCA+IDEgPyAna2V5cycgOiAna2V5JykgKyAnICcgKyAoJ1wiJyArIHVuZXhwZWN0ZWRLZXlzLmpvaW4oJ1wiLCBcIicpICsgJ1wiIGZvdW5kIGluICcgKyBhcmd1bWVudE5hbWUgKyAnLiAnKSArICdFeHBlY3RlZCB0byBmaW5kIG9uZSBvZiB0aGUga25vd24gcmVkdWNlciBrZXlzIGluc3RlYWQ6ICcgKyAoJ1wiJyArIHJlZHVjZXJLZXlzLmpvaW4oJ1wiLCBcIicpICsgJ1wiLiBVbmV4cGVjdGVkIGtleXMgd2lsbCBiZSBpZ25vcmVkLicpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFJlZHVjZXJTYW5pdHkocmVkdWNlcnMpIHtcbiAgT2JqZWN0LmtleXMocmVkdWNlcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIHZhciByZWR1Y2VyID0gcmVkdWNlcnNba2V5XTtcbiAgICB2YXIgaW5pdGlhbFN0YXRlID0gcmVkdWNlcih1bmRlZmluZWQsIHsgdHlwZTogX2NyZWF0ZVN0b3JlLkFjdGlvblR5cGVzLklOSVQgfSk7XG5cbiAgICBpZiAodHlwZW9mIGluaXRpYWxTdGF0ZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVkdWNlciBcIicgKyBrZXkgKyAnXCIgcmV0dXJuZWQgdW5kZWZpbmVkIGR1cmluZyBpbml0aWFsaXphdGlvbi4gJyArICdJZiB0aGUgc3RhdGUgcGFzc2VkIHRvIHRoZSByZWR1Y2VyIGlzIHVuZGVmaW5lZCwgeW91IG11c3QgJyArICdleHBsaWNpdGx5IHJldHVybiB0aGUgaW5pdGlhbCBzdGF0ZS4gVGhlIGluaXRpYWwgc3RhdGUgbWF5ICcgKyAnbm90IGJlIHVuZGVmaW5lZC4nKTtcbiAgICB9XG5cbiAgICB2YXIgdHlwZSA9ICdAQHJlZHV4L1BST0JFX1VOS05PV05fQUNUSU9OXycgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoNykuc3BsaXQoJycpLmpvaW4oJy4nKTtcbiAgICBpZiAodHlwZW9mIHJlZHVjZXIodW5kZWZpbmVkLCB7IHR5cGU6IHR5cGUgfSkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlZHVjZXIgXCInICsga2V5ICsgJ1wiIHJldHVybmVkIHVuZGVmaW5lZCB3aGVuIHByb2JlZCB3aXRoIGEgcmFuZG9tIHR5cGUuICcgKyAoJ0RvblxcJ3QgdHJ5IHRvIGhhbmRsZSAnICsgX2NyZWF0ZVN0b3JlLkFjdGlvblR5cGVzLklOSVQgKyAnIG9yIG90aGVyIGFjdGlvbnMgaW4gXCJyZWR1eC8qXCIgJykgKyAnbmFtZXNwYWNlLiBUaGV5IGFyZSBjb25zaWRlcmVkIHByaXZhdGUuIEluc3RlYWQsIHlvdSBtdXN0IHJldHVybiB0aGUgJyArICdjdXJyZW50IHN0YXRlIGZvciBhbnkgdW5rbm93biBhY3Rpb25zLCB1bmxlc3MgaXQgaXMgdW5kZWZpbmVkLCAnICsgJ2luIHdoaWNoIGNhc2UgeW91IG11c3QgcmV0dXJuIHRoZSBpbml0aWFsIHN0YXRlLCByZWdhcmRsZXNzIG9mIHRoZSAnICsgJ2FjdGlvbiB0eXBlLiBUaGUgaW5pdGlhbCBzdGF0ZSBtYXkgbm90IGJlIHVuZGVmaW5lZC4nKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIFR1cm5zIGFuIG9iamVjdCB3aG9zZSB2YWx1ZXMgYXJlIGRpZmZlcmVudCByZWR1Y2VyIGZ1bmN0aW9ucywgaW50byBhIHNpbmdsZVxuICogcmVkdWNlciBmdW5jdGlvbi4gSXQgd2lsbCBjYWxsIGV2ZXJ5IGNoaWxkIHJlZHVjZXIsIGFuZCBnYXRoZXIgdGhlaXIgcmVzdWx0c1xuICogaW50byBhIHNpbmdsZSBzdGF0ZSBvYmplY3QsIHdob3NlIGtleXMgY29ycmVzcG9uZCB0byB0aGUga2V5cyBvZiB0aGUgcGFzc2VkXG4gKiByZWR1Y2VyIGZ1bmN0aW9ucy5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcmVkdWNlcnMgQW4gb2JqZWN0IHdob3NlIHZhbHVlcyBjb3JyZXNwb25kIHRvIGRpZmZlcmVudFxuICogcmVkdWNlciBmdW5jdGlvbnMgdGhhdCBuZWVkIHRvIGJlIGNvbWJpbmVkIGludG8gb25lLiBPbmUgaGFuZHkgd2F5IHRvIG9idGFpblxuICogaXQgaXMgdG8gdXNlIEVTNiBgaW1wb3J0ICogYXMgcmVkdWNlcnNgIHN5bnRheC4gVGhlIHJlZHVjZXJzIG1heSBuZXZlciByZXR1cm5cbiAqIHVuZGVmaW5lZCBmb3IgYW55IGFjdGlvbi4gSW5zdGVhZCwgdGhleSBzaG91bGQgcmV0dXJuIHRoZWlyIGluaXRpYWwgc3RhdGVcbiAqIGlmIHRoZSBzdGF0ZSBwYXNzZWQgdG8gdGhlbSB3YXMgdW5kZWZpbmVkLCBhbmQgdGhlIGN1cnJlbnQgc3RhdGUgZm9yIGFueVxuICogdW5yZWNvZ25pemVkIGFjdGlvbi5cbiAqXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEEgcmVkdWNlciBmdW5jdGlvbiB0aGF0IGludm9rZXMgZXZlcnkgcmVkdWNlciBpbnNpZGUgdGhlXG4gKiBwYXNzZWQgb2JqZWN0LCBhbmQgYnVpbGRzIGEgc3RhdGUgb2JqZWN0IHdpdGggdGhlIHNhbWUgc2hhcGUuXG4gKi9cblxuZnVuY3Rpb24gY29tYmluZVJlZHVjZXJzKHJlZHVjZXJzKSB7XG4gIHZhciBmaW5hbFJlZHVjZXJzID0gX3V0aWxzUGljazJbJ2RlZmF1bHQnXShyZWR1Y2VycywgZnVuY3Rpb24gKHZhbCkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsID09PSAnZnVuY3Rpb24nO1xuICB9KTtcbiAgdmFyIHNhbml0eUVycm9yO1xuXG4gIHRyeSB7XG4gICAgYXNzZXJ0UmVkdWNlclNhbml0eShmaW5hbFJlZHVjZXJzKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHNhbml0eUVycm9yID0gZTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiBjb21iaW5hdGlvbihzdGF0ZSwgYWN0aW9uKSB7XG4gICAgaWYgKHN0YXRlID09PSB1bmRlZmluZWQpIHN0YXRlID0ge307XG5cbiAgICBpZiAoc2FuaXR5RXJyb3IpIHtcbiAgICAgIHRocm93IHNhbml0eUVycm9yO1xuICAgIH1cblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICB2YXIgd2FybmluZ01lc3NhZ2UgPSBnZXRVbmV4cGVjdGVkU3RhdGVTaGFwZVdhcm5pbmdNZXNzYWdlKHN0YXRlLCBmaW5hbFJlZHVjZXJzLCBhY3Rpb24pO1xuICAgICAgaWYgKHdhcm5pbmdNZXNzYWdlKSB7XG4gICAgICAgIF91dGlsc1dhcm5pbmcyWydkZWZhdWx0J10od2FybmluZ01lc3NhZ2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBoYXNDaGFuZ2VkID0gZmFsc2U7XG4gICAgdmFyIGZpbmFsU3RhdGUgPSBfdXRpbHNNYXBWYWx1ZXMyWydkZWZhdWx0J10oZmluYWxSZWR1Y2VycywgZnVuY3Rpb24gKHJlZHVjZXIsIGtleSkge1xuICAgICAgdmFyIHByZXZpb3VzU3RhdGVGb3JLZXkgPSBzdGF0ZVtrZXldO1xuICAgICAgdmFyIG5leHRTdGF0ZUZvcktleSA9IHJlZHVjZXIocHJldmlvdXNTdGF0ZUZvcktleSwgYWN0aW9uKTtcbiAgICAgIGlmICh0eXBlb2YgbmV4dFN0YXRlRm9yS2V5ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gZ2V0VW5kZWZpbmVkU3RhdGVFcnJvck1lc3NhZ2Uoa2V5LCBhY3Rpb24pO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIGhhc0NoYW5nZWQgPSBoYXNDaGFuZ2VkIHx8IG5leHRTdGF0ZUZvcktleSAhPT0gcHJldmlvdXNTdGF0ZUZvcktleTtcbiAgICAgIHJldHVybiBuZXh0U3RhdGVGb3JLZXk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaGFzQ2hhbmdlZCA/IGZpbmFsU3RhdGUgOiBzdGF0ZTtcbiAgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Il19","/**\n * Composes single-argument functions from right to left.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing functions from right to\n * left. For example, compose(f, g, h) is identical to arg => f(g(h(arg))).\n */\n\"use strict\";\n\nexports.__esModule = true;\nexports[\"default\"] = compose;\n\nfunction compose() {\n  for (var _len = arguments.length, funcs = Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  return function () {\n    if (funcs.length === 0) {\n      return arguments[0];\n    }\n\n    var last = funcs[funcs.length - 1];\n    var rest = funcs.slice(0, -1);\n\n    return rest.reduceRight(function (composed, f) {\n      return f(composed);\n    }, last.apply(undefined, arguments));\n  };\n}\n\nmodule.exports = exports[\"default\"];","'use strict';\n\nexports.__esModule = true;\nexports['default'] = createStore;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _utilsIsPlainObject = require('./utils/isPlainObject');\n\nvar _utilsIsPlainObject2 = _interopRequireDefault(_utilsIsPlainObject);\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nvar ActionTypes = {\n  INIT: '@@redux/INIT'\n};\n\nexports.ActionTypes = ActionTypes;\n/**\n * Creates a Redux store that holds the state tree.\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [initialState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @param {Function} enhancer The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is `applyMiddleware()`.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\n\nfunction createStore(reducer, initialState, enhancer) {\n  if (typeof initialState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = initialState;\n    initialState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error('Expected the enhancer to be a function.');\n    }\n\n    return enhancer(createStore)(reducer, initialState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Expected the reducer to be a function.');\n  }\n\n  var currentReducer = reducer;\n  var currentState = initialState;\n  var listeners = [];\n  var isDispatching = false;\n\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n  function getState() {\n    return currentState;\n  }\n\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   * Note, the listener should not expect to see all states changes, as the\n   * state might have been updated multiple times before the listener is\n   * notified.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n  function subscribe(listener) {\n    listeners.push(listener);\n    var isSubscribed = true;\n\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      isSubscribed = false;\n      var index = listeners.indexOf(listener);\n      listeners.splice(index, 1);\n    };\n  }\n\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n  function dispatch(action) {\n    if (!_utilsIsPlainObject2['default'](action)) {\n      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Actions may not have an undefined \"type\" property. ' + 'Have you misspelled a constant?');\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    listeners.slice().forEach(function (listener) {\n      return listener();\n    });\n    return action;\n  }\n\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error('Expected the nextReducer to be a function.');\n    }\n\n    currentReducer = nextReducer;\n    dispatch({ type: ActionTypes.INIT });\n  }\n\n  // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n  dispatch({ type: ActionTypes.INIT });\n\n  return {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  };\n}","(function (process){\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _createStore = require('./createStore');\n\nvar _createStore2 = _interopRequireDefault(_createStore);\n\nvar _combineReducers = require('./combineReducers');\n\nvar _combineReducers2 = _interopRequireDefault(_combineReducers);\n\nvar _bindActionCreators = require('./bindActionCreators');\n\nvar _bindActionCreators2 = _interopRequireDefault(_bindActionCreators);\n\nvar _applyMiddleware = require('./applyMiddleware');\n\nvar _applyMiddleware2 = _interopRequireDefault(_applyMiddleware);\n\nvar _compose = require('./compose');\n\nvar _compose2 = _interopRequireDefault(_compose);\n\nvar _utilsWarning = require('./utils/warning');\n\nvar _utilsWarning2 = _interopRequireDefault(_utilsWarning);\n\n/*\n* This is a dummy function to check if the function name has been altered by minification.\n* If the function has been minified and NODE_ENV !== 'production', warn the user.\n*/\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && setInterval.name === 'setInterval' && isCrushed.name !== 'isCrushed') {\n  _utilsWarning2['default']('You are currently using minified code outside of NODE_ENV === \\'production\\'. ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) ' + 'to ensure you have the correct code for your production build.');\n}\n\nexports.createStore = _createStore2['default'];\nexports.combineReducers = _combineReducers2['default'];\nexports.bindActionCreators = _bindActionCreators2['default'];\nexports.applyMiddleware = _applyMiddleware2['default'];\nexports.compose = _compose2['default'];\n}).call(this,require('_process'))\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yZWR1eC9saWIvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cbnZhciBfY3JlYXRlU3RvcmUgPSByZXF1aXJlKCcuL2NyZWF0ZVN0b3JlJyk7XG5cbnZhciBfY3JlYXRlU3RvcmUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlU3RvcmUpO1xuXG52YXIgX2NvbWJpbmVSZWR1Y2VycyA9IHJlcXVpcmUoJy4vY29tYmluZVJlZHVjZXJzJyk7XG5cbnZhciBfY29tYmluZVJlZHVjZXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbWJpbmVSZWR1Y2Vycyk7XG5cbnZhciBfYmluZEFjdGlvbkNyZWF0b3JzID0gcmVxdWlyZSgnLi9iaW5kQWN0aW9uQ3JlYXRvcnMnKTtcblxudmFyIF9iaW5kQWN0aW9uQ3JlYXRvcnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYmluZEFjdGlvbkNyZWF0b3JzKTtcblxudmFyIF9hcHBseU1pZGRsZXdhcmUgPSByZXF1aXJlKCcuL2FwcGx5TWlkZGxld2FyZScpO1xuXG52YXIgX2FwcGx5TWlkZGxld2FyZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hcHBseU1pZGRsZXdhcmUpO1xuXG52YXIgX2NvbXBvc2UgPSByZXF1aXJlKCcuL2NvbXBvc2UnKTtcblxudmFyIF9jb21wb3NlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvc2UpO1xuXG52YXIgX3V0aWxzV2FybmluZyA9IHJlcXVpcmUoJy4vdXRpbHMvd2FybmluZycpO1xuXG52YXIgX3V0aWxzV2FybmluZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc1dhcm5pbmcpO1xuXG4vKlxuKiBUaGlzIGlzIGEgZHVtbXkgZnVuY3Rpb24gdG8gY2hlY2sgaWYgdGhlIGZ1bmN0aW9uIG5hbWUgaGFzIGJlZW4gYWx0ZXJlZCBieSBtaW5pZmljYXRpb24uXG4qIElmIHRoZSBmdW5jdGlvbiBoYXMgYmVlbiBtaW5pZmllZCBhbmQgTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJywgd2FybiB0aGUgdXNlci5cbiovXG5mdW5jdGlvbiBpc0NydXNoZWQoKSB7fVxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiBzZXRJbnRlcnZhbC5uYW1lID09PSAnc2V0SW50ZXJ2YWwnICYmIGlzQ3J1c2hlZC5uYW1lICE9PSAnaXNDcnVzaGVkJykge1xuICBfdXRpbHNXYXJuaW5nMlsnZGVmYXVsdCddKCdZb3UgYXJlIGN1cnJlbnRseSB1c2luZyBtaW5pZmllZCBjb2RlIG91dHNpZGUgb2YgTk9ERV9FTlYgPT09IFxcJ3Byb2R1Y3Rpb25cXCcuICcgKyAnVGhpcyBtZWFucyB0aGF0IHlvdSBhcmUgcnVubmluZyBhIHNsb3dlciBkZXZlbG9wbWVudCBidWlsZCBvZiBSZWR1eC4gJyArICdZb3UgY2FuIHVzZSBsb29zZS1lbnZpZnkgKGh0dHBzOi8vZ2l0aHViLmNvbS96ZXJ0b3NoL2xvb3NlLWVudmlmeSkgZm9yIGJyb3dzZXJpZnkgJyArICdvciBEZWZpbmVQbHVnaW4gZm9yIHdlYnBhY2sgKGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzAwMzAwMzEpICcgKyAndG8gZW5zdXJlIHlvdSBoYXZlIHRoZSBjb3JyZWN0IGNvZGUgZm9yIHlvdXIgcHJvZHVjdGlvbiBidWlsZC4nKTtcbn1cblxuZXhwb3J0cy5jcmVhdGVTdG9yZSA9IF9jcmVhdGVTdG9yZTJbJ2RlZmF1bHQnXTtcbmV4cG9ydHMuY29tYmluZVJlZHVjZXJzID0gX2NvbWJpbmVSZWR1Y2VyczJbJ2RlZmF1bHQnXTtcbmV4cG9ydHMuYmluZEFjdGlvbkNyZWF0b3JzID0gX2JpbmRBY3Rpb25DcmVhdG9yczJbJ2RlZmF1bHQnXTtcbmV4cG9ydHMuYXBwbHlNaWRkbGV3YXJlID0gX2FwcGx5TWlkZGxld2FyZTJbJ2RlZmF1bHQnXTtcbmV4cG9ydHMuY29tcG9zZSA9IF9jb21wb3NlMlsnZGVmYXVsdCddOyJdfQ==","'use strict';\n\nexports.__esModule = true;\nexports['default'] = isPlainObject;\nvar fnToString = function fnToString(fn) {\n  return Function.prototype.toString.call(fn);\n};\nvar objStringValue = fnToString(Object);\n\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\n\nfunction isPlainObject(obj) {\n  if (!obj || typeof obj !== 'object') {\n    return false;\n  }\n\n  var proto = typeof obj.constructor === 'function' ? Object.getPrototypeOf(obj) : Object.prototype;\n\n  if (proto === null) {\n    return true;\n  }\n\n  var constructor = proto.constructor;\n\n  return typeof constructor === 'function' && constructor instanceof constructor && fnToString(constructor) === objStringValue;\n}\n\nmodule.exports = exports['default'];","/**\n * Applies a function to every key-value pair inside an object.\n *\n * @param {Object} obj The source object.\n * @param {Function} fn The mapper function that receives the value and the key.\n * @returns {Object} A new object that contains the mapped values for the keys.\n */\n\"use strict\";\n\nexports.__esModule = true;\nexports[\"default\"] = mapValues;\n\nfunction mapValues(obj, fn) {\n  return Object.keys(obj).reduce(function (result, key) {\n    result[key] = fn(obj[key], key);\n    return result;\n  }, {});\n}\n\nmodule.exports = exports[\"default\"];","/**\n * Picks key-value pairs from an object where values satisfy a predicate.\n *\n * @param {Object} obj The object to pick from.\n * @param {Function} fn The predicate the values must satisfy to be copied.\n * @returns {Object} The object with the values that satisfied the predicate.\n */\n\"use strict\";\n\nexports.__esModule = true;\nexports[\"default\"] = pick;\n\nfunction pick(obj, fn) {\n  return Object.keys(obj).reduce(function (result, key) {\n    if (fn(obj[key])) {\n      result[key] = obj[key];\n    }\n    return result;\n  }, {});\n}\n\nmodule.exports = exports[\"default\"];","/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\n'use strict';\n\nexports.__esModule = true;\nexports['default'] = warning;\n\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n  try {\n    // This error was thrown as a convenience so that you can use this stack\n    // to find the callsite that caused this warning to fire.\n    throw new Error(message);\n    /* eslint-disable no-empty */\n  } catch (e) {}\n  /* eslint-enable no-empty */\n}\n\nmodule.exports = exports['default'];","/*!\n * viewport-units-buggyfill v0.5.5\n * @web: https://github.com/rodneyrehm/viewport-units-buggyfill/\n * @author: Rodney Rehm - http://rodneyrehm.de/en/\n */\n\n(function (root, factory) {\n  'use strict';\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like enviroments that support module.exports,\n    // like Node.\n    module.exports = factory();\n  } else {\n    // Browser globals (root is window)\n    root.viewportUnitsBuggyfill = factory();\n  }\n}(this, function () {\n  'use strict';\n  /*global document, window, navigator, location, XMLHttpRequest, XDomainRequest*/\n\n  var initialized = false;\n  var options;\n  var userAgent = window.navigator.userAgent;\n  var viewportUnitExpression = /([+-]?[0-9.]+)(vh|vw|vmin|vmax)/g;\n  var forEach = [].forEach;\n  var dimensions;\n  var declarations;\n  var styleNode;\n  var isBuggyIE = /MSIE [0-9]\\./i.test(userAgent);\n  var isOldIE = /MSIE [0-8]\\./i.test(userAgent);\n  var isOperaMini = userAgent.indexOf('Opera Mini') > -1;\n\n  var isMobileSafari = /(iPhone|iPod|iPad).+AppleWebKit/i.test(userAgent) && (function() {\n    // Regexp for iOS-version tested against the following userAgent strings:\n    // Example WebView UserAgents:\n    // * iOS Chrome on iOS8: \"Mozilla/5.0 (iPad; CPU OS 8_1 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) CriOS/39.0.2171.50 Mobile/12B410 Safari/600.1.4\"\n    // * iOS Facebook on iOS7: \"Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Mobile/11D201 [FBAN/FBIOS;FBAV/12.1.0.24.20; FBBV/3214247; FBDV/iPhone6,1;FBMD/iPhone; FBSN/iPhone OS;FBSV/7.1.1; FBSS/2; FBCR/AT&T;FBID/phone;FBLC/en_US;FBOP/5]\"\n    // Example Safari UserAgents:\n    // * Safari iOS8: \"Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/600.1.3 (KHTML, like Gecko) Version/8.0 Mobile/12A4345d Safari/600.1.4\"\n    // * Safari iOS7: \"Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A4449d Safari/9537.53\"\n    var iOSversion = userAgent.match(/OS (\\d)/);\n    // viewport units work fine in mobile Safari and webView on iOS 8+\n    return iOSversion && iOSversion.length>1 && parseInt(iOSversion[1]) < 8;\n  })();\n\n  var isBadStockAndroid = (function() {\n    // Android stock browser test derived from\n    // http://stackoverflow.com/questions/24926221/distinguish-android-chrome-from-stock-browser-stock-browsers-user-agent-contai\n    var isAndroid = userAgent.indexOf(' Android ') > -1;\n    if (!isAndroid) {\n      return false;\n    }\n\n    var isStockAndroid = userAgent.indexOf('Version/') > -1;\n    if (!isStockAndroid) {\n      return false;\n    }\n\n    var versionNumber = parseFloat((userAgent.match('Android ([0-9.]+)') || [])[1]);\n    // anything below 4.4 uses WebKit without *any* viewport support,\n    // 4.4 has issues with viewport units within calc()\n    return versionNumber <= 4.4;\n  })();\n\n  // added check for IE11, since it *still* doesn't understand vmax!!!\n  if (!isBuggyIE) {\n    isBuggyIE = !!navigator.userAgent.match(/Trident.*rv[ :]*11\\./);\n  }\n\n  // Polyfill for creating CustomEvents on IE9/10/11\n  // from https://github.com/krambuhl/custom-event-polyfill\n  try {\n    new CustomEvent('test');\n  } catch(e) {\n    var CustomEvent = function(event, params) {\n      var evt;\n      params = params || {\n            bubbles: false,\n            cancelable: false,\n            detail: undefined\n          };\n\n      evt = document.createEvent('CustomEvent');\n      evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n      return evt;\n    };\n    CustomEvent.prototype = window.Event.prototype;\n    window.CustomEvent = CustomEvent; // expose definition to window\n  }\n\n  function debounce(func, wait) {\n    var timeout;\n    return function() {\n      var context = this;\n      var args = arguments;\n      var callback = function() {\n        func.apply(context, args);\n      };\n\n      clearTimeout(timeout);\n      timeout = setTimeout(callback, wait);\n    };\n  }\n\n  // from http://stackoverflow.com/questions/326069/how-to-identify-if-a-webpage-is-being-loaded-inside-an-iframe-or-directly-into-t\n  function inIframe() {\n    try {\n      return window.self !== window.top;\n    } catch (e) {\n      return true;\n    }\n  }\n\n  function initialize(initOptions) {\n    if (initialized) {\n      return;\n    }\n\n    if (initOptions === true) {\n      initOptions = {\n        force: true\n      };\n    }\n\n    options = initOptions || {};\n    options.isMobileSafari = isMobileSafari;\n    options.isBadStockAndroid = isBadStockAndroid;\n\n    if (isOldIE || (!options.force && !isMobileSafari && !isBuggyIE && !isBadStockAndroid && !isOperaMini && (!options.hacks || !options.hacks.required(options)))) {\n      // this buggyfill only applies to mobile safari, IE9-10 and the Stock Android Browser.\n      if (window.console && isOldIE) {\n        console.info('viewport-units-buggyfill requires a proper CSSOM and basic viewport unit support, which are not available in IE8 and below');\n      }\n\n      return {\n        init: function () {}\n      };\n    }\n\n    // fire a custom event that buggyfill was initialize\n    window.dispatchEvent(new CustomEvent('viewport-units-buggyfill-init'));\n\n    options.hacks && options.hacks.initialize(options);\n\n    initialized = true;\n    styleNode = document.createElement('style');\n    styleNode.id = 'patched-viewport';\n    document.head.appendChild(styleNode);\n\n    // Issue #6: Cross Origin Stylesheets are not accessible through CSSOM,\n    // therefore download and inject them as <style> to circumvent SOP.\n    importCrossOriginLinks(function() {\n      var _refresh = debounce(refresh, options.refreshDebounceWait || 100);\n      // doing a full refresh rather than updateStyles because an orientationchange\n      // could activate different stylesheets\n      window.addEventListener('orientationchange', _refresh, true);\n      // orientationchange might have happened while in a different window\n      window.addEventListener('pageshow', _refresh, true);\n\n      if (options.force || isBuggyIE || inIframe()) {\n        window.addEventListener('resize', _refresh, true);\n        options._listeningToResize = true;\n      }\n\n      options.hacks && options.hacks.initializeEvents(options, refresh, _refresh);\n\n      refresh();\n    });\n  }\n\n  function updateStyles() {\n    styleNode.textContent = getReplacedViewportUnits();\n    // move to the end in case inline <style>s were added dynamically\n    styleNode.parentNode.appendChild(styleNode);\n    // fire a custom event that styles were updated\n    window.dispatchEvent(new CustomEvent('viewport-units-buggyfill-style'));\n  }\n\n  function refresh() {\n    if (!initialized) {\n      return;\n    }\n\n    findProperties();\n\n    // iOS Safari will report window.innerWidth and .innerHeight as 0 unless a timeout is used here.\n    // TODO: figure out WHY innerWidth === 0\n    setTimeout(function() {\n      updateStyles();\n    }, 1);\n  }\n\n  function findProperties() {\n    declarations = [];\n    forEach.call(document.styleSheets, function(sheet) {\n      if (sheet.ownerNode.id === 'patched-viewport' || !sheet.cssRules || sheet.ownerNode.getAttribute('data-viewport-units-buggyfill') === 'ignore') {\n        // skip entire sheet because no rules are present, it's supposed to be ignored or it's the target-element of the buggyfill\n        return;\n      }\n\n      if (sheet.media && sheet.media.mediaText && window.matchMedia && !window.matchMedia(sheet.media.mediaText).matches) {\n        // skip entire sheet because media attribute doesn't match\n        return;\n      }\n\n      forEach.call(sheet.cssRules, findDeclarations);\n    });\n\n    return declarations;\n  }\n\n  function findDeclarations(rule) {\n    if (rule.type === 7) {\n      var value;\n\n      // there may be a case where accessing cssText throws an error.\n      // I could not reproduce this issue, but the worst that can happen\n      // this way is an animation not running properly.\n      // not awesome, but probably better than a script error\n      // see https://github.com/rodneyrehm/viewport-units-buggyfill/issues/21\n      try {\n        value = rule.cssText;\n      } catch(e) {\n        return;\n      }\n\n      viewportUnitExpression.lastIndex = 0;\n      if (viewportUnitExpression.test(value)) {\n        // KeyframesRule does not have a CSS-PropertyName\n        declarations.push([rule, null, value]);\n        options.hacks && options.hacks.findDeclarations(declarations, rule, null, value);\n      }\n\n      return;\n    }\n\n    if (!rule.style) {\n      if (!rule.cssRules) {\n        return;\n      }\n\n      forEach.call(rule.cssRules, function(_rule) {\n        findDeclarations(_rule);\n      });\n\n      return;\n    }\n\n    forEach.call(rule.style, function(name) {\n      var value = rule.style.getPropertyValue(name);\n      // preserve those !important rules\n      if (rule.style.getPropertyPriority(name)) {\n        value += ' !important';\n      }\n\n      viewportUnitExpression.lastIndex = 0;\n      if (viewportUnitExpression.test(value)) {\n        declarations.push([rule, name, value]);\n        options.hacks && options.hacks.findDeclarations(declarations, rule, name, value);\n      }\n    });\n  }\n\n  function getReplacedViewportUnits() {\n    dimensions = getViewport();\n\n    var css = [];\n    var buffer = [];\n    var open;\n    var close;\n\n    declarations.forEach(function(item) {\n      var _item = overwriteDeclaration.apply(null, item);\n      var _open = _item.selector.length ? (_item.selector.join(' {\\n') + ' {\\n') : '';\n      var _close = new Array(_item.selector.length + 1).join('\\n}');\n\n      if (!_open || _open !== open) {\n        if (buffer.length) {\n          css.push(open + buffer.join('\\n') + close);\n          buffer.length = 0;\n        }\n\n        if (_open) {\n          open = _open;\n          close = _close;\n          buffer.push(_item.content);\n        } else {\n          css.push(_item.content);\n          open = null;\n          close = null;\n        }\n\n        return;\n      }\n\n      if (_open && !open) {\n        open = _open;\n        close = _close;\n      }\n\n      buffer.push(_item.content);\n    });\n\n    if (buffer.length) {\n      css.push(open + buffer.join('\\n') + close);\n    }\n\n    // Opera Mini messes up on the content hack (it replaces the DOM node's innerHTML with the value).\n    // This fixes it. We test for Opera Mini only since it is the most expensive CSS selector\n    // see https://developer.mozilla.org/en-US/docs/Web/CSS/Universal_selectors\n    if (isOperaMini) {\n      css.push('* { content: normal !important; }');\n    }\n\n    return css.join('\\n\\n');\n  }\n\n  function overwriteDeclaration(rule, name, value) {\n    var _value;\n    var _selectors = [];\n\n    _value = value.replace(viewportUnitExpression, replaceValues);\n\n    if (options.hacks) {\n      _value = options.hacks.overwriteDeclaration(rule, name, _value);\n    }\n\n    if (name) {\n      // skipping KeyframesRule\n      _selectors.push(rule.selectorText);\n      _value = name + ': ' + _value + ';';\n    }\n\n    var _rule = rule.parentRule;\n    while (_rule) {\n      _selectors.unshift('@media ' + _rule.media.mediaText);\n      _rule = _rule.parentRule;\n    }\n\n    return {\n      selector: _selectors,\n      content: _value\n    };\n  }\n\n  function replaceValues(match, number, unit) {\n    var _base = dimensions[unit];\n    var _number = parseFloat(number) / 100;\n    return (_number * _base) + 'px';\n  }\n\n  function getViewport() {\n    var vh = window.innerHeight;\n    var vw = window.innerWidth;\n\n    return {\n      vh: vh,\n      vw: vw,\n      vmax: Math.max(vw, vh),\n      vmin: Math.min(vw, vh)\n    };\n  }\n\n  function importCrossOriginLinks(next) {\n    var _waiting = 0;\n    var decrease = function() {\n      _waiting--;\n      if (!_waiting) {\n        next();\n      }\n    };\n\n    forEach.call(document.styleSheets, function(sheet) {\n      if (!sheet.href || origin(sheet.href) === origin(location.href) || sheet.ownerNode.getAttribute('data-viewport-units-buggyfill') === 'ignore') {\n        // skip <style> and <link> from same origin or explicitly declared to ignore\n        return;\n      }\n\n      _waiting++;\n      convertLinkToStyle(sheet.ownerNode, decrease);\n    });\n\n    if (!_waiting) {\n      next();\n    }\n  }\n\n  function origin(url) {\n    return url.slice(0, url.indexOf('/', url.indexOf('://') + 3));\n  }\n\n  function convertLinkToStyle(link, next) {\n    getCors(link.href, function() {\n      var style = document.createElement('style');\n      style.media = link.media;\n      style.setAttribute('data-href', link.href);\n      style.textContent = this.responseText;\n      link.parentNode.replaceChild(style, link);\n      next();\n    }, next);\n  }\n\n  function getCors(url, success, error) {\n    var xhr = new XMLHttpRequest();\n    if ('withCredentials' in xhr) {\n      // XHR for Chrome/Firefox/Opera/Safari.\n      xhr.open('GET', url, true);\n    } else if (typeof XDomainRequest !== 'undefined') {\n      // XDomainRequest for IE.\n      xhr = new XDomainRequest();\n      xhr.open('GET', url);\n    } else {\n      throw new Error('cross-domain XHR not supported');\n    }\n\n    xhr.onload = success;\n    xhr.onerror = error;\n    xhr.send();\n    return xhr;\n  }\n\n  return {\n    version: '0.5.5',\n    findProperties: findProperties,\n    getCss: getReplacedViewportUnits,\n    init: initialize,\n    refresh: refresh\n  };\n\n}));\n"]}